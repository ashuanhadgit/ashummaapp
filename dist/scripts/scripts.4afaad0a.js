"use strict";var pos=null,app=angular.module("mmaApp",["ngAnimate","ngRoute","ui.utils","checklist-model","firebase","angularFilepicker","ui.bootstrap","toaster","youtube-embed","duScroll","angular-md5","ngMap","textAngular","me-lazyload","angularytics"]);app.constant("FIREBASE_URL","https://mmaapp.firebaseio.com/"),app.run(["$rootScope","$location","$anchorScroll","$routeParams",function($rootScope,$location,$anchorScroll,$routeParams){$rootScope.$on("$routeChangeSuccess",function(){"/main"==$location.path()&&($location.hash($routeParams.scrollTo),$anchorScroll())})}]),app.filter("convert",function(){return function(input){var months={"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep",10:"Oct",11:"Nov",12:"Dec"},mm=String(input[4]+input[5]),output=input[6]+input[7]+" "+months[mm]+" "+input[0]+input[1]+input[2]+input[3];return output}}),app.filter("change_time",function(){return function(input){var dd="AM",h=parseInt(input[0]+input[1]);h>="12"&&(h-="12",dd="PM"),"0"==h&&(h="12");var output=h+":"+input[3]+input[4]+dd;return output}}),app.controller("mapController",["$scope",function($scope){$("#mma-button").fadeOut(),$scope.setMapCenterToMarker=function(){$scope.map.panTo({lat:28.621398,lng:77.081163}),$scope.map.setZoom(16),$("#mma-button").fadeOut(100)},$scope.onDrag=function(){var MMAmarker=new google.maps.LatLng(28.621398,77.076163);$scope.map.getBounds().contains(MMAmarker)?$("#mma-button").fadeOut(100):$("#mma-button").fadeIn(100)}}]),app.directive("scrollTrigger",["$window",function($window){return{link:function(scope,element,attrs){var offset=parseInt(attrs.threshold)||0,e=jQuery(element[0]),doc=jQuery(document);angular.element(document).bind("scroll",function(){doc.scrollTop()+$window.innerHeight+offset>e.offset().top&&scope.$apply(attrs.scrollTrigger)})}}}]),app.directive("demoEditor",["broadcastFactory",function(){return{restrict:"AE",link:function(scope,elem,attrs){scope.$watch("isEditable",function(newValue){elem.attr("contenteditable",newValue)}),elem.on("keyup keydown",function(){scope.$apply(function(){scope[attrs.model]=elem.html().trim()})})}}}]),app.directive("scroll",["$window","$route","$location",function($window,$route,$location){return{restrict:"AE",link:function(scope,elem){var pos=null;"/main"==$location.path()?(angular.element($window).unbind("scroll"),angular.element($window).bind("scroll",function(){if($(window).width()>768&&"/main"==$location.path()){elem.removeClass("set-bottom"),elem.removeClass("stick-top"),$(".main-page-feature-second-how-it-works-img-div-right").removeClass("col-md-offset-6"),pos=$("#howItWorks").position().top,pos+=82;var windowpos=$window.scrollY,stickermax=$("#howItWorks").position().top+$("#howItWorks").height()-$("#howItWorks").height()/10*2.3;windowpos>=pos&&stickermax>windowpos?($(".main-page-feature-second-how-it-works-img-div-right").addClass("col-md-offset-6"),elem.removeClass("set-bottom"),elem.addClass("stick-top")):windowpos>=stickermax?(elem.removeClass("stick-top"),elem.addClass("set-bottom"),$(".main-page-feature-second-how-it-works-img-div-right").removeClass("col-md-offset-6")):(elem.removeClass("set-bottom"),elem.removeClass("stick-top"),$(".main-page-feature-second-how-it-works-img-div-right").removeClass("col-md-offset-6")),"transNav"==$route.current.activePage&&(windowpos>=10?($("nav.navbar.navbar-default").removeClass("nav-signed-out"),$("nav.navbar.navbar-default").addClass("blue-dark nav-signed-in")):($("nav.navbar.navbar-default").removeClass("blue-dark nav-signed-in"),$("nav.navbar.navbar-default").addClass("nav-signed-out"))),scope.$apply()}})):$location.path().indexOf("/college-profile/simplelogin:")+1&&(angular.element($window).unbind("scroll"),angular.element($window).bind("scroll",function(){var windowpos=$window.scrollY;"transNav"==$route.current.activePage&&(windowpos>=10?($("nav.navbar.navbar-default").removeClass("nav-signed-out"),$("nav.navbar.navbar-default").addClass("blue-dark nav-signed-in")):($("nav.navbar.navbar-default").removeClass("blue-dark nav-signed-in"),$("nav.navbar.navbar-default").addClass("nav-signed-out")))}),scope.$evalAsync())}}}]),app.directive("starRating",function(){return{restrict:"A",template:"<ul class='rating'>  <li ng-repeat='star in stars' ng-class='star' ng-click='toggle($index)'>    <i class='fa fa-star anhadcust{{$index}}'></i>  </li></ul>",scope:{ratingValue:"=",max:"=",onRatingSelected:"&"},link:function(scope){var updateStars=function(){scope.stars=[];for(var i=0;i<scope.max;i++)scope.stars.push({filled:i<scope.ratingValue})};scope.toggle=function(index){scope.ratingValue=index+1,scope.onRatingSelected({rating:index+1})},scope.$watch("ratingValue",function(oldVal,newVal){newVal&&updateStars()})}}}),app.filter("titleCase",function(){return function(input){return input=input||"",input.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()})}}),app.filter("slice",function(){return function(arr,start,end){return arr.slice(start,end)}}),app.filter("cut",function(){return function(value,wordwise,max,tail){if(!value)return"";if(max=parseInt(max,10),!max)return value;if(value.length<=max)return value;if(value=value.substr(0,max),wordwise){var lastspace=value.lastIndexOf(" ");-1!=lastspace&&(value=value.substr(0,lastspace))}return value+(tail||" â€¦")}}),app.filter("cut_phone",function(){return function(value){if(!value)return"";var value_num,max=6;return value_num=value.substr(max,9),"xxxxxx"+value_num}}),app.filter("cut_email",function(){return function(email){for(var tempEmail="",temp=email.split("@"),i=0;i<temp[0].length-5;i++)tempEmail+=temp[0][i];return tempEmail+="****@****.com"}}),app.config(["AngularyticsProvider",function(AngularyticsProvider){AngularyticsProvider.setEventHandlers(["Console","GoogleUniversal"])}]).run(["Angularytics",function(Angularytics){Angularytics.init()}]),app.config(["$routeProvider",function($routeProvider){$routeProvider.when("/register",{templateUrl:"views/register.html",controller:"AuthCtrl as registration",resolve:{user:function(Auth){return Auth.resolveUser()}},activePage:"normNav"}).when("/register/:email",{templateUrl:"views/refer-register.html",controller:"ReferCtrl",resolve:{user:function(Auth){return Auth.resolveUser()}},activePage:"normNav"}).when("/login/:email",{templateUrl:"views/refer-login.html",controller:"ReferCtrl",resolve:{user:function(Auth){return Auth.resolveUser()}},activePage:"normNav"}).when("/login",{templateUrl:"views/login.html",controller:"AuthCtrl",resolve:{user:function(Auth){return Auth.resolveUser()}},activePage:"normNav"}).when("/search",{templateUrl:"views/search.html",controller:"SearchCtrl",activePage:"normNav"}).when("/main",{templateUrl:"views/main.html",controller:"MainCtrl",resolve:{user:function(Auth){return Auth.resolveUser()}},activePage:"transNav"}).when("/about",{templateUrl:"views/about-us.html",controller:"AboutCtrl",activePage:"normNav"}).when("/student-counselling-center",{templateUrl:"views/counselling.html",controller:"studentDashBookedHistoryCtrl",activePage:"noFoot"}).when("/dashboard",{templateUrl:"views/student-dashboard-dash.html",controller:"StudentDashCtrl",activePage:"noFoot"}).when("/student-profile",{templateUrl:"views/student-dashboard-profile.html",controller:"StudentDashCtrl",activePage:"noFoot"}).when("/student-college-search",{templateUrl:"views/studentCollegeSearch.html",controller:"SearchCtrl",activePage:"noFoot"}).when("/student-fund",{templateUrl:"views/student-dashboard-incentive.html",controller:"StudentDashCtrl",activePage:"noFoot"}).when("/student-houses",{templateUrl:"views/student-houses.html",controller:"BlogCtrl",activePage:"noFoot"}).when("/student-webinar-detail",{templateUrl:"views/student-webinar-detail.html",controller:"StudentDashCtrl",activePage:"noFoot"}).when("/all-completed-webinars",{templateUrl:"views/archieve-webinar.html",controller:"studentDashBookedHistoryCtrl",activePage:"noFoot"}).when("/house/:houseName",{templateUrl:"views/student-houses.html",controller:"BlogCtrl",activePage:"noFoot"}).when("/student-booked-history",{templateUrl:"views/student-dashboard-bh.html",controller:"studentDashBookedHistoryCtrl",activePage:"noFoot"}).when("/error",{templateUrl:"views/err.html",controller:"Nav-dashCtrl",activePage:"normNav"}).when("/verify/:userId",{templateUrl:"views/verify.html",controller:"VerifyCtrl",activePage:"normNav"}).when("/refer",{templateUrl:"views/student-dashboard-incentive.html",controller:"StudentDashCtrl",activePage:"normNav"}).when("/contact",{templateUrl:"views/contact-us.html",controller:"ContactCtrl",activePage:"normNav"}).when("/blog/:Year",{templateUrl:"views/yearlyData.html",controller:"BlogCtrl",activePage:"normNav"}).when("/blog/:Year/:Month",{templateUrl:"views/monthlyData.html",controller:"BlogCtrl",activePage:"normNav"}).when("/post/:postId",{templateUrl:"views/view-post.html",controller:"BlogCtrl",activePage:"normNav"}).when("/category/:catagoryName",{templateUrl:"views/blogCatagory.html",controller:"BlogCtrl",activePage:"normNav"}).when("/sitemap",{templateUrl:"views/sitemap.html",controller:"MainCtrl",activePage:"normNav"}).when("/mobile",{templateUrl:"views/android.html",controller:"MainCtrl",activePage:"normNav"}).when("/faq",{templateUrl:"views/faq.html",controller:"MainCtrl",activePage:"normNav"}).when("/forgotpassword",{templateUrl:"views/forgotpassword.html",controller:"MainCtrl",activePage:"normNav"}).when("/resetpassword/:url",{templateUrl:"views/reset-password.html",controller:"MainCtrl",activePage:"normNav"}).when("/account-settings",{templateUrl:"views/account-settings.html",controller:"StudentDashCtrl",activePage:"noFoot"}).when("/all-posts",{templateUrl:"views/allposts.html",controller:"BlogCtrl",activePage:"normNav"}).when("/author-profile/:mentorid",{templateUrl:"views/author-profile.html",controller:"MentorCtrl",activePage:"noFoot"}).when("/view-monthly-post/:postDate",{templateUrl:"views/monthly-post.html",controller:"BlogCtrl",activePage:"normNav"}).when("/earn-scholarship",{templateUrl:"views/earn-scholarship.html",controller:"MainCtrl",activePage:"normNav"}).when("/facebook",{templateUrl:"views/facebook-auth.html",controller:"MainCtrl",activePage:"normNav"}).when("/signup-success",{templateUrl:"views/complete-signup.html",controller:"MainCtrl",activePage:"normNav"}).when("/house",{templateUrl:"views/houses.html",controller:"StudentDashCtrl",activePage:"noFoot"}).when("/all-college-posts",{templateUrl:"views/allCollegePosts.html",controller:"BlogCtrl",activePage:"noFoot"}).when("/collegePost/:postId",{templateUrl:"views/view-college-post.html",controller:"BlogCtrl",activePage:"noFoot"}).when("/view-webinar/:webinarId",{templateUrl:"views/view-webinar.html",controller:"WebinarCtrl",activePage:"normNav"}).when("/ReferNodalVerify/:userId",{templateUrl:"views/refernodalverify.html",controller:"VerifyReferNodalCtrl",activePage:"normNav"}).when("/college-profile/:collegeId",{templateUrl:"views/college-profile.html",controller:"CollegeProfileCtrl",activePage:"transNav"}).when("/special-event",{templateUrl:"views/special-event.html",controller:"WebinarCtrl",activePage:"normNav"}).when("/live-webinar",{templateUrl:"views/live-webinar.html",controller:"MainCtrl",activePage:"normNav"}).otherwise({redirectTo:"/main"})}]),app.controller("AboutCtrl",["$routeParams","$window","$route","$scope","$log","$document","$location","toaster",function($routeParams,$window,$route,$scope,$log,$document,$location){$scope.$route=$route,$scope.setFooterElem=function(toSet){$("#about-top-nav").attr("data-target-scroll","#"+toSet+"-content"),$("#about-top-nav").attr("data-elems","#about-nav:z,#sidebar-"+toSet+":c^m"),$("#about-top-nav").attr("data-offset-elem","#sidebar-"+toSet),$scope.$applyAsync()},"/about"==$location.path()&&$routeParams.tab&&($scope.tab=$routeParams.tab,$scope.$applyAsync(),$scope.setFooterElem($scope.tab),$scope.$applyAsync()),$scope.setTab=function(tab){$scope.tab=tab,$scope.$applyAsync(),$window.location.href="#/about?tab="+tab},$scope.click_missionSec=function(){$(window).height();$("html,body").animate({scrollTop:0},"slow"),$("#foundersSec").removeClass("current"),$("#techSec").removeClass("current"),$("#opsSec").removeClass("current"),$("#missionSec").addClass("current"),$scope.$evalAsync()},$scope.click_foundersSec=function(){var winHt=$(window).height(),x=$("#missionContent").height();x+=.15*winHt,$("html,body").animate({scrollTop:x},"slow"),$("#missionSec").removeClass("current"),$("#techSec").removeClass("current"),$("#opsSec").removeClass("current"),$("#foundersSec").addClass("current"),$scope.$evalAsync()},$scope.click_techSec=function(){var winHt=$(window).height(),y=$("#missionContent").height(),x=$("#founderContent").height();x=x+.22*winHt+y,$("html,body").animate({scrollTop:x},"slow"),$("#foundersSec").removeClass("current"),$("#missionSec").removeClass("current"),$("#opsSec").removeClass("current"),$("#techSec").addClass("current"),$scope.$evalAsync()},$scope.click_opsSec=function(){var winHt=$(window).height(),x=$("#techContent").height(),y=$("#missionContent").height(),z=$("#founderContent").height();x=x+y+z+.28*winHt,$("html,body").animate({scrollTop:x},"slow"),$("#foundersSec").removeClass("current"),$("#missionSec").removeClass("current"),$("#techSec").removeClass("current"),$("#opsSec").addClass("current"),$scope.$evalAsync()},$scope.toTheTop=function(){$document.scrollTopAnimated(0,1e3).then(function(){})}}]).value("duScrollOffset",30),app.controller("AuthCtrl",["$scope","$document","md5","$controller","$http","$location","Auth","user","Search",function($scope,$document,md5,$controller,$http,$location,Auth,user,Search){$scope.submitbuttondisabled=!1,$scope.modalShown=!1,user&&$location.path("/"),$scope.message="",$scope.gender=[{name:"Male"},{name:"Female"}],$scope.roles=[{id:"0",text:"Engineering"},{id:"1",text:"Computer Applications / IT"},{id:"2",text:"Biotechnology"},{id:"3",text:"Microbiology"},{id:"4",text:"Agriculture"},{id:"5",text:"Food Technology"},{id:"6",text:"Nutrition and Dietetics"},{id:"7",text:"Arts (Humanities)"},{id:"8",text:"Library Science"},{id:"9",text:"Management"},{id:"10",text:"Commerce"},{id:"11",text:"Economics"},{id:"12",text:"Hotel Management/Hospitality and Tourism"},{id:"13",text:"Architecture"},{id:"14",text:"Planning"},{id:"15",text:"Fine Arts"},{id:"16",text:"Performing Arts"},{id:"17",text:"Pharmaceutical Sciences"},{id:"18",text:"Ayurvedic Pharmaceutical Sciences"},{id:"19",text:"Physiotherapy"},{id:"20",text:"Paramedical Sciences"},{id:"21",text:"Education"},{id:"22",text:"Physical Education"},{id:"23",text:"Law"},{id:"24",text:"Design"},{id:"25",text:"Sciences"},{id:"26",text:"Nursing"},{id:"27",text:"Film & Television"},{id:"28",text:"Media & Journalism"}],$scope.uSer={roles:[]},$scope.rolesA=[{idA:"0",textA:"Engineering"},{idA:"1",textA:"Computer Applications / IT"},{idA:"2",textA:"Biotechnology"},{idA:"3",textA:"Microbiology"},{idA:"4",textA:"Biochemistry"},{idA:"5",textA:"Agriculture"},{idA:"6",textA:"Food Technology"},{idA:"7",textA:"Nutrition and Dietetics"},{idA:"8",textA:"English and Foreign Languages"},{idA:"9",textA:"Indian Languages"},{idA:"10",textA:"Library Science"},{idA:"11",textA:"Sociology"},{idA:"12",textA:"Geography"},{idA:"13",textA:"Management"},{idA:"14",textA:"Commerce"},{idA:"15",textA:"Economics"},{idA:"16",textA:"Hotel Management/Hospitality and Tourism"},{idA:"17",textA:"Architecture"},{idA:"18",textA:"Planning"},{idA:"19",textA:"Fine Arts"},{idA:"20",textA:"Performing Arts"},{idA:"21",textA:"Pharmaceutical Sciences"},{idA:"22",textA:"Ayurvedic Pharmaceutical Sciences"},{idA:"23",textA:"Physiotherapy"},{idA:"24",textA:"Paramedical Sciences"},{idA:"25",textA:"History"},{idA:"26",textA:"Political Science"},{idA:"27",textA:"Psychology"},{idA:"28",textA:"Education"},{idA:"29",textA:"Physical Education"},{idA:"30",textA:"Law"},{idA:"31",textA:"Design"},{idA:"32",textA:"Sciences"},{idA:"33",textA:"Nursing"},{idA:"34",textA:"Film & Television"},{idA:"35",textA:"Media & Journalism"}],$scope.uSerA={rolesA:[]},$scope.loginusingfb=function(){Auth.loginusingfb($scope.user,$scope)},$scope.loginusinggoogle=function(){Auth.loginusinggoogle($scope.user,$scope)},$scope.login=function(){$scope.modalShown=!0,Auth.login($scope.user.email,$scope.user.password,$scope).then(function(){Auth.resolveUser().auth.uid;$location.path("/dashboard")})},$scope.doThisForStudent=function(studentEmail1){studentEmail1=angular.lowercase(studentEmail1),studentEmail1?Search.getStudentIdByEmail(studentEmail1).then(function(result){$scope.student1Uid=result,"user doesnot exists"!==$scope.student1Uid?($scope.student1IdFlag="Done",$scope.student1Name=Search.getStudentName($scope.student1Uid)):$scope.student1IdFlag="Not Done"},function(error){$scope.student1IdFlag="Not Done",console.log(error)}):($scope.student1IdFlag="",$scope.student1Uid="")},$scope.toTheTop=function(){$document.scrollTopAnimated(0,2e3).then(function(){})},$scope.showEmailText=!1,$scope.showEmail=function(){$scope.showEmailText=""==$scope.user.email?!1:!0},$scope.checkCount=function(){Auth.checkCount()},$scope.showPasswordText=!1,$scope.showPass=function(){$scope.showPasswordText=""==$scope.user.password?!1:!0},$scope.register=function(){$scope.submitbuttondisabled=!0,$scope.modalShown=!0,Auth.register($scope.user).then(function(user){return Auth.login($scope.user.email,$scope.user.password,$scope).then(function(){return user.md5_hash=md5.createHash($scope.user.email||""),user.studentname=$scope.user.studentname,user.studentmobile=$scope.user.studentmobile,user.email=angular.lowercase($scope.user.email),user.gender=$scope.user.gender,user.password=$scope.user.password,user.profiletype="student",user.studentAvailability="offline",user.studentstatus="notverified",user.emailverificationstatus="false",user.referredBy="nobody",user.studentphoto="https://www.filepicker.io/api/file/zEAoaiVbRRW0HrtJApxM",Auth.createProfile(user)}).then(function(){$scope.modalShown=!1;var urlId=user.uid;Auth.createAdminForStudent(user);var dataToPost={to:user.email,pass:$scope.user.password,sname:$scope.user.studentname,hashkey:user.md5_hash,semail:$scope.user.email,smobile:$scope.user.studentmobile,urlId:urlId};$http({url:"/sendstudentmail",method:"GET",params:{to:dataToPost.to,sname:dataToPost.sname,pass:dataToPost.pass,hashkey:dataToPost.hashkey,urlId:dataToPost.urlId}}).success(function(serverResponse){console.log(serverResponse)}).error(function(serverResponse){console.log(serverResponse)}),$http({url:"/sendstudentregistrationmail",method:"GET",params:{to:dataToPost.to,semail:dataToPost.semail,sname:dataToPost.sname,pass:dataToPost.pass,smobile:dataToPost.smobile}}).success(function(serverResponse){console.log(serverResponse)}).error(function(serverResponse){console.log(serverResponse)}),$location.path("/signup-success")})},function(error){$scope.modalShown=!1,$scope.submitbuttondisabled=!1,$scope.error=error.message}),$scope.message="",$scope.error=""}}]).value("duScrollOffset",30),app.controller("BlogCtrl",["$scope","$log","$document","$location","$interval","$filter","Angularytics","Blog","Search","toaster","AuthMentor","AdminAuth","Auth","AuthCollege","AuthSchool",function($scope,$log,$document,$location,$interval,$filter,Angularytics,Blog,Search,toaster,AuthMentor,AdminAuth,Auth,AuthCollege,AuthSchool){$scope.user=Auth.user,$scope.usera=AdminAuth.usera,$scope.userc=AuthCollege.userc,$scope.users=AuthSchool.users,$scope.userd=AuthMentor.userd,$scope.signedIn=Auth.signedIn,$scope.imageurl="",$scope.message="",$scope.saveStatus=!1,$scope.postSaveSuccessfully=!1,$scope.featuredImage={},$scope.toTheTop=function(){$document.scrollTopAnimated(0,2e3).then(function(){})},$scope.tags="none",$scope.trackEvent=function(catagory,action,label){Angularytics.trackEvent(catagory,action,label)},$scope.userClickForScholarship=function(numberOfClick){$location.path("/register"),Blog.userClickForScholarship(numberOfClick)},$scope.logoutUsersOtherThanStudent=function(){$scope.signedIn&&"undefined"==typeof $scope.user.profile.profiletype&&"student"!==$scope.user.profile.profiletype&&(AuthCollege.logout(),AdminAuth.logout(),AuthMentor.logout(),AuthSchool.logout())},$scope.getPost=function(){$scope.numberOfPostsLoaded=2,Blog.getPost($scope),$interval(function(){var temp=$location.path(),data=temp.split("/");"blog"===data[1]&&Blog.loadMoreBlogs($scope.postNumber,$scope)},5e3,5)},$scope.loadMoreBlogs=function(){Blog.loadMoreBlogs($scope.postNumber,$scope)},$scope.getPostDetail=function(){var postUrl=$location.path(),postId=postUrl.slice(-20);return Blog.getPostDetail(postId,$scope)},$scope.getCatagoryPosts=function(){var temp=$location.path(),data=temp.split("category/"),catagory=data[1];$scope.categoryName=catagory,Blog.getCatagoryPosts(catagory,$scope),$interval(function(){var temp=$location.path(),data=temp.split("/category/");"undefined"!=typeof data[1]&&"blog"!==data[1]&&Blog.loadMoreCatagoryBlogs(catagory,$scope.postNumber,$scope)},5e3,5)},$scope.loadMoreCatagoryBlogs=function(){var temp=$location.path(),data=temp.split("catagory/"),catagory=data[1];Blog.loadMoreCatagoryBlogs(catagory,$scope.postNumber,$scope)},$scope.updateYear=function(year){var path1="/view-monthly-post/"+year;$location.path(path1)},$scope.updateMonth=function(month){var temp=$location.path(),data=temp.split("view-monthly-post/"),year=data[1].slice(0,4),path="/view-monthly-post/"+year+month;$location.path(path)},$scope.getYearlyPosts=function(){var temp=$location.path(),data=temp.split("blog/"),year=data[1];Blog.getYearlyPosts(year,$scope)},$scope.getMonthlyPosts=function(month){var temp=$location.path(),data=temp.split("view-monthly-post/"),year=data[1].slice(0,4),month=data[1].slice(4,6);""===month&&""!==year?($scope.selectedYear=year,$scope.selectedMonth="none",Blog.getYearlyPosts(year,$scope)):""!==month&&""!==year&&($scope.selectedYear=year,$scope.selectedMonth="01"===month?"January":"02"===month?"February":"03"===month?"March":"04"===month?"April":"05"===month?"May":"06"===month?"June":"07"===month?"July":"08"===month?"August":"09"===month?"September":"10"===month?"October":"11"===month?"November":"December",Blog.getMonthlyPosts(year,month,$scope))},$scope.updateTimestamp=function(postNumber){$scope.postNumber=postNumber},$scope.getAllPostsForMentor=function(){$scope.mentorPosts=Blog.getAllPostsForMentor()},$scope.getMentorName=function(){$scope.mentorName=Blog.getMentorName(AuthMentor.resolveUser().uid)},$scope.getBlogComment=function(postId){$scope.blogCommentList=Blog.getBlogComment(postId)},$scope.getHouseProfile=function(){console.log("called");var temp=$location.path(),houseName=temp.split("/house/")[1];Blog.getHouseProfile(houseName,$scope)},$scope.getcategoryProfile=function(){var temp=$location.path(),houseName=temp.split("/category/")[1];Blog.getHouseProfile(houseName,$scope)},$scope.getCategoryPosts=function(){var temp=$location.path(),houseName=temp.split("/category/")[1];Blog.getHousePosts(houseName,$scope)},$scope.getHousePosts=function(){var temp=$location.path();$scope.currentLocation=temp.split("/")[1];var houseName=temp.split("/house/")[1];Blog.getHousePosts(houseName,$scope)},$scope.load_more_posts=function(){var temp=$location.path(),houseName=temp.split("/house/")[1];Blog.load_more_posts(houseName,$scope)},$scope.load_more_posts_for_guest_user=function(){var temp=$location.path(),houseName=temp.split("/category/")[1];Blog.load_more_posts(houseName,$scope)},$scope.getHouseMentors=function(){var temp=$location.path(),houseName=temp.split("/house/")[1];Blog.getHouseMentor(houseName,$scope)},$scope.PostComments=[],$scope.commentSubmitError=[],$scope.addHousePostComment=function(postId,PostComments,postKey){if($scope.commentSubmitError[postKey]="","undefined"==typeof PostComments||""===PostComments)$scope.PostComments[postKey]="",$scope.commentSubmitError[postKey]="Please write a comment";else{var commentDate=new Date,date=$filter("date")(commentDate,"yyyyMMdd"),commentTime=(commentDate.getHours()<10?"0":"")+commentDate.getHours()+":"+(commentDate.getMinutes()<10?"0":"")+commentDate.getMinutes(),time=(commentDate.getHours()<10?"0":"")+commentDate.getHours()+":"+(commentDate.getMinutes()<10?"0":"")+commentDate.getMinutes()+":"+(commentDate.getSeconds()<10?"0":"")+commentDate.getSeconds()+":"+(commentDate.getMilliseconds()<10?"0":"")+commentDate.getMilliseconds(),temporary=time.split(":"),timestamp=date.toString()+temporary[0].toString()+temporary[1].toString()+temporary[2].toString()+temporary[3].toString();Blog.addHousePostComment(postKey,postId,$scope.PostComments[postKey],$scope.user.profile.$id,date,commentTime,timestamp,$scope.user.profile.studentphoto,$scope.user.profile.studentname,$scope),$scope.PostComments[postKey]="",$scope.$evalAsync()}},$scope.initializeCommentEditing=function(commentId,postId){$(".commentBox"+postId).hide(),$(".commentImg"+postId).hide(),$(".commentButton"+postId).hide(),$(".commenterImgC"+commentId+"P"+postId).hide(),$(".originalCommentDataC"+commentId+"P"+postId).hide(),$(".originalCommentToolsC"+commentId+"P"+postId).hide(),$(".editCommentsDivC"+commentId+"P"+postId).show(),$(".editCommentsDivC"+commentId+"P"+postId).show(),$(".editCommentBoxC"+commentId+"P"+postId).show(),$(".editCommentButtonC"+commentId+"P"+postId).show()},$scope.editPostComment=function(postId,PostComments,postKey,commentKey,commentId){$("#editCommentsDiv"+postKey).hide(),$("#editCommentImg"+postKey).hide(),$("#editCommentBox"+postKey).hide(),$("#editCommentButton"+postKey).hide(),$(".editCommentsDivC"+commentKey+"P"+postKey).hide(),$(".editCommentsDivC"+commentKey+"P"+postKey).hide(),$(".editCommentBoxC"+commentKey+"P"+postKey).hide(),$(".editCommentButtonC"+commentKey+"P"+postKey).hide(),$(".commentBox"+postKey).show(),$(".commentImg"+postKey).show(),$(".commentButton"+postKey).show(),$(".commenterImgC"+commentKey+"P"+postKey).show(),$(".originalCommentDataC"+commentKey+"P"+postKey).show(),$(".originalCommentToolsC"+commentKey+"P"+postKey).show(),Blog.editPostComment(postId,PostComments,postKey,commentKey,commentId)},$scope.likeThisComment=function(commentId,postId){Blog.likeThisComment(commentId,postId,$scope.user.profile.$id,$scope)},$scope.getNumberOfLikesOnThisComment=function(postId,commentId){Blog.getNumberOfLikesOnThisComment(postId,commentId,$scope)},$scope.deletePostComment=function(postId,PostComments,postKey,commentId){Blog.deletePostComment(postId,PostComments,postKey,commentId)},$scope.comments=[],$scope.totalComments=[],$scope.comment_loaded=[],$scope.hideLoadMoreButton=[],$scope.userName=[],$scope.userPic=[],$scope.numberOfLikesOnThisComment=[],$scope.loadPostComments=function(postId,postKey){Blog.loadPostComments(postId,postKey,$scope)},$scope.loadMoreComments=function(postId,postKey){Blog.loadMoreComments(postId,postKey,$scope)},$scope.setFocusOnCommentBox=function(postId){$(".commentBox"+postId).focus()},$scope.displayCommentSection=function(postId){$(".commnt-part"+postId).show(1e3)},$scope.displaySharerButtons=function(postId){$("#sharebar"+postId).toggle(500)}}]).value("duScrollOffset",30),app.controller("CollegeProfileCtrl",["$scope","$location","$document","$http","$filter","$log","$sce","Angularytics","Webinar","AuthCollege","Auth","Search","Session","toaster","Blog",function($scope,$location,$document,$http,$filter,$log,$sce,Angularytics,Webinar,AuthCollege,Auth,Search,Session,toaster,Blog){var str=$location.path(),collegeIdArraySplit=str.split("/college-profile/");$scope.userc=AuthCollege.userc,$scope.user=Auth.user,$scope.query="",$scope.signedIn=Auth.signedIn,$scope.submitsuccesstext=!1,$scope.emailNotVerified=!1,$scope.sessionExists="undefined",$scope.webinar_booking_success=[],$scope.webinarAlreadyBooked=[],$scope.ugCourses=["Engineering","Computer Applications/IT","Biotechnology","Microbiology","Agriculture","Food Technology","Nutrition and Dietetics","Arts (Humanities)","Library Science","Management","Commerce","Economics","Hotel Management/Hospitality and Tourism","Architecture","Planning","Fine Arts","Performing Arts","Pharmaceutical Sciences","Ayurvedic Pharmaceutical Sciences","Physiotherapy","Paramedical Sciences","Education","Physical Education","Law","Design","Sciences","Nursing","Film & Television","Media & Journalism"],$scope.pgCourses=["Engineering","Computer Applications / IT","Biotechnology","Microbiology","Biochemistry","Agriculture","Food Technology","Nutrition and Dietetics","English and Foreign Languages","Indian Languages","Library Science","Sociology","Geography","Management","Commerce","Economics","Hotel Management/Hospitality and Tourism","Architecture","Planning","Fine Arts","Performing Arts","Pharmaceutical Sciences","Ayurvedic Pharmaceutical Sciences","Physiotherapy","Paramedical Sciences","History","Political Science","Psychology","Education","Physical Education","Law","Design","Sciences","Nursing","Film & Television","Media & Journalism"],$scope.studentblocked=!1,$scope.college=Search.find(collegeIdArraySplit[1]),"/"===$location.path(),$scope.trackEvent=function(catagory,action,label){Angularytics.trackEvent(catagory,action,label)},$scope.getStudentDashBoardPosts=function(){Blog.getStudentDashBoardPosts($scope)},$scope.getCollegeUpcommingWebinars=function(collegeId){Blog.getCollegeUpcommingWebinars($scope,collegeId)},$scope.getCollegeCompletedWebinars=function(collegeId){Blog.getCollegeCompletedWebinars($scope,collegeId)},$scope.seeCollegeFeed=function(collegeId){Blog.seeCollegeFeedcollegewise($scope,collegeId)},$scope.showCompletedVideo=[],$scope.videoURL=[],$scope.watchVedio=function(webinarId,liveStreamURL){var videoId=liveStreamURL.split(".be/")[1],vedioSrc="https://www.youtube.com/embed/"+videoId+"?controls=1";$scope.videoURL[webinarId]={src:vedioSrc,title:"Live Video URL"},$scope.showCompletedVideo[webinarId]="yes",console.log($scope.showCompletedVideo[webinarId])},$scope.stopVedio=function(webinarId){$scope.showCompletedVideo[webinarId]="no"},$scope.trustSrc=function(src){return $sce.trustAsResourceUrl(src)},$scope.trustMTCSrc=function(src){if("undefined"!=typeof src){var videoString=src,data=videoString.split("watch?v=");if("undefined"!=typeof data[1])var Id=data[1].split("&"),vedioId=Id[0];if("undefined"==typeof data[1]){Id=videoString.split(".be/");var vedioId=Id[1]}$scope.showHead=!1;var videourl="https://www.youtube.com/embed/"+vedioId+"?rel=0&amp;showinfo=0&modestbranding=1&autohide=1";return $sce.trustAsResourceUrl(videourl)}},$("#bookSession_session").hide(),$("#bookSession_webinar_btn").css("border-bottom","2px solid white"),$scope.change_bookSessionView=function(viewTab){"webinar"===viewTab?($("#bookSession_webinar_btn").css("border-bottom","2px solid white"),$("#bookSession_session_btn").css("border-bottom",""),$("#bookSession_session").hide(),$("#bookSession_webinar").show()):"session"===viewTab&&($("#bookSession_session_btn").css("border-bottom","2px solid white"),$("#bookSession_webinar_btn").css("border-bottom",""),$("#bookSession_session").show(),$("#bookSession_webinar").hide())},$scope.getUpcommingWebinar=function(collegeId){Webinar.getUpcomingCollegeWebinar(collegeId,$scope)},$scope.getCurrentWebinarDetails=function(webinarDetail){$scope.currentWebinar=webinarDetail},$scope.bookThisSession=function(currentWebinar){var currentStudent=Auth.resolveUser().auth.uid;Webinar.bookWebinar($scope,currentWebinar.mentorName,currentWebinar.mentorEmail,currentWebinar.mentorMobile,currentWebinar.mentorGender,currentWebinar.mentorPhoto,currentWebinar.webinarTopic,currentWebinar.webinarDate,currentWebinar.webinarTime,currentWebinar.webinarDescription,currentWebinar.webinarDuration,currentWebinar.studentsAttending,currentWebinar.collegeId,currentWebinar.webinarId,currentStudent)};var webinarTopic="";$scope.checkWebinarRequest=function(ug,pg,aboutwebinar){"undefined"==typeof ug&&"undefined"==typeof pg&&($scope.empty="Please select a topic"),null===ug&&null===pg&&($scope.empty="Please select a topic"),("undefined"!=typeof ug||"undefined"!=typeof pg)&&("undefined"!=typeof ug&&null!==ug&&(webinarTopic=ug),"undefined"!=typeof pg&&null!==pg&&(webinarTopic=pg),"undefined"==typeof aboutwebinar?$scope.empty="Please write something about your chosen topic":$scope.getNotifiedForWebinar(aboutwebinar,webinarTopic))
},$scope.getNotifiedForWebinar=function(aboutwebinar,webinarTopic){$scope.empty="",toaster.pop("wait","Webinar","Sending Request",1e4);var dataToPost={webinarTopic:webinarTopic,aboutwebinar:aboutwebinar,college:$scope.college.collegename,sname:$scope.user.profile.studentname,email:$scope.user.profile.email,phone:$scope.user.profile.studentmobile};$http({url:"/sendmailtoadminForwebinarRequest",method:"GET",params:{college:dataToPost.college,sname:dataToPost.sname,webinarTopic:dataToPost.webinarTopic,aboutwebinar:dataToPost.aboutwebinar,phone:dataToPost.phone,email:dataToPost.email}}).success(function(serverResponse){toaster.clear(),toaster.pop("success","Thankyou!","we have received your request."),console.log(serverResponse)}).error(function(serverResponse){toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time."),console.log(serverResponse)});var dataToPostcollege={to:$scope.college.counselloremail,college:$scope.college.collegename,sname:$scope.user.profile.studentname,webinarTopic:webinarTopic,aboutwebinar:aboutwebinar};$http({url:"/sendmailtocollegeForwebinarRequest",method:"GET",params:{to:dataToPostcollege.to,sname:dataToPostcollege.sname,college:dataToPostcollege.college,webinarTopic:dataToPost.webinarTopic,aboutwebinar:dataToPost.aboutwebinar}}).success(function(serverResponse){console.log(serverResponse)}).error(function(serverResponse){console.log(serverResponse)})},$scope.resendemail=function(){var urlId=Auth.resolveUser().uid;toaster.pop("wait","Email verification","Sending Email",1e4);var dataToPost={to:$scope.user.profile.email,pass:$scope.user.profile.password,sname:$scope.user.profile.studentname,hashkey:$scope.user.profile.md5_hash,urlId:urlId};$http({url:"/sendstudentmail",method:"GET",params:{to:dataToPost.to,sname:dataToPost.sname,pass:dataToPost.pass,hashkey:dataToPost.hashkey,urlId:dataToPost.urlId}}).success(function(serverResponse){"sent"==serverResponse?(toaster.clear(),toaster.pop("success","Thankyou!","Please check your email for the verification link."),console.log(serverResponse)):"error"==serverResponse?(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time."),console.log(serverResponse)):(toaster.clear(),toaster.pop("success","Thankyou!","Please check your email for the verification link."),console.log(serverResponse))}).error(function(serverResponse){"sent"==serverResponse?(toaster.clear(),toaster.pop("success","Thankyou!","Please check your email for the verification link."),console.log(serverResponse)):"error"==serverResponse?(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time."),console.log(serverResponse)):(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time."),console.log(serverResponse))})},$scope.unblock=function(){toaster.pop("wait","Unblock Request","Sending Email",1e4);var dataToPost={sname:$scope.user.profile.studentname,email:$scope.user.profile.email};$http({url:"/sendunblockmail",method:"GET",params:{studentname:dataToPost.sname,studentemail:dataToPost.email}}).success(function(serverResponse){"sent"==serverResponse?(toaster.clear(),toaster.pop("success","Thankyou!","Our team will review your request."),console.log(serverResponse)):"error"==serverResponse?(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time."),console.log(serverResponse)):(toaster.clear(),toaster.pop("success","Thankyou!","Our team will review your request."),console.log(serverResponse))}).error(function(serverResponse){"sent"==serverResponse?(toaster.clear(),toaster.pop("success","Thankyou!","Our team will review your request."),console.log(serverResponse)):"error"==serverResponse?(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time."),console.log(serverResponse)):(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time."),console.log(serverResponse))})},$scope.close_all_pop=function(){$scope.emailNotVerified=!1},$scope.sessionQuery=function(collegeId){Session.sessionQuery(collegeId,$scope)},$scope.bookSession=function(date,time,collegeId,studenturlid,collegeurlid,studentEmailVerificationStatus,sessions,studentStatus){$scope.studentblocked=!0,Session.doesSessionExists(collegeId).then(function(result){if($scope.sessionExists=result,$scope.sessionExists===!0)$scope.sessionQuery(collegeId);else if($scope.sessionExists===!1)if("false"===studentEmailVerificationStatus)$scope.emailNotVerified=!0;else if("true"===studentEmailVerificationStatus&&"block"!==studentStatus){Session.booksession(collegeId,studenturlid,collegeurlid,time.getHours(),time.getMinutes(),$filter("date")(date,"d MMMM yyyy Z"),$scope.user.query),$scope.submitsuccesstext=!0;var dataToPostCollege={to:$scope.college.counselloremail,hour:time.getHours(),minute:time.getMinutes(),date:$filter("date")(date,"d MMMM yyyy Z"),query:$scope.user.query,cname:$scope.college.collegename,sname:$scope.user.profile.studentname};$http({url:"/sendsessionmailtocollege",method:"GET",params:{to:dataToPostCollege.to,hour:dataToPostCollege.hour,minute:dataToPostCollege.minute,query:dataToPostCollege.query,cname:dataToPostCollege.cname,sname:dataToPostCollege.sname,date:dataToPostCollege.date}}).success(function(serverResponse){console.log(serverResponse)}).error(function(serverResponse){console.log(serverResponse)});{({hour:time.getHours(),minute:time.getMinutes(),date:$filter("date")(date,"d MMMM yyyy Z"),query:$scope.user.query,cname:$scope.college.collegename,sname:$scope.user.profile.studentname})}$http({url:"/sendsessionmailtosupport",method:"GET",params:{hour:dataToPostCollege.hour,minute:dataToPostCollege.minute,query:dataToPostCollege.query,cname:dataToPostCollege.cname,sname:dataToPostCollege.sname,date:dataToPostCollege.date}}).success(function(serverResponse){console.log(serverResponse)}).error(function(serverResponse){console.log(serverResponse)});var dataToPostStudent={to:$scope.user.profile.email,hour:time.getHours(),minute:time.getMinutes(),date:$filter("date")(date,"d MMMM yyyy Z"),query:$scope.user.query,cname:$scope.college.collegename,sname:$scope.user.profile.studentname};$http({url:"/sendsessionmailtostudent",method:"GET",params:{to:dataToPostStudent.to,hour:dataToPostStudent.hour,minute:dataToPostStudent.minute,query:dataToPostStudent.query,cname:dataToPostStudent.cname,sname:dataToPostStudent.sname,date:dataToPostStudent.date}}).success(function(serverResponse){console.log(serverResponse)}).error(function(serverResponse){console.log(serverResponse)});var StudentId=Auth.resolveUser().auth.uid;Auth.followCollege(collegeId,StudentId,$scope)}})},$scope.available=function(){return"online"==$scope.college.collegeAvailability?!0:void 0},$scope.toTheTop=function(){$document.scrollTopAnimated(0,2e3).then(function(){})},$scope.notavailable=function(){return"offline"==$scope.college.collegeAvailability?!0:void 0},$scope.today=function(){$scope.dt=new Date},$scope.today(),$scope.clear=function(){$scope.dt=null},$scope.disabled=function(date,mode){return"day"===mode&&(0===date.getDay()||6===date.getDay())},$scope.toggleMin=function(){$scope.minDate=new Date},$scope.toggleMin(),$scope.open=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.opened=!0},$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],$scope.format=$scope.formats[0],$scope.mytime=new Date,$scope.hstep=1,$scope.mstep=15,$scope.options={hstep:[1,2,3],mstep:[1,5,10,15,25,30]},$scope.ismeridian=!0,$scope.toggleMode=function(){$scope.ismeridian=!$scope.ismeridian},$scope.update=function(){var d=new Date;d.setHours(14),d.setMinutes(0),$scope.mytime=d},$scope.changed=function(){$log.log("Time changed to: "+$scope.mytime)},$scope.clear=function(){$scope.mytime=null},$scope.text="Following",$scope.hover=!1,$scope.changeText=function(){$scope.text="Unfollow",$scope.hover=!0},$scope.resetText=function(){$scope.text="Following",$scope.hover=!1},$scope.followCollege=function(collegeId){var StudentId=Auth.resolveUser().auth.uid;Auth.followCollege(collegeId,StudentId,$scope),$scope.text="Following",$scope.hover=!1},$scope.unfollowCollege=function(collegeId){var StudentId=Auth.resolveUser().auth.uid;Auth.unfollowCollege(collegeId,StudentId,$scope)},$scope.getfollowers=function(collegeId){var StudentId=Auth.resolveUser().auth.uid;Auth.getfollowers(collegeId,StudentId,$scope)}}]).value("duScrollOffset",30),app.controller("ContactCtrl",["$window","$document","$route","$scope","$http","toaster",function($window,$document,$route,$scope,$http){$scope.toTheTop=function(){$document.scrollTopAnimated(0,2e3).then(function(){})},$scope.sendContactMessage=function(){$scope.sendMessageSuccessfull="";var dataToPost={to:"angad@anhadedutrain.com",cc:"support@mymissionadmission.com",name:$scope.contact.name,email:$scope.contact.email,number:$scope.contact.number,message:$scope.contact.message};$http({url:"/sendcontactusemail",method:"GET",params:{to:dataToPost.to,cc:dataToPost.cc,name:dataToPost.name,email:dataToPost.email,number:dataToPost.number,message:dataToPost.message}}).success(function(serverResponse){$scope.contact.name=null,$scope.contact.email=null,$scope.contact.number=null,$scope.contact.message=null,$scope.sendMessageSuccessfull="Done",console.log(serverResponse)}).error(function(serverResponse){$scope.sendMessageSuccessfull="Not Done",console.log(serverResponse)})}}]).value("duScrollOffset",30),app.controller("MainCtrl",["$window","$route","$scope","$http","$log","$document","$location","$sce","Angularytics","md5","toaster","Auth","Search","dropdownFactory","Webinar",function($window,$route,$scope,$http,$log,$document,$location,$sce,Angularytics,md5,toaster,Auth,Search,dropdownFactory,Webinar){$scope.signedIn=Auth.signedIn,$scope.logout=Auth.logout,$scope.user=Auth.user,$scope.posTemp="",$scope.successmessage="",$scope.knowMoreClicked="false",$scope.webinar_booking_success=[],$scope.webinarAlreadyBooked=[],$scope.anyLiveWebinars=[],$scope.$route=$route,$scope.error="",$scope.custom={video:"FXh6tuXPXGU",player:null,vars:{controls:0,rel:0}},$scope.gender=[{name:"Male"},{name:"Female"}],$scope.trackEvent=function(catagory,action,label){Angularytics.trackEvent(catagory,action,label)},$scope.isAnyWebinarLive=function(){$scope.anyLiveWebinars=Webinar.isAnyWebinarLive()},$scope.getLocationDefaultNavBar=function(){var loc=$location.path();"/live-webinar"===loc?($("#nav-login-form").hide(),$("#nav-how-it-works").hide()):($("#nav-login-form").show(),$("#nav-how-it-works").show())},$scope.showWebinar=function(webinar){$scope.currentLiveWebinar=webinar,Auth.signedIn()?($scope.bookThisWebinar(Auth.resolveUser().auth.uid,webinar),$scope.getQNAdetails(webinar),$scope.getVedioSrc(webinar.liveStreamURL),$("#listOfLiveWebinar").hide(),$("#LiveWebinar").show()):$(".xxaa").css("border","3px solid red")},$scope.bookThisWebinar=function(currentStudent,currentWebinar){var currentStudent=currentStudent;Webinar.bookWebinar($scope,currentWebinar.liveStreamURL,currentWebinar.mentorName,currentWebinar.mentorEmail,currentWebinar.mentorMobile,currentWebinar.mentorGender,currentWebinar.mentorPhoto,currentWebinar.webinarTopic,currentWebinar.webinarDate,currentWebinar.webinarTime,currentWebinar.webinarDescription,currentWebinar.webinarDuration,currentWebinar.studentsAttending,currentWebinar.collegeId,currentWebinar.webinarId,currentStudent)},$scope.getVedioSrc=function(liveStreamURL){var Id=liveStreamURL.split(".be/"),vedioId=Id[1],videourl="https://www.youtube.com/embed/"+vedioId+"?rel=0&amp;showinfo=0&modestbranding=1&autohide=1";$scope.video={src:videourl,title:"LiveStreamUrl"}},$scope.getQNAdetails=function(webinar){Webinar.getQNAdetails(webinar,$scope)},$scope.askQuestion=function(question){Webinar.studentAskedAQuestion($scope.user.uid,$scope.user.profile.studentname,$scope.currentLiveWebinar,question,$scope),$scope.question=""},$scope.loginforlive=function(studentemail,studentpassword){$scope.modalShown=!0,Auth.login(studentemail,studentpassword,$scope).then(function(){var usertype=Auth.resolveUser().auth.uid;$scope.modalShown=!1,$scope.getQNAdetails($scope.currentLiveWebinar),$scope.getVedioSrc($scope.currentLiveWebinar.liveStreamURL),$scope.bookThisWebinar(usertype,$scope.currentLiveWebinar),$("#listOfLiveWebinar").hide(),$("#LiveWebinar").show()})},$scope.registerforlive=function(studentname,email,password,studentmobile,gender){"undefined"!=typeof $scope.currentLiveWebinar?($scope.submitbuttondisabled=!0,$scope.modalShown=!0,Auth.register($scope.user).then(function(user){return Auth.login($scope.user.email,$scope.user.password,$scope).then(function(){return user.md5_hash=md5.createHash($scope.user.email||""),user.studentname=studentname,user.studentmobile=studentmobile,user.email=angular.lowercase(email),user.gender=gender,user.password=password,user.profiletype="student",user.studentAvailability="offline",user.studentstatus="notverified",user.emailverificationstatus="false",user.referredBy="nobody",user.studentphoto="https://www.filepicker.io/api/file/zEAoaiVbRRW0HrtJApxM",Auth.createProfile(user)}).then(function(){$scope.modalShown=!1;var urlId=user.uid;Auth.createAdminForStudent(user);var dataToPost={to:user.email,pass:user.password,sname:user.studentname,hashkey:user.md5_hash,semail:user.email,smobile:user.studentmobile,urlId:urlId};$http({url:"/sendstudentmail",method:"GET",params:{to:dataToPost.to,sname:dataToPost.sname,pass:dataToPost.pass,hashkey:dataToPost.hashkey,urlId:dataToPost.urlId}}).success(function(serverResponse){console.log(serverResponse)}).error(function(serverResponse){console.log(serverResponse)}),$http({url:"/sendstudentregistrationmail",method:"GET",params:{to:dataToPost.to,semail:dataToPost.semail,sname:dataToPost.sname,pass:dataToPost.pass,smobile:dataToPost.smobile}}).success(function(serverResponse){console.log(serverResponse)}).error(function(serverResponse){console.log(serverResponse)}),$scope.modalShown=!1,$scope.bookThisWebinar(user.uid,$scope.currentLiveWebinar),$scope.getQNAdetails($scope.currentLiveWebinar),$scope.getVedioSrc($scope.currentLiveWebinar.liveStreamURL),$("#listOfLiveWebinar").hide(),$("#LiveWebinar").show()})},function(error){$scope.modalShown=!1,$scope.submitbuttondisabled=!1,$scope.error=error.message,$("#signupemail").css({border:"2px solid red",color:"red"})}),$scope.message="",$scope.error=""):$scope.register(studentname,email,password,studentmobile,gender)},$scope.trustSrc=function(src){return $sce.trustAsResourceUrl(src)},$scope.AfterOAuthLogin=function(){var uid=Auth.resolveUser().uid;Auth.AfterOAuthLogin($scope.user.profile.email,$scope.user.profile.studentmobile,uid,$scope)},$scope.loginusingfb=function(){Auth.loginusingfb($scope.user,$scope)},$scope.loginusinggoogle=function(){Auth.loginusinggoogle($scope.user,$scope)},$scope.login=function(){$scope.modalShown=!0,Auth.login($scope.user.stuemail,$scope.user.stupassword,$scope).then(function(){Auth.resolveUser().auth.uid;$location.path("/dashboard")})},$scope.doThisForStudent=function(studentEmail1){studentEmail1=angular.lowercase(studentEmail1),studentEmail1?Search.getStudentIdByEmail(studentEmail1).then(function(result){$scope.student1Uid=result,"user doesnot exists"!==$scope.student1Uid?($scope.student1IdFlag="Done",$scope.student1Name=Search.getStudentName($scope.student1Uid)):$scope.student1IdFlag="Not Done"},function(error){$scope.student1IdFlag="Not Done",console.log(error)}):($scope.student1IdFlag="",$scope.student1Uid="")},$scope.toTheTop=function(){$document.scrollTopAnimated(0,2e3).then(function(){})},$scope.register=function(studentname,email,password,studentmobile,gender){$scope.submitbuttondisabled=!0,$scope.modalShown=!0,Auth.register($scope.user).then(function(user){return Auth.login($scope.user.email,$scope.user.password,$scope).then(function(){return user.md5_hash=md5.createHash($scope.user.email||""),user.studentname=studentname,user.studentmobile=studentmobile,user.email=angular.lowercase(email),user.gender=gender,user.password=password,user.profiletype="student",user.studentAvailability="offline",user.studentstatus="notverified",user.emailverificationstatus="false",user.referredBy="nobody",user.studentphoto="https://www.filepicker.io/api/file/zEAoaiVbRRW0HrtJApxM",Auth.createProfile(user)}).then(function(){$scope.modalShown=!1;var urlId=user.uid;Auth.createAdminForStudent(user);var dataToPost={to:user.email,pass:user.password,sname:user.studentname,hashkey:user.md5_hash,semail:user.email,smobile:user.studentmobile,urlId:urlId};$http({url:"/sendstudentmail",method:"GET",params:{to:dataToPost.to,sname:dataToPost.sname,pass:dataToPost.pass,hashkey:dataToPost.hashkey,urlId:dataToPost.urlId}}).success(function(serverResponse){console.log(serverResponse)}).error(function(serverResponse){console.log(serverResponse)}),$http({url:"/sendstudentregistrationmail",method:"GET",params:{to:dataToPost.to,semail:dataToPost.semail,sname:dataToPost.sname,pass:dataToPost.pass,smobile:dataToPost.smobile}}).success(function(serverResponse){console.log(serverResponse)}).error(function(serverResponse){console.log(serverResponse)}),$location.path("/signup-success")})},function(error){$scope.modalShown=!1,$scope.submitbuttondisabled=!1,$scope.error=error.message,$("#signupemail").css({border:"2px solid red",color:"red"})}),$scope.message="",$scope.error=""},$scope.clearall=function(){$scope.error="",$("#signupemail").css({border:"1px solid rgba(92,169,214,.3)",color:"black"})},$scope.setDefaults=function(){var s=window.document.querySelector(".main-page-feature-second-how-it-works-img-div"),q=window.document.querySelector(".main-page-feature-third");s&&q&&(q.style.height="477px",s.style.height="1px")},$(window).scroll(function(){{var windowpos=$window.scrollY;$(".main-page-feature-second-how-it-works-img-div")}windowpos>=0&&2100>windowpos?$(".main-page-feature-second-how-it-works-desktop-img img").css("margin-top","-5px"):windowpos>=2100&&2650>windowpos?$(".main-page-feature-second-how-it-works-desktop-img img").css("margin-top","-220px"):windowpos>=2650&&3100>windowpos?$(".main-page-feature-second-how-it-works-desktop-img img").css("margin-top","-445px"):windowpos>=3100&&$(".main-page-feature-second-how-it-works-desktop-img img").css("margin-top","-670px")}),$scope.stateSelectedFromSiteMap=function(stateId){$scope.stateToView=stateId,$scope.state="",$scope.state=dropdownFactory.getStateDropdownObject($scope.stateToView),$scope.disableButton1=!1,dropdownFactory.sendState($scope.state)},$scope.courseSelectedFromSiteMap=function(courseId){$scope.courseToView=courseId,$scope.course="",$scope.course=dropdownFactory.getCourseDropdownObject($scope.courseToView),$scope.disableButton2=!1,dropdownFactory.sendCourse($scope.course)},$scope.state="",$scope.go=function(path){$location.path(path)},$scope.dropdownMessage="Retrieving Locations...",$scope.states=dropdownFactory.getAllStateDropdownObjects(),$scope.stateSelected=function(){$scope.state="",$scope.state=dropdownFactory.getStateDropdownObject($scope.stateToView),$scope.disableButton1=!1,dropdownFactory.sendState($scope.state)},$scope.states.$loaded().then(function(){$scope.dropdownMessage="Where do you want to study?"}),$scope.toTheTop=function(){$document.scrollTopAnimated(0,2e3).then(function(){})},$scope.dropdownMessageCourses="Retrieving Courses...",$scope.courses=dropdownFactory.getAllCourseDropdownObjects(),$scope.courseSelected=function(){$scope.course="",$scope.course=dropdownFactory.getCourseDropdownObject($scope.courseToView),$scope.disableButton2=!1,dropdownFactory.sendCourse($scope.course)},$scope.pop=function(){toaster.pop("success","title","text")},$scope.courses.$loaded().then(function(){$scope.dropdownMessageCourses="What do you want to study?"}),$scope.androidNotification=function(){dropdownFactory.saveAndroidRequest($scope.notify.email).then(function(){var dataToPost={to:"support@gmail.com",email:$scope.notify.email};$http({url:"/sendandroidrequestmail",method:"GET",params:{to:dataToPost.to,email:dataToPost.email}}).success(function(serverResponse){$scope.notify.email=null,$scope.successmessage="Your Email is Received Thank you for Showing Interest.",console.log(serverResponse)}).error(function(serverResponse){$scope.successmessage="Something Went Wrong Please Try After Sometime.",console.log(serverResponse)})})},$scope.sendSuccessFully="Not Done",$scope.forgotPassword=function(){$scope.message="",$scope.sendSuccessFully="Not Done",dropdownFactory.forgotPassword($scope.user.email,$scope),$scope.user.email=""},$scope.resetPassword=function(){$scope.message="";var location=$location.path(),temp=location.split("abcd.xyz="),token=temp[1].split("&")[0],email=temp[1].split("&")[1].split("email=")[1];dropdownFactory.resetPassword(email,token,$scope.user.resetpassword,$scope),$scope.user.resetpassword="",$scope.confirm_password=""},$scope.isUserSignedIn=function(){if($scope.signedIn()===!1){{var w=window.innerWidth;window.innerHeight}767>w?($("#popup-background").hide(),$(".newsletter-message").hide()):($(".newsletter-message").show(),$("#popup-background").show())}else $(".newsletter-message").hide(),$("#popup-background").hide()},$scope.closeTheQueryModal=function(){$(".newsletter-message").fadeOut("slow",function(){$(".newsletter-message").remove(),$("#popup-background").fadeOut()})}}]).value("duScrollOffset",30),app.controller("MentorCtrl",["$scope","$filter","$window","$document","$timeout","$http","$location","$sce","toaster","AuthMentor","Auth","Blog",function($scope,$filter,$window,$document,$timeout,$http,$location,$sce,toaster,AuthMentor,Auth,Blog){$scope.userd=AuthMentor.userd,$scope.user=Auth.user,$scope.signedIn=Auth.signedIn,$scope.setActiveTab=function(){var path=$location.path();"/mentor-dashboard"===path?($scope.allPostActive="not-active",$scope.mentorDashActive="active",$scope.$evalAsync()):"/all-posts"===path&&($scope.allPostActive="active",$scope.mentorDashActive="not-active",$scope.$evalAsync())},$scope.getMentorDetails=function(){$scope.mentor=AuthMentor.getMentorDetails()},$scope.getAuthorDetailAndPost=function(){var authoruid=$location.path().split("author-profile/")[1];Blog.getAuthorDetailAndPost(authoruid,$scope)}}]).value("duScrollOffset",30),app.controller("NavCtrl",["$scope","$location","$rootScope","$routeParams","$route","Auth",function($scope,$location,$rootScope,$routeParams,$route,Auth){$scope.signedIn=Auth.signedIn,$scope.logout=Auth.logout,$scope.user=Auth.user,$scope.loc=$location.path(),$scope.$evalAsync(),$scope.$on("$routeChangeSuccess",function(){$scope.loc=$location.path(),$scope.$evalAsync()}),$scope.regpage=function(){return"/college"==$location.path()?!0:void 0},$scope.go=function(path){$location.path(path)}}]),app.controller("ReferCtrl",["$scope","$document","$controller","md5","$http","$location","Auth","user","Search",function($scope,$document,$controller,md5,$http,$location,Auth,user,Search){$scope.submitbuttondisabled=!1,user&&Auth.logout(),$scope.message="",$scope.referalstatus="",$scope.checkuid,$scope.checkloginuid;var str2,str4,referredBy;$scope.referId="Not",$scope.gender=[{name:"Male"},{name:"Female"}],$scope.roles=[{id:"0",text:"Engineering"},{id:"1",text:"Computer Applications / IT"},{id:"2",text:"Biotechnology"},{id:"3",text:"Microbiology"},{id:"4",text:"Agriculture"},{id:"5",text:"Food Technology"},{id:"6",text:"Nutrition and Dietetics"},{id:"7",text:"Arts (Humanities)"},{id:"8",text:"Library Science"},{id:"9",text:"Management"},{id:"10",text:"Commerce"},{id:"11",text:"Economics"},{id:"12",text:"Hotel Management/Hospitality and Tourism"},{id:"13",text:"Architecture"},{id:"14",text:"Planning"},{id:"15",text:"Fine Arts"},{id:"16",text:"Performing Arts"},{id:"17",text:"Pharmaceutical Sciences"},{id:"18",text:"Ayurvedic Pharmaceutical Sciences"},{id:"19",text:"Physiotherapy"},{id:"20",text:"Paramedical Sciences"},{id:"21",text:"Education"},{id:"22",text:"Physical Education"},{id:"23",text:"Law"},{id:"24",text:"Design"},{id:"25",text:"Sciences"},{id:"26",text:"Nursing"},{id:"27",text:"Film & Television"},{id:"28",text:"Media & Journalism"}],$scope.uSer={roles:[]},$scope.rolesA=[{idA:"0",textA:"Engineering"},{idA:"1",textA:"Computer Applications / IT"},{idA:"2",textA:"Biotechnology"},{idA:"3",textA:"Microbiology"},{idA:"4",textA:"Biochemistry"},{idA:"5",textA:"Agriculture"},{idA:"6",textA:"Food Technology"},{idA:"7",textA:"Nutrition and Dietetics"},{idA:"8",textA:"English and Foreign Languages"},{idA:"9",textA:"Indian Languages"},{idA:"10",textA:"Library Science"},{idA:"11",textA:"Sociology"},{idA:"12",textA:"Geography"},{idA:"13",textA:"Management"},{idA:"14",textA:"Commerce"},{idA:"15",textA:"Economics"},{idA:"16",textA:"Hotel Management/Hospitality and Tourism"},{idA:"17",textA:"Architecture"},{idA:"18",textA:"Planning"},{idA:"19",textA:"Fine Arts"},{idA:"20",textA:"Performing Arts"},{idA:"21",textA:"Pharmaceutical Sciences"},{idA:"22",textA:"Ayurvedic Pharmaceutical Sciences"},{idA:"23",textA:"Physiotherapy"},{idA:"24",textA:"Paramedical Sciences"},{idA:"25",textA:"History"},{idA:"26",textA:"Political Science"},{idA:"27",textA:"Psychology"},{idA:"28",textA:"Education"},{idA:"29",textA:"Physical Education"},{idA:"30",textA:"Law"},{idA:"31",textA:"Design"},{idA:"32",textA:"Sciences"},{idA:"33",textA:"Nursing"},{idA:"34",textA:"Film & Television"},{idA:"35",textA:"Media & Journalism"}],$scope.uSerA={rolesA:[]},$scope.error,$scope.login=function(){Auth.login($scope.user,$scope).then(function(){var usertype=Auth.resolveUser().uid;Auth.updatereferBy(usertype,referredBy,$scope),Search.getStudentIdByEmail(str4).then(function(result2){var new3=result2;Auth.saveEntry(new3,usertype),Auth.viewChanges(usertype).then(function(result15){if("Female"==result15.gender)var stugender="her";else stugender="his";var dataToPost={to:str4,sname:$scope.oldstudentname.$value,fname:result15.studentname,fgender:stugender};$http({url:"/sendacceptinvitemail",method:"GET",params:{to:dataToPost.to,sname:dataToPost.sname,fname:dataToPost.fname,fgender:dataToPost.fgender}}).success(function(serverResponse){console.log(serverResponse)}).error(function(serverResponse){console.log(serverResponse)})}),$location.path("/dashboard")})},function(error){console.log(error),$scope.error=error.message})},$scope.checkurl=function(){var str=$location.path(),data=str.split("/register/:");str2=data[1],Search.getStudentIdByEmail(str2).then(function(result){if($scope.checkuid=result,$scope.oldstudentname=Search.getStudentName($scope.checkuid),Auth.viewChanges(result).then(function(result11){"undefined"==typeof result11.referredBy&&($scope.yourstatus="old")}),"user doesnot exists"!==$scope.checkuid){{var stuSplit=$scope.checkuid.split(":");stuSplit[1]}$scope.user.referredBy=$scope.checkuid}else $scope.yourstatus="old",$scope.user.referredBy="nobody"},function(error){console.log(error)})},$scope.checkloginurl=function(){var strget=$location.path(),data1=strget.split("/login/:");str4=data1[1],$scope.friendsemail=str4,Search.getStudentIdByEmail(str4).then(function(result){if($scope.checkloginuid=result,$scope.oldstudentname=Search.getStudentName($scope.checkloginuid),Auth.viewChanges(result).then(function(result12){"undefined"==typeof result12.referredBy&&($scope.yourstatus="old")}),"user doesnot exists"!==$scope.checkloginuid){{var stuSplit=$scope.checkloginuid.split(":");stuSplit[1]}referredBy=$scope.checkloginuid}else $scope.yourstatus="old",referredBy="nobody"},function(error){console.log(error)})},$scope.doThisForCounsellor=function(collegeEmail){collegeEmail=angular.lowercase(collegeEmail),collegeEmail?Search.getCollegeIdByEmail(collegeEmail).then(function(result){$scope.collegeUid=result,"user doesnot exists"!==$scope.collegeUid?($scope.collegeIdFlag="Done",$scope.collegeName=Search.getCollegeName($scope.collegeUid)):$scope.collegeIdFlag="Not Done"},function(error){$scope.collegeIdFlag="Not Done",console.log(error)}):($scope.collegeIdFlag="",$scope.error="")},$scope.doThisForStudent=function(studentEmail1){$scope.error="",studentEmail1=angular.lowercase(studentEmail1),studentEmail1?Search.getStudentIdByEmail(studentEmail1).then(function(result){$scope.student1Uid=result,"user doesnot exists"!==$scope.student1Uid?($scope.student1IdFlag="Done",$scope.student1Name=Search.getStudentName($scope.student1Uid),Auth.viewChanges($scope.student1Uid).then(function(result1){if(str4===studentEmail1)$scope.student1IdFlag="",$scope.referalstatus="same";else if("undefined"==typeof result1.referredBy)$scope.referalstatus="old";else if("nobody"==result1.referredBy)$scope.referalstatus="Not";else if(result1.referredBy)$scope.referalstatus="Done";else{$scope.referalstatus="else";var dataToPost={usercc:studentEmail1};$http({url:"/sendmailforsuspiciousactivity",method:"GET",params:{usercc:dataToPost.usercc}}).success(function(serverResponse){console.log("sent"==serverResponse?serverResponse:"error"==serverResponse?serverResponse:serverResponse)}).error(function(serverResponse){console.log("sent"==serverResponse?serverResponse:"error"==serverResponse?serverResponse:serverResponse)})}})):($scope.student1IdFlag="Not Done",$scope.referalstatus="")},function(error){$scope.student1IdFlag="Not Done",$scope.referalstatus="",console.log(error)}):($scope.student1IdFlag="",$scope.student1Uid="",$scope.referalstatus="",$scope.error="")},$scope.toTheTop=function(){user&&Auth.logout(),$document.scrollTopAnimated(0,2e3).then(function(){})},$scope.showEmailText=!1,$scope.showEmail=function(){$scope.showEmailText=""==$scope.user.email?!1:!0},$scope.showPasswordText=!1,$scope.showPass=function(){$scope.showPasswordText=""==$scope.user.password?!1:!0},$scope.register=function(){$scope.submitbuttondisabled=!0,$scope.modalShown=!0;var check=!($scope.student_reg.confirm_password.$dirty&&$scope.student_reg.confirm_password.$error.validator),check1=!($scope.student_reg.confirm_email.$dirty&&$scope.student_reg.confirm_email.$error.validator);check&&check1?(Auth.register($scope.user).then(function(user){return Auth.login($scope.user).then(function(){return user.md5_hash=md5.createHash($scope.user.email||""),user.studentname=$scope.user.studentname,user.studentmobile=$scope.user.studentmobile,user.email=angular.lowercase($scope.user.email),user.fathername=$scope.user.fathername,user.gender=$scope.user.gender,user.password=$scope.user.password,user.profiletype="student",user.studentAvailability="offline",user.studentstatus="notverified",user.emailverificationstatus="false",user.referredBy=$scope.user.referredBy,user.studentphoto="https://www.filepicker.io/api/file/zEAoaiVbRRW0HrtJApxM",Auth.createProfile(user)}).then(function(){var userid=Auth.resolveUser().uid;Search.getStudentIdByEmail(str2).then(function(result4){var new4=result4;Auth.saveEntry(new4,userid,$scope.user.email),Auth.viewChanges(userid).then(function(result16){if("Female"==result16.gender)var stugender="her";else stugender="his";var dataToPost={to:str2,sname:$scope.oldstudentname.$value,fname:result16.studentname,fgender:stugender};$http({url:"/sendacceptinvitemail",method:"GET",params:{to:dataToPost.to,sname:dataToPost.sname,fname:dataToPost.fname,fgender:dataToPost.fgender}}).success(function(serverResponse){console.log(serverResponse)}).error(function(serverResponse){console.log(serverResponse)})})}),$scope.modalShown=!1;var str=user.uid,urlId=str.split(":");Auth.createAdminForStudent(user);var dataToPost={to:user.email,pass:$scope.user.password,sname:$scope.user.studentname,hashkey:user.md5_hash,urlId:urlId[1]};if($http({url:"/sendstudentmail",method:"GET",params:{to:dataToPost.to,sname:dataToPost.sname,pass:dataToPost.pass,hashkey:dataToPost.hashkey,urlId:dataToPost.urlId}}).success(function(serverResponse){console.log(serverResponse)}).error(function(serverResponse){console.log(serverResponse)}),"user doesnot exists"===$scope.checkuid){var dataToPost={to:str2,rname:$scope.user.studentname};$http({url:"/sendcheckrefermail",method:"GET",params:{to:dataToPost.to,rname:dataToPost.rname}}).success(function(serverResponse){console.log(serverResponse)
}).error(function(serverResponse){console.log(serverResponse)})}$location.path("/dashboard")})},function(error){$scope.modalShown=!1,$scope.submitbuttondisabled=!1,$scope.error=error.message}),$scope.message="",$scope.error=""):check1||check?check?($scope.modalShown=!1,$scope.submitbuttondisabled=!1,$scope.message="Please re-check emails"):($scope.modalShown=!1,$scope.submitbuttondisabled=!1,$scope.message="Please re-check passwords"):($scope.modalShown=!1,$scope.submitbuttondisabled=!1,$scope.message="Please re-check emails & passwords")}}]).value("duScrollOffset",30),app.controller("SearchCtrl",["$scope","dropdownFactory","$log","$document","$location","$window","$firebase","$firebaseArray","$firebaseObject","Angularytics","FIREBASE_URL","Auth","Search",function($scope,dropdownFactory,$log,$document,$location,$window,$firebase,$firebaseArray,$firebaseObject,Angularytics,FIREBASE_URL,Auth,Search){$scope.signedIn=Auth.signedIn,$scope.loginErrorModal=!1,$scope.trackEvent=function(catagory,action,label){Angularytics.trackEvent(catagory,action,label)};var ref=new Firebase(FIREBASE_URL+"profileForCollege/"),tempToggle=!0;$scope.searchToggle=function(){var a=document.getElementById("searchToggleBtn");tempToggle?(tempToggle=!1,$scope.colltype="paid",$scope.$evalAsync(),a.style.marginLeft="35px"):tempToggle||(tempToggle=!0,$scope.colltype="college",$scope.$evalAsync(),a.style.marginLeft=null)},$scope.user=Auth.user,$scope.colleges=Search.all,$scope.collegetype=Search.allAsArray,$scope.colltype="college",$scope.showHeading=!1,$scope.courseAlreadySelected=!1,$scope.waitShow=!1,$scope.backSeachColleges=[],$scope.stateCollegeShow=!1,$scope.currentState="",$scope.stateNotSelected=!1,$scope.allCollege=!1,$scope.hideSearch="",$scope.currentCourse="";var tempState="",stateValue="";$scope.dropdownMessage="Retrieving Locations...",$scope.states=Search.getAllStateDropdownObjects(),$scope.states.$loaded().then(function(){$scope.stateToView=null,$scope.dropdownMessage="Where do you want to study?";var stateValue=dropdownFactory.getStateValue();dropdownFactory.resetStateValue(),stateValue?(stateValue.$loaded(function(stateValue){$scope.dropdownMessage=stateValue.$value}).then(function(){$scope.stateToView=stateValue.$id,null!==$scope.stateToView&&$scope.searchCollegeByState()}),$scope.stateCollegeShow=!1,$scope.collegeNotFound=!1):$scope.stateToView=null}),$scope.selectCollegeByStateId=function(){Search.getCollegesList($scope.stateToView,$scope.courseToView).then(function(){})},$scope.selectCollegeByCouseId=function(){Search.getCourseCollegesList($scope.courseToView).then(function(){})},$scope.sendStateToView=function(){Search.setStateToView(stateValue.$value)},$scope.sendCourseToView=function(){Search.setStateToView($scope.dropdownMessageCourses)},$scope.initializeStateToView=function(stateToView){$scope.stateToView=stateToView},$scope.initializeCourseToView=function(courseToView){$scope.courseToView=courseToView},$scope.updateSubfilter=function(subfilter){$scope.subfilter=subfilter,$scope.$evalAsync()},$scope.searchCollegeByState=function(){null===$scope.stateToView?null==$scope.courseToView?($scope.searchColleges=[],$scope.searchColleges=$firebaseArray(new Firebase(FIREBASE_URL+"profileForCollege/")),$scope.currentCourse="",$scope.currentState="",$scope.allCollege=!0):($scope.searchCollegeByCourse(),$scope.currentState="",$scope.stateNotSelected=!0,$scope.allCollege=!1):($scope.allCollege=!1,$scope.stateNotSelected=!1,Search.getCollegeByState($scope.stateToView).then(function(collegeList){$scope.searchColleges=collegeList,$scope.currentState=$scope.searchColleges[0].collegestate,$scope.trackEvent("Search Page Dropdowns","Searched College By State "+$scope.currentState,"Statewise College Search"),tempState=$scope.searchColleges[0].collegestate,$scope.CollegeShow=!0,$scope.collegeNotFound=!1,$scope.backSeachColleges=$scope.searchColleges,$scope.dropdownMessage="Where do you want to study?",""!=$scope.currentCourse||$scope.courseAlreadySelected===!0&&null!==$scope.courseToView?($scope.courseAlreadySelected=!1,$scope.searchCollegeByCourse()):$scope.dropdownMessageCourses="What do you want to study?"}))},$scope.searchCollegeByCourse=function(){if(null==$scope.courseToView)null==$scope.stateToView?($scope.searchColleges=[],$scope.searchColleges=$firebaseArray(new Firebase(FIREBASE_URL+"profileForCollege/")),$scope.currentCourse="",$scope.currentState="",$scope.allCollege=!0):($scope.searchCollegeByState(),$scope.currentCourse="",$scope.allCollege=!1);else{$scope.allCollege=!1,$scope.collegeNotFound=!1,$scope.CollegeShow=!0,$scope.tempCollegeList=[],$scope.currentCourse="","undefined"!=typeof $scope.searchColleges&&0==$scope.stateNotSelected&&($scope.searchColleges=$scope.backSeachColleges),$scope.dropdownMessageCourses="What do you want to study?";var courseName=$firebaseObject(new Firebase(FIREBASE_URL+"courseList/courses/"+$scope.courseToView));courseName.$loaded(function(courseName){var courseInCollege=$firebaseArray(new Firebase(FIREBASE_URL+"CourseCollegeSearch/"+courseName.$value+"/"));courseInCollege.$loaded(function(courseInCollege){if($scope.currentCourse=courseName.$value,$scope.trackEvent("Search Page Dropdowns","Searched College By Course "+$scope.currentCourse,"Coursewise College Search"),0!==courseInCollege.length)if(1==$scope.stateNotSelected||"undefined"==typeof $scope.searchColleges||null==$scope.stateToView||null==$scope.courseToView)for(var i=0;i<courseInCollege.length;i++){var collegeref=$firebaseObject(ref.child(courseInCollege[i].$id));collegeref.$loaded(function(collegeref){$scope.tempCollegeList.push(collegeref)}).then(function(){$scope.courseAlreadySelected=!0,$scope.collegeNotFound=!1,$scope.backSeachColleges=$scope.tempCollegeList,$scope.searchColleges=$scope.tempCollegeList})}else for(var courseLenght=courseInCollege.length,allCollegeLenght=$scope.searchColleges.length,i=0;courseLenght>i;i++)for(var j=0;allCollegeLenght>j;j++)courseInCollege[i].$id===$scope.searchColleges[j].$id&&$scope.searchColleges[j].collegestate==tempState&&"verified"===$scope.searchColleges[j].verifiedcollege&&$scope.tempCollegeList.push($scope.searchColleges[j])}).then(function(){(0===courseInCollege.length||0===$scope.tempCollegeList.length&&"undefined"!=typeof $scope.searchColleges)&&($scope.collegeNotFound=!0,$scope.CollegeShow=!1,$scope.searchColleges=[]),0!==$scope.tempCollegeList.length&&($scope.searchColleges=[],$scope.searchColleges=$scope.tempCollegeList,$scope.collegeNotFound=!1,$scope.dropdownMessageCourses="What do you want to study?")})})}},$scope.searchAllColleges=function(){"undefined"==typeof $scope.stateToView&&"undefined"==typeof $scope.courseToView&&($scope.searchColleges=$firebaseArray(new Firebase(FIREBASE_URL+"profileForCollege/")),$scope.allCollege=!0)},$scope.copyStateToView=function(stateName){"Where do you want to study?"!==$scope.dropdownMessage&&Search.getStateIdByName(stateName).then(function(stateId){$scope.stateToView=stateId,""!==iteration2[0]&&$scope.stateSelected()}),$scope.waitShow=!1},$scope.copyCourseToView=function(courseName){"What do you want to study?"!==$scope.dropdownMessageCourses&&Search.getCourseIdByName(courseName).then(function(courseId){$scope.courseToView=courseId,""!==iteration2[1]&&$scope.courseSelected()}),$scope.waitShow=!1},$scope.dropdownMessageCourses="Retrieving Courses...",$scope.courses=Search.getAllCourseDropdownObjects(),$scope.courseSelected=function(){$scope.course=Search.getCourseDropdownObject($scope.courseToView),$scope.waitShow=!0,"What do you want to study?"!==$scope.dropdownMessageCourses},$scope.courses.$loaded().then(function(){$scope.courseToView=null,$scope.dropdownMessageCourses="What do you want to study?";var courseValue=dropdownFactory.getCourseValue();dropdownFactory.resetCourseValue(),courseValue&&courseValue.$loaded(function(courseValue){$scope.dropdownMessageCourses=courseValue.$value}).then(function(){$scope.courseToView=courseValue.$id,$scope.collegeNotFound=!1,null!==$scope.courseToView&&$scope.searchCollegeByCourse()})}),$scope.toTheTop=function(){$document.scrollTopAnimated(0,2e3).then(function(){})},$scope.loginError=function(name,affiliation,state,image){$scope.collegeName=name,$scope.collegeAff=affiliation,$scope.collegeState=state,$scope.collegeImage=image,$scope.loginErrorModal=!0,$scope.$applyAsync()},$scope.close=function(){$scope.loginErrorModal=!1,$scope.$applyAsync()},$scope.storeview=function(collegeId){Search.storeview(collegeId)}}]).value("duScrollOffset",30),app.controller("StudentDashCtrl",["$location","$document","$controller","$http","$sce","$scope","Angularytics","toaster","Search","Auth","Blog","Feedback","Webinar",function($location,$document,$controller,$http,$sce,$scope,Angularytics,toaster,Search,Auth,Blog,Feedback,Webinar){$scope.referalb="",$scope.signedIn=Auth.signedIn,$scope.user=Auth.user,$scope.webinar_booking_success=[],$scope.webinarAlreadyBooked=[],$scope.newphoto="",$scope.gender=[{name:"Male"},{name:"Female"}],$scope.custom={video:"iSCIesIM8Ww",player:null,vars:{controls:0,rel:0}},$scope.trackEvent=function(catagory,action,label){Angularytics.trackEvent(catagory,action,label)},$scope.loginError=function(name,affiliation,state,image){$scope.collegeName=name,$scope.collegeAff=affiliation,$scope.collegeState=state,$scope.collegeImage=image,$scope.loginErrorModal=!0,$scope.$applyAsync()},$scope.close=function(){$scope.loginErrorModal=!1,$scope.$applyAsync()},$scope.thisBookedWebinarLive=[],$scope.studentDashboardChangeTab=function(x){$("#index1").removeClass("focus"),$("#index2").removeClass("focus"),$("#index3").removeClass("focus"),$("#index4").removeClass("focus"),$("#index5").removeClass("focus"),x="#"+x,$(x).addClass("focus")},$scope.viewTab="sessions";var tempToggle=!0;$scope.searchToggle=function(){var a=document.getElementById("searchToggleBtn");tempToggle?(tempToggle=!1,$scope.viewTab="webinars",$scope.$evalAsync(),a.style.marginLeft="30px"):tempToggle||(tempToggle=!0,$scope.viewTab="sessions",$scope.$evalAsync(),a.style.marginLeft=null)},$scope.getBookedWebinarsByStudent=function(){if($scope.signedIn()){var currentStudent=Auth.resolveUser().auth.uid;Webinar.getBookedWebinarForStudent(currentStudent,$scope)}else Webinar.getBookedWebinarForStudent(currentStudent,$scope)},$scope.getUpcommingWebinarsForStudent=function(){if($scope.signedIn()){var currentStudent=Auth.resolveUser().auth.uid;Webinar.getUpcommingWebinarsForStudent(currentStudent,$scope)}else Webinar.getUpcommingWebinarsForStudent(currentStudent,$scope)},$scope.loadMoreWebinarsForStudent=function(){if($scope.signedIn()){var currentStudent=Auth.resolveUser().auth.uid;Webinar.loadMoreWebinarsForStudent(currentStudent,$scope)}else Webinar.loadMoreWebinarsForStudent(currentStudent,$scope)},$scope.bookThisWebinar=function(currentWebinar,webinarIndex){var currentStudent=Auth.resolveUser().auth.uid;Webinar.bookWebinar($scope,currentWebinar.liveStreamURL,currentWebinar.mentorName,currentWebinar.mentorEmail,currentWebinar.mentorMobile,currentWebinar.mentorGender,currentWebinar.mentorPhoto,currentWebinar.webinarTopic,currentWebinar.webinarDate,currentWebinar.webinarTime,currentWebinar.webinarDescription,currentWebinar.webinarDuration,currentWebinar.studentsAttending,currentWebinar.collegeId,currentWebinar.webinarId,currentStudent),$(".web"+webinarIndex).hide()},$scope.attendWebinar=function(webinarDetail){$scope.currentlyAttendingWebinar=webinarDetail;var Id=webinarDetail.liveStreamURL.split(".be/"),vedioId=Id[1],videourl="https://www.youtube.com/embed/"+vedioId+"?rel=0&amp;showinfo=0&modestbranding=1&autohide=1";$scope.video={src:videourl,title:"LiveStreamUrl"},Webinar.attendWebinarByStudent(webinarDetail,$scope),$scope.getQNAdetails()},$scope.trustSrc=function(src){return $sce.trustAsResourceUrl(src)},$scope.askQuestion=function(question){$scope.question="",$scope.$evalAsync(),Webinar.studentAskedAQuestion($scope.user.uid,$scope.user.profile.studentname,$scope.currentlyAttendingWebinar,question,$scope)},$scope.getQNAdetails=function(){Webinar.getQNAdetails($scope.currentlyAttendingWebinar,$scope)},$scope.isThisBookedWebinarLive=function(webinarId){$scope.thisBookedWebinarLive[webinarId]="notLiveYet",Webinar.isThisBookedWebinarLive(webinarId,$scope)},$scope.isAnyWebinarLive=function(){$scope.anyLiveWebinars=Webinar.isAnyWebinarLive()},$scope.notifyAdminForStudentIntrestInWebinar=function(webinarInfo){toaster.pop("wait","Email verification","Sending Email",1e4);var dataToPost={stuEmail:$scope.user.profile.email,stuPass:$scope.user.profile.password,stuName:$scope.user.profile.studentname,webTopic:webinarInfo.webinarTopic,webMentor:webinarInfo.mentorName};$http({url:"/notifyAdminForWebinarBookingWhenSeatsAreFull",method:"GET",params:{stuEmail:dataToPost.stuEmail,stuName:dataToPost.stuName,stuPass:dataToPost.stuPass,webTopic:dataToPost.webTopic,webMentor:dataToPost.webMentor}}).success(function(serverResponse){"sent"==serverResponse?(toaster.clear(),toaster.pop("success","Thankyou!","Your request has been registered.")):"error"==serverResponse?(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time.")):(toaster.clear(),toaster.pop("success","Thankyou!","Your request has been registered."))}).error(function(serverResponse){"sent"==serverResponse?(toaster.clear(),toaster.pop("success","Thankyou!","Your request has been registered.")):"error"==serverResponse?(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time.")):(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time."))})},$scope.checkUrlForCollapseAndActiveClass=function(){var temp=$location.path().split("/")[1];if("all-completed-webinars"===temp||"student-webinar-detail"===temp)$scope.checkWebinarCollapse="",$scope.checkHouseCollapse="collapse","student-webinar-detail"===temp?$scope.studentwebinardetail="active":"all-completed-webinars"===temp&&($scope.completedwebinars="active");else if("house"===temp){var houseName=$location.path().split("/")[2];$scope.checkWebinarCollapse="collapse",$scope.checkHouseCollapse="","engineering"===houseName?$scope.engineering="active":"medical"===houseName?$scope.medical="active":"hospitality"===houseName?$scope.hospitality="active":"design & fashion"===houseName?$scope.fashion="active":"finance & commerce"===houseName?$scope.finance="active":"architecture"===houseName?$scope.architecture="active":"AngrEasy"===houseName?$scope.AngrEasy="active":"media-journalism"===houseName?$scope.journalism="active":"others"===houseName?$scope.others="active":"Fine Arts"===houseName&&($scope.fineArts="active")}else if("category"===temp){var houseName=$location.path().split("/")[2];$scope.checkWebinarCollapse="collapse",$scope.checkHouseCollapse="","engineering"===houseName?$scope.engineering="active":"medical"===houseName?$scope.medical="active":"hospitality"===houseName?$scope.hospitality="active":"design & fashion"===houseName?$scope.fashion="active":"finance & commerce"===houseName?$scope.finance="active":"architecture"===houseName?$scope.architecture="active":"AngrEasy"===houseName?$scope.AngrEasy="active":"media-journalism"===houseName?$scope.journalism="active":"others"===houseName?$scope.others="active":"Fine Arts"===houseName&&($scope.fineArts="active")}else $scope.checkWebinarCollapse="collapse",$scope.checkHouseCollapse="collapse","dashboard"===temp?$scope.dashboard="active":"student-college-search"===temp?$scope.studentcollegesearch="active":"student-fund"===temp?$scope.studentfund="active":"student-counselling-center"===temp&&($scope.studentcounselling="active")},$scope.student1IdFlag="",$scope.showNewInvitePop=!1,$scope.show_pop=function(){$scope.showNewInvitePop=!0},$scope.close_all_pop=function(){$scope.showNewInvitePop=!1},$scope.roles=[{id:"0",text:"Engineering"},{id:"1",text:"Computer Applications / IT"},{id:"2",text:"Biotechnology"},{id:"3",text:"Microbiology"},{id:"4",text:"Agriculture"},{id:"5",text:"Food Technology"},{id:"6",text:"Nutrition and Dietetics"},{id:"7",text:"Arts (Humanities)"},{id:"8",text:"Library Science"},{id:"9",text:"Management"},{id:"10",text:"Commerce"},{id:"11",text:"Economics"},{id:"12",text:"Hotel Management/Hospitality and Tourism"},{id:"13",text:"Architecture"},{id:"14",text:"Planning"},{id:"15",text:"Fine Arts"},{id:"16",text:"Performing Arts"},{id:"17",text:"Pharmaceutical Sciences"},{id:"18",text:"Ayurvedic Pharmaceutical Sciences"},{id:"19",text:"Physiotherapy"},{id:"20",text:"Paramedical Sciences"},{id:"21",text:"Education"},{id:"22",text:"Physical Education"},{id:"23",text:"Law"},{id:"24",text:"Design"},{id:"25",text:"Sciences"},{id:"26",text:"Nursing"},{id:"27",text:"Film & Television"},{id:"28",text:"Media & Journalism"}],$scope.uSer={roles:[]},$scope.rolesA=[{idA:"0",textA:"Engineering"},{idA:"1",textA:"Computer Applications / IT"},{idA:"2",textA:"Biotechnology"},{idA:"3",textA:"Microbiology"},{idA:"4",textA:"Biochemistry"},{idA:"5",textA:"Agriculture"},{idA:"6",textA:"Food Technology"},{idA:"7",textA:"Nutrition and Dietetics"},{idA:"8",textA:"English and Foreign Languages"},{idA:"9",textA:"Indian Languages"},{idA:"10",textA:"Library Science"},{idA:"11",textA:"Sociology"},{idA:"12",textA:"Geography"},{idA:"13",textA:"Management"},{idA:"14",textA:"Commerce"},{idA:"15",textA:"Economics"},{idA:"16",textA:"Hotel Management/Hospitality and Tourism"},{idA:"17",textA:"Architecture"},{idA:"18",textA:"Planning"},{idA:"19",textA:"Fine Arts"},{idA:"20",textA:"Performing Arts"},{idA:"21",textA:"Pharmaceutical Sciences"},{idA:"22",textA:"Ayurvedic Pharmaceutical Sciences"},{idA:"23",textA:"Physiotherapy"},{idA:"24",textA:"Paramedical Sciences"},{idA:"25",textA:"History"},{idA:"26",textA:"Political Science"},{idA:"27",textA:"Psychology"},{idA:"28",textA:"Education"},{idA:"29",textA:"Physical Education"},{idA:"30",textA:"Law"},{idA:"31",textA:"Design"},{idA:"32",textA:"Sciences"},{idA:"33",textA:"Nursing"},{idA:"34",textA:"Film & Television"},{idA:"35",textA:"Media & Journalism"}],$scope.uSerA={rolesA:[]},$scope.checkaccept=function(){$scope.hidedetails="undefined"==typeof $scope.user.profile.acceptedInvites?"true":"false"},$scope.refermail=function(){"Done"!==$scope.student1IdFlag?$scope.refer():$scope.refertologin()},$scope.refer=function(){toaster.pop("wait","Sending Invitation","Sending Email",1e4);var dataToPost={to:$scope.user.referemail,from:$scope.user.profile.email,sname:$scope.user.profile.studentname,rname:$scope.user.refername};$http({url:"/sendrefermail",method:"GET",params:{to:dataToPost.to,sname:dataToPost.sname,from:dataToPost.from,rname:dataToPost.rname}}).success(function(serverResponse){"sent"==serverResponse?(toaster.clear(),$scope.user.refername="",$scope.user.referemail="",toaster.pop("success","Thankyou!","Your Invitation Link has been sent.")):"error"==serverResponse?(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time.")):($scope.user.refername="",$scope.user.referemail="",toaster.clear(),toaster.pop("success","Thankyou!","Your Invitation Link has been sent."))}).error(function(serverResponse){"sent"==serverResponse?(toaster.clear(),toaster.pop("success","Thankyou!","Your Invitation Link has been sent.")):"error"==serverResponse?(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time.")):(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time."))})},$scope.refertologin=function(){toaster.pop("wait","Sending Invitation","Sending Email",1e4);var dataToPost={to:$scope.user.referemail,from:$scope.user.profile.email,sname:$scope.user.profile.studentname,rname:$scope.user.refername};$http({url:"/sendreferloginmail",method:"GET",params:{to:dataToPost.to,sname:dataToPost.sname,from:dataToPost.from,rname:dataToPost.rname}}).success(function(serverResponse){"sent"==serverResponse?(toaster.clear(),$scope.user.refername="",$scope.user.referemail="",toaster.pop("success","Thankyou!","Your Invitation Link has been sent.")):"error"==serverResponse?(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time.")):(toaster.clear(),$scope.user.refername="",$scope.user.referemail="",toaster.pop("success","Thankyou!","Your Invitation Link has been sent."))}).error(function(serverResponse){"sent"==serverResponse?(toaster.clear(),toaster.pop("success","Thankyou!","Your Invitation Link has been sent.")):"error"==serverResponse?(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time.")):(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time."))})},$scope.requestInvite=function(){toaster.pop("wait","Requesting Invitation","Sending Email",1e4);var dataToPost={to:$scope.user.referemail,from:$scope.user.profile.email,sname:$scope.user.profile.studentname,rname:$scope.user.refername};$http({url:"/requestInvitation",method:"GET",params:{to:dataToPost.to,sname:dataToPost.sname,from:dataToPost.from,rname:dataToPost.rname}}).success(function(serverResponse){"sent"==serverResponse?(toaster.clear(),toaster.pop("success","Thankyou!","Your request has been sent."),$scope.reqSent=1):"error"==serverResponse?(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try again after some time.")):(toaster.clear(),toaster.pop("success","Thankyou!","Your request has been sent."))}).error(function(serverResponse){"sent"==serverResponse?(toaster.clear(),toaster.pop("success","Thankyou!","Your request has been sent.")):"error"==serverResponse?(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try again after some time.")):(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try again after some time."))})},$scope.resendemail=function(){var str=Auth.resolveUser().uid,data=str.split(":");if(isNaN(data[1]))var urlId=str;else{var urlId=str.split(":");urlId=urlId[1]}toaster.pop("wait","Email verification","Sending Email",1e4);var dataToPost={to:$scope.user.profile.email,pass:$scope.user.profile.password,sname:$scope.user.profile.studentname,hashkey:$scope.user.profile.md5_hash,urlId:urlId};$http({url:"/sendstudentmail",method:"GET",params:{to:dataToPost.to,sname:dataToPost.sname,pass:dataToPost.pass,hashkey:dataToPost.hashkey,urlId:dataToPost.urlId}}).success(function(serverResponse){"sent"==serverResponse?(toaster.clear(),toaster.pop("success","Thankyou!","Please check your email for the verification link.")):"error"==serverResponse?(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time.")):(toaster.clear(),toaster.pop("success","Thankyou!","Please check your email for the verification link."))}).error(function(serverResponse){"sent"==serverResponse?(toaster.clear(),toaster.pop("success","Thankyou!","Please check your email for the verification link.")):"error"==serverResponse?(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time.")):(toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time."))})},$scope.CurrentreferalStatus=function(){var currentuser=Auth.resolveUser().uid;$scope.user.refername="",$scope.user.referemail="",$scope.yourstatus="",$scope.referalstatus="",Auth.viewChanges(currentuser).then(function(result10){if("undefined"==typeof result10.referredBy){$scope.yourstatus="old";var dataToPost={username:$scope.user.profile.studentname,useremail:$scope.user.profile.email};$http({url:"/sendmailforolduser",method:"GET",params:{username:dataToPost.username,useremail:dataToPost.useremail}}).success(function(serverResponse){}).error(function(serverResponse){})}})},$scope.pop=function(){toaster.pop("success","test","i m testing u")},$scope.getStudentincentive=function(sid){return Search.getStudentIncentive(sid)},$scope.getStudentEmail=function(sid){return Search.getStudentEmail(sid)},$scope.getStudentName=function(sid){return Search.getStudentName(sid)},$scope.getStudentPhoto=function(sid){return Search.getStudentPhoto(sid)},$scope.updateProfile=function(){var student=Auth.resolveUser().uid;$scope.submitsuccesstext1=!1,$scope.submitphotosuccesstext=!1,Auth.updateProfile($scope,student)},$scope.updateProfile2=function(){console.log("function called 2");var student=Auth.resolveUser().uid;$scope.submitsuccesstext2=!1,$scope.submitphotosuccesstext=!1,null==$scope.user.profile.academicrecordUGMarks?null==$scope.user.profile.academicrecordPGMarks?($scope.message="",Auth.updateProfile2($scope,student)):$scope.message="Please enter your 12th marks to proceed.":($scope.message="",Auth.updateProfile2($scope,student))},$scope.updateProfile3=function(){var student=Auth.resolveUser().uid;$scope.submitsuccesstext3=!1,$scope.submitphotosuccesstext=!1,Auth.updateProfile3($scope,student)},$scope.prepareUG=function(){$scope.submitphotosuccesstext=!1;var student=Auth.resolveUser().uid;Auth.getUGCourses(student).then(function(result){var test=result;"undefined"==typeof test?($scope.user.profile.coursesUG=[],$scope.uSer.roles=$scope.user.profile.coursesUG):Auth.getUGCourses(student).then(function(result){$scope.user.profile.coursesUG=result},function(error){console.log(error)})},function(error){console.log(error)})},$scope.updateUG=function(){var student=Auth.resolveUser().uid;$scope.submitsuccesstext=!1;var ug=$scope.uSer.roles;Auth.updateUG($scope,student,ug)},$scope.preparePG=function(){$scope.submitphotosuccesstext=!1;var student=Auth.resolveUser().uid;Auth.getPGCourses(student).then(function(result){var testA=result;"undefined"==typeof testA?($scope.user.profile.coursesPG=[],$scope.uSerA.rolesA=$scope.user.profile.coursesPG):Auth.getPGCourses(student).then(function(result){$scope.user.profile.coursesPG=result},function(error){console.log(error)})},function(error){console.log(error)})},$scope.updatePhoto=function(newphoto){var studentId=Auth.resolveUser().uid;$scope.submitphotosuccesstext=!1,Auth.updatePhoto(studentId,newphoto,$scope)},$scope.cancelUploadFile=function(){$scope.user.studentadmissionproof.url="https://www.filepicker.io/api/file/zEAoaiVbRRW0HrtJApxM",$scope.submitdisabled=!0},$scope.redeemShow="",$scope.uploadFalse=function(){$scope.upload=!1},$scope.submitdisabled=!0,$scope.enableSubmitButton=function(){"https://www.filepicker.io/api/file/zEAoaiVbRRW0HrtJApxM"!==$scope.user.studentadmissionproof.url&&($scope.submitdisabled=!1)},$scope.upload="",$scope.uploadAdmissionProof=function(studentAdmissionProof,user){$scope.upload=!1;var studentId=Auth.resolveUser().uid;Auth.uploadAdmissionProof(studentId,studentAdmissionProof.url,$scope);var dataToPost={to:user.profile.email,sname:user.profile.studentname,url:studentAdmissionProof.url};$http({url:"/sendStudentAdmissionProofToSupportTeam",method:"GET",params:{to:dataToPost.to,sname:dataToPost.sname,url:dataToPost.url}}).success(function(){}).error(function(){})};var ext="";$scope.getdocumenttype=function(){var test=$scope.user.profile.studentdocument;$http.get(test+"/metadata").success(function(data){ext=data.filename;var str=ext,n=str.lastIndexOf("."),extension=str.slice(n);$scope.extension=extension})},$scope.updateDocument=function(newdocument){var studentId=Auth.resolveUser().uid;$scope.submitdocumentsuccesstext=!1,Auth.updateDocument(studentId,newdocument,$scope)},$scope.updatePG=function(){var student=Auth.resolveUser().uid;$scope.submitsuccesstext=!1;var pg=$scope.uSerA.rolesA;Auth.updatePG($scope,student,pg)},$scope.cancel=function(){$scope.message="",$scope.submitdocumentsuccesstext=!1,$scope.submitsuccesstext=!1;var student=Auth.resolveUser().uid;Auth.viewChanges(student).then(function(result){var canceling=result;$scope.submitphotosuccesstext=!1,$scope.submitsuccesstext=!1,$scope.submitsuccesstext2=!1,$scope.submitsuccesstext3=!1,$scope.submitsuccesstext1=!1,$scope.user.profile.studentdocument=canceling.studentdocument,$scope.getdocumenttype(),$scope.user.profile.studentname=canceling.studentname,$scope.user.profile.studentmobile=canceling.studentmobile,$scope.user.profile.gender=canceling.gender,$scope.user.profile.fathername=canceling.fathername,$scope.user.profile.occupation=canceling.occupation,$scope.user.profile.fathernumber=canceling.fathernumber,$scope.user.profile.academicrecord12thMarks=canceling.academicrecord12thMarks,$scope.user.profile.academicrecordUGMarks=canceling.academicrecordUGMarks,$scope.user.profile.academicrecordPGMarks=canceling.academicrecordPGMarks,$scope.user.profile.studentabout=canceling.studentabout,$scope.user.profile.coursesUG=canceling.coursesUG,$scope.user.profile.coursesPG=canceling.coursesPG,$scope.user.profile.studentphoto=canceling.studentphoto},function(error){console.log(error)})},$scope.doThisForCounsellor=function(collegeEmail){collegeEmail?Search.getCollegeIdByEmail(collegeEmail).then(function(result){$scope.collegeUid=result,"user doesnot exists"!==$scope.collegeUid?($scope.collegeIdFlag="Done",$scope.collegeName=Search.getCollegeName($scope.collegeUid)):$scope.collegeIdFlag="Not Done"},function(error){$scope.collegeIdFlag="Not Done",console.log(error)}):$scope.collegeIdFlag=""},$scope.doThisForStudent=function(studentEmail1){$scope.error="",$scope.referalstatus="",studentEmail1=angular.lowercase(studentEmail1),studentEmail1?Search.getStudentIdByEmail(studentEmail1).then(function(result){$scope.student1Uid=result,"user doesnot exists"!==$scope.student1Uid?($scope.student1IdFlag="Done",$scope.student1Name=Search.getStudentName($scope.student1Uid),Auth.viewChanges($scope.student1Uid).then(function(result1){if($scope.user.profile.email===studentEmail1)$scope.student1IdFlag="",$scope.referalstatus="same";else if("undefined"==typeof result1.referredBy)$scope.referalstatus="old";else if("nobody"==result1.referredBy)$scope.referalstatus="Not";else if(result1.referredBy)$scope.referalstatus="Done";else{$scope.referalstatus="else";var dataToPost={usercc:studentEmail1};$http({url:"/sendmailforsuspiciousactivity",method:"GET",params:{usercc:dataToPost.usercc}}).success(function(serverResponse){console.log(serverResponse)}).error(function(serverResponse){console.log(serverResponse)})}})):$scope.student1IdFlag="Not Done"},function(error){$scope.student1IdFlag="Not Done",console.log(error)}):($scope.student1IdFlag="",$scope.student1Uid="",$scope.referalstatus="")},$scope.go=function(path){$location.path(path)},$scope.collegephoto=function(collegeId){var collegePhotoObj=Search.getCollegePhoto(collegeId);return collegePhotoObj},$scope.collegename=function(collegeId){var collegeNameObj=Search.getCollegeName(collegeId);return collegeNameObj},$scope.toTheTop=function(){$document.scrollTopAnimated(0,2e3).then(function(){})},$scope.profileIncomplete="Not Done",$scope.incompleteProfileCheck=function(){$scope.profiletab="show",Search.studentDetailForNotification(Auth.resolveUser().auth.uid,$scope)},$scope.checkNewBookSessionForNotification=function(){$scope.bookhistorytab="show",Search.checkNewBookSessionForNotification(Auth.resolveUser().auth.uid,$scope)},$scope.notificationOfIncentiveChange=function(){Search.notificationOfIncentiveChange(Auth.resolveUser().auth.uid,$scope)},$scope.changeStudentPassword=function(){$scope.message="",Auth.changeStudentPassword($scope.user.profile.email,Auth.resolveUser().auth.uid,$scope.user.oldpassword,$scope.user.resetpassword,$scope),$scope.user.oldpassword="",$scope.user.resetpassword="",$scope.user.confirm_password=""},$scope.getstudentWebinarFeedbacks=function(webinarId){$scope.successmessage="",$scope.errormessage="",Webinar.getstudentWebinarFeedbacks(webinarId,$scope)},$scope.SaveWebinarStudentFeedback=function(collegeId,webinarId,webinarSatisfaction,SpeakerInterested,Interested,InterestedArea,QNA,QuestionDetails){$scope.successmessage="",$scope.errormessage="",null===webinarSatisfaction&&($scope.errormessage="Please fill all the fields."),null===SpeakerInterested&&($scope.errormessage="Please fill all the fields."),null===Interested&&($scope.errormessage="Please fill all the fields."),null===QNA&&($scope.errormessage="Please fill all the fields."),"undefined"!=typeof webinarSatisfaction&&"undefined"!=typeof SpeakerInterested&&"undefined"!=typeof Interested&&"undefined"!=typeof QNA?"Yes"===Interested&&"Yes"===QNA?"undefined"!=typeof InterestedArea?Webinar.SaveWebinarStudentFeedback(collegeId,webinarId,webinarSatisfaction,SpeakerInterested,Interested,InterestedArea,QNA,QuestionDetails,$scope):$scope.errormessage="Please fill your Interested area.":"No"===Interested&&"Yes"===QNA?Webinar.SaveWebinarStudentFeedback(collegeId,webinarId,webinarSatisfaction,SpeakerInterested,Interested,InterestedArea,QNA,QuestionDetails,$scope):"No"===Interested&&"No"===QNA?"undefined"!=typeof QuestionDetails?Webinar.SaveWebinarStudentFeedback(collegeId,webinarId,webinarSatisfaction,SpeakerInterested,Interested,InterestedArea,QNA,QuestionDetails,$scope):$scope.errormessage="Please submit your questions":"Yes"===Interested&&"No"===QNA&&("undefined"!=typeof InterestedArea&&"undefined"!=typeof QuestionDetails?Webinar.SaveWebinarStudentFeedback(collegeId,webinarId,webinarSatisfaction,SpeakerInterested,Interested,InterestedArea,QNA,QuestionDetails,$scope):"undefined"==typeof InterestedArea?$scope.errormessage="Please fill your Interested area.":"undefined"==typeof QuestionDetails&&($scope.errormessage="Please submit your questions.")):$scope.errormessage="Please fill all the fields"
},$scope.getStudentDashBoardPosts=function(){Blog.getStudentDashBoardPosts($scope)},$scope.LoadMoreStudentDashBoardPosts=function(){Blog.LoadMoreStudentDashBoardPosts($scope)},$scope.getNumberOfClick=function(){$scope.numberOfClick=Search.getNumberOfClick()},$scope.seeCollegeFeed=function(){Blog.seeCollegeFeed($scope)},$scope.loadMoreAllCollegeFeeds=function(){Blog.loadMoreAllCollegeFeeds($scope)},$scope.submitQueryForm=function(dream_college,course_intrested,stu_queries){var currentUser=Auth.resolveUser().uid;Auth.submitQueryForm(dream_college,course_intrested,stu_queries,currentUser,$scope)},$scope.getQueryNotification=function(college,course,query){$scope.empty="",toaster.pop("wait","Query","Sending Request",1e4);var dataToPost={collegeInterested:college,courseInterested:course,studentQuery:query,sname:$scope.user.profile.studentname,email:$scope.user.profile.email,phone:$scope.user.profile.studentmobile};$http({url:"/sendmailtoadminFordashboardQuery",method:"GET",params:{collegeInterested:dataToPost.collegeInterested,courseInterested:dataToPost.courseInterested,studentQuery:dataToPost.studentQuery,studentName:dataToPost.sname,studentEmail:dataToPost.email,studentNumber:dataToPost.phone}}).success(function(serverResponse){toaster.clear(),toaster.pop("success","Thankyou!","We have received your query."),console.log(serverResponse),$scope.dream_college="",$scope.course_intrested="",$scope.stu_queries="",$scope.$evalAsync()}).error(function(serverResponse){toaster.clear(),toaster.pop("error","Oops!","Something went wrong please try after some time."),console.log(serverResponse),$scope.dream_college="",$scope.course_intrested="",$scope.stu_queries="",$scope.$evalAsync()})}}]).value("duScrollOffset",30),app.controller("studentDashBookedHistoryCtrl",["$scope","$location","$sce","$filter","$document","Angularytics","Auth","AuthCollege","Feedback","studentDashBookedHistory","Webinar",function($scope,$location,$sce,$filter,$document,Angularytics,Auth,AuthCollege,Feedback,studentDashBookedHistory,Webinar){$scope.user=Auth.user.profile,$scope.userc=AuthCollege.userc,$scope.studentDetail=[],$scope.toTheTop=function(){$document.scrollTopAnimated(0,2e3).then(function(){})},$scope.trackEvent=function(catagory,action,label){Angularytics.trackEvent(catagory,action,label)},$scope.getLimitedColleges=function(){var studentId=AuthCollege.resolveUser().uid;$scope.studentid=studentId,$scope.session=[],studentDashBookedHistory.getLimitedColleges($scope,$scope.studentid)},$scope.go=function(path){console.log(path),$location.path(path)},$scope.getCollegeDetail=function(collegeId,collegeuid){$scope.collegeDetail=[],studentDashBookedHistory.getCollegeDetail(collegeId,collegeuid,$scope)},$scope.getstudentsessionFeedbacks=function(studentid,collegeid){Feedback.getPreviousFeedbackOfStudents(studentid,collegeid,$scope)},$scope.createFeedbackForStudent=function(first,second,third,studentQuery,studenturlId,sessionDate,collegeURL,studentURL){if(null!=first)var firstAnswer=first;else var firstAnswer="No Rating Given";if(null!=second)var secondAnswer=second;else var secondAnswer="No Rating Given";if(null!=third)var thirdAnswer=third;else var thirdAnswer="Not responded";Feedback.writeFeedbackForStudent(studentQuery,firstAnswer,secondAnswer,thirdAnswer,sessionDate,collegeURL,studentURL)},$scope.showCompletedVideo=[],$scope.videoURL=[],$scope.watchVedio=function(webinarId,liveStreamURL){var videoId=liveStreamURL.split(".be/")[1],vedioSrc="https://www.youtube.com/embed/"+videoId+"?controls=1";$scope.videoURL[webinarId]={src:vedioSrc,title:"Live Video URL"},$scope.showCompletedVideo[webinarId]="yes"},$scope.stopVedio=function(webinarId){$scope.showCompletedVideo[webinarId]="no"},$scope.trustSrc=function(src){return $sce.trustAsResourceUrl(src)},$scope.getStudentsWebinarHistory=function(){var studentId=AuthCollege.resolveUser().uid;Webinar.getStudentsWebinarHistory(studentId,$scope)},$scope.getAllCompletedWebinar=function(){Webinar.getAllCompletedWebinar($scope)},$scope.loadMoreCompletedWebinars=function(){Webinar.loadMoreCompletedWebinars($scope.webinarNumber,$scope)},$scope.getCurrentWebinarDetails=function(webinar){$scope.currentWebinar=webinar,$scope.$evalAsync()}}]),app.controller("VerifyCtrl",["$scope","$controller","$http","$location","$document","Verify","Auth","Search",function($scope,$controller,$http,$location,$document,Verify,Auth,Search){$scope.signedIn=Auth.signedIn,$scope.go=function(){var str=$location.path(),data=str.split("/verify/:");if(data[1]){var str2=data[1],data=str2.split("SimLog");if(data[1]){if(isNaN(data[0]))var UserId=data[0];else var UserId="simplelogin:"+data[0];$scope.studentdetail=Search.getStudentDetail(UserId),$scope.studentdetail.$loaded().then(function(){if("true"==$scope.studentdetail.emailverificationstatus)$scope.verStatus="already verified";else{var str3=data[1],data1=str3.split("mail=");data1[1]?($scope.MD5=Verify.getMD5(UserId),$scope.MD5.$loaded().then(function(){data1[0]==$scope.MD5.$value?($scope.email=Search.getStudentEmail(UserId),$scope.email.$loaded().then(function(){data1[1]==$scope.email.$value?(Verify.getEmailVerified(UserId),$scope.verStatus="verified"):$scope.verStatus="not verified"})):$scope.verStatus="not verified"})):$scope.verStatus="not verified"}})}else $scope.verStatus="not verified"}else $scope.verStatus="not verified"},$scope.toTheTop=function(){$document.scrollTopAnimated(0,2e3).then(function(){})}}]).value("duScrollOffset",30),app.controller("VerifyReferNodalCtrl",["$scope","$controller","$http","$location","VerifyReferNodal","NodalTask","Auth","Search",function($scope,$controller,$http,$location,VerifyReferNodal,NodalTask,Auth,Search){$scope.signedIn=Auth.signedIn,$scope.go=function(){{var str=$location.path(),data=str.split("/ReferNodalVerify/:");str.split("/ReferNodalVerify/:")}if(data[1]){var str2=data[1],data=str2.split("SimLog");if(data[1]){if(isNaN(data[0]))var UserId=data[0];else var UserId="simplelogin:"+data[0];var str4=data[1],data2=str4.split("NSL="),refferid=data2[1];if(isNaN(data2[1]))var nodalid=data2[1];else var nodalid="simplelogin:"+data2[1];Search.getNodalAdminDetail(nodalid).then(function(nodal){$scope.nodaldetail=nodal}),Search.getNodalIdById(nodalid).then(function(result){$scope.nodal1Uid=result,$scope.student1IdFlag="user doesnot exists"!==$scope.nodal1Uid?"Done":"Not Done"},function(){$scope.student1IdFlag="Not Done"}),$scope.studentdetail=Search.getStudentDetail(UserId),$scope.studentdetail.$loaded().then(function(){var ApprovedSessionCount=0,counter=0,totalReferredStudents=0;NodalTask.getTotalStudentReferralLength(UserId).then(function(result){totalReferredStudents=result.length,NodalTask.getStudentSessionDetail(UserId).then(function(value){var sessions=value,sessionArrayLength=sessions.length;if(0==sessionArrayLength)if(ApprovedSessionCount=0,"true"==$scope.studentdetail.emailverificationstatus&&"Done"==$scope.student1IdFlag&&"undefined"==typeof $scope.studentdetail.referredByNodalAdmin)$scope.verStatus="verified",VerifyReferNodal.getEmailVerified(UserId,refferid,nodalid,ApprovedSessionCount,totalReferredStudents);else{var str3=data[1],data1=str3.split("mail="),str5=data1[1],data5=str5.split("NSL=");data1[1]?($scope.MD5=VerifyReferNodal.getMD5(UserId),$scope.MD5.$loaded().then(function(){data1[0]===$scope.MD5.$value?($scope.email=Search.getStudentEmail(UserId),$scope.email.$loaded().then(function(){data5[0]==$scope.email.$value&&"Done"==$scope.student1IdFlag&&"undefined"==typeof $scope.studentdetail.referredByNodalAdmin?(VerifyReferNodal.getEmailVerified(UserId,refferid,nodalid,ApprovedSessionCount,totalReferredStudents),$scope.verStatus="verified"):$scope.verStatus="not verified"})):$scope.verStatus="not verified"})):$scope.verStatus="not verified"}else 0!==sessionArrayLength&&angular.forEach(sessions,function(value){if(counter+=1,"undefined"!=typeof value.incentiveAmountPerSession&&(ApprovedSessionCount+=1),counter===sessionArrayLength)if("true"==$scope.studentdetail.emailverificationstatus&&"Done"==$scope.student1IdFlag&&"undefined"==typeof $scope.studentdetail.referredByNodalAdmin)$scope.verStatus="verified",VerifyReferNodal.getEmailVerified(UserId,refferid,nodalid,ApprovedSessionCount,totalReferredStudents);else{var str3=data[1],data1=str3.split("mail="),str5=data1[1],data5=str5.split("NSL=");data1[1]?($scope.MD5=VerifyReferNodal.getMD5(UserId),$scope.MD5.$loaded().then(function(){data1[0]===$scope.MD5.$value?($scope.email=Search.getStudentEmail(UserId),$scope.email.$loaded().then(function(){data5[0]==$scope.email.$value&&"Done"==$scope.student1IdFlag&&"undefined"==typeof $scope.studentdetail.referredByNodalAdmin?(VerifyReferNodal.getEmailVerified(UserId,refferid,nodalid,ApprovedSessionCount,totalReferredStudents),$scope.verStatus="verified"):$scope.verStatus="not verified"})):$scope.verStatus="not verified"})):$scope.verStatus="not verified"}})})})})}else $scope.verStatus="not verified"}else $scope.verStatus="not verified"}}]),app.controller("WebinarCtrl",["$scope","$log","$document","$filter","$http","$location","$modal","$sce","$interval","$window","toaster","AuthMentor","AuthSchool","Webinar","Auth","AuthCollege",function($scope,$log,$document,$filter,$http,$location,$modal,$sce,$interval,$window,toaster,AuthMentor,AuthSchool,Webinar,Auth,AuthCollege){$scope.webinar=[],$scope.user=Auth.user,$scope.signedIn=Auth.signedIn,$scope.users=AuthSchool.users,$scope.userc=AuthCollege.userc,$scope.userd=AuthMentor.userd,$scope.gender=[{name:"Male"},{name:"Female"}],$scope.expandSlip=!1,$scope.webinar_booking_success=[],$scope.webinarAlreadyBooked=[],$scope.today=function(){$scope.dt=new Date},$scope.today(),$scope.clear=function(){$scope.dt=null},$scope.attendees=[],$scope.disabled=function(date,mode){return"day"===mode&&(0===date.getDay()||6===date.getDay())},$scope.toggleMin=function(){var currentDate=new Date;$scope.minDate=new Date(currentDate.getTime()+1296e6)},$scope.toggleMin(),$scope.toTheTop=function(){$document.scrollTopAnimated(0,2e3).then(function(){})},$scope.open=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.opened=!0},$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],$scope.format=$scope.formats[0],$scope.mytime=new Date,$scope.hstep=1,$scope.mstep=15,$scope.options={hstep:[1,2,3],mstep:[1,5,10,15,25,30]},$scope.ismeridian=!0,$scope.toggleMode=function(){$scope.ismeridian=!$scope.ismeridian},$scope.update=function(){var d=new Date;d.setHours(14),d.setMinutes(0),$scope.mytime=d},$scope.changed=function(){$log.log("Time changed to: "+$scope.mytime)},$scope.clear=function(){$scope.mytime=null},$scope.toggleScheduleWebinarSuccessMsg=function(){$scope.schedule_webinar_success=""},$scope.loadAllWebinars=function(){Webinar.getAllUpcomingWebinar($scope)},$scope.hideWebinar=[],$scope.getBookedWebinarForStudent=function(){$scope.studentBookedWebinar=[],$scope.studentWebinar=[];var studentId=Auth.resolveUser().uid;Webinar.getBookedWebinarForStudent(studentId,$scope)},$scope.getUpcomingWebinar=function(){var currentCollege=AuthCollege.resolveUser();Webinar.getUpcomingWebinar(currentCollege.uid,$scope)},$scope.studentsAttending=function(webinatId,$scope){Webinar.studentsAttending(webinarId,$scope)},$scope.getAllUpcomingWebinar=function(){Webinar.getAllUpcomingWebinar($scope)},$scope.startChat=function(){$window.open("https://www.youtube.com/my_live_events")},$scope.WebinarChat=function(){var path=$location.path(),str=path.split(":");Webinar.getWebinarChat(str[1],$scope)},$scope.showTextBox=function(id){$("#adminreply"+id).fadeIn(),$("#replybtn"+id).fadeOut(),$("#submitbtn"+id).fadeIn(),$("#cancelbtn"+id).fadeIn()},$scope.cancelReply=function(id){$("#adminreply"+id).fadeOut(),$("#replybtn"+id).fadeIn(),$("#submitbtn"+id).fadeOut(),$("#cancelbtn"+id).fadeOut()},$scope.getWebinarDetail=function(){var path=$location.path(),str=path.split(":");Webinar.getWebinarDetailByWebinarId(str[1],$scope)},$scope.getWebinarDetailForView=function(){var path=$location.path(),webinarId=path.split(":")[1];Webinar.getWebinarDetail(webinarId).then(function(webinarDetail){$scope.webinarDetail=webinarDetail})},$scope.trustSrc=function(src){return $sce.trustAsResourceUrl(src)},$scope.getCompletedWebinarsHistory=function(){var currentCollege=AuthCollege.resolveUser().uid;Webinar.getCompletedWebinarsHistory(currentCollege,$scope)},$scope.getWebinarFeedbacks=function(webinarId){$scope.successmessage="",$scope.errormessage="";var currentCollege=AuthCollege.resolveUser().uid;Webinar.getWebinarFeedbacks(currentCollege,$scope,webinarId)},$scope.SaveWebinarFeedback=function(webinarId,webinarexperience,satisfaction,quality,problems,QNA,technicalProblem,recommendation){$scope.successmessage="";var currentCollege=AuthCollege.resolveUser().uid;$scope.errormessage="",null===webinarexperience&&($scope.errormessage="Please fill all the fields."),null===satisfaction&&($scope.errormessage="Please fill all the fields."),null===quality&&($scope.errormessage="Please fill all the fields."),null===problems&&($scope.errormessage="Please fill all the fields."),null===QNA&&($scope.errormessage="Please fill all the fields."),"undefined"!=typeof webinarexperience&&"undefined"!=typeof satisfaction&&"undefined"!=typeof quality&&"undefined"!=typeof problems&&"undefined"!=typeof QNA?"Yes"===problems&&"No"===QNA?"undefined"!=typeof technicalProblem?Webinar.SaveWebinarFeedback(webinarId,currentCollege,$scope,webinarexperience,satisfaction,quality,problems,QNA,technicalProblem,recommendation):$scope.errormessage="Please write the problems you faced":"No"===problems&&"Yes"===QNA?"undefined"!=typeof recommendation?Webinar.SaveWebinarFeedback(webinarId,currentCollege,$scope,webinarexperience,satisfaction,quality,problems,QNA,technicalProblem,recommendation):$scope.errormessage="Please write the recommendation.":"Yes"===problems&&"Yes"===QNA?"undefined"!=typeof technicalProblem&&"undefined"!=typeof recommendation?Webinar.SaveWebinarFeedback(webinarId,currentCollege,$scope,webinarexperience,satisfaction,quality,problems,QNA,technicalProblem,recommendation):"undefined"==typeof technicalProblem?$scope.errormessage="Please write the problems you faced":"undefined"==typeof recommendation&&($scope.errormessage="Please write the recommendation."):"No"===problems&&"No"===QNA&&Webinar.SaveWebinarFeedback(webinarId,currentCollege,$scope,webinarexperience,satisfaction,quality,problems,QNA,technicalProblem,recommendation):$scope.errormessage="Please fill all the fields"},$scope.bookThisWebinar=function(currentWebinar){if(Auth.signedIn()){var currentStudent=Auth.resolveUser().auth.uid;Webinar.bookWebinar($scope,currentWebinar.liveStreamURL,currentWebinar.mentorName,currentWebinar.mentorEmail,currentWebinar.mentorMobile,currentWebinar.mentorGender,currentWebinar.mentorPhoto,currentWebinar.webinarTopic,currentWebinar.webinarDate,currentWebinar.webinarTime,currentWebinar.webinarDescription,currentWebinar.webinarDuration,currentWebinar.studentsAttending,currentWebinar.collegeId,currentWebinar.webinarId,currentStudent),Auth.followCollege($scope.webinarDetail.collegeId,currentStudent,$scope)}else $location.path("/login")},$scope.getQNAdetails=function(){Webinar.getQNAdetails($scope.currentlyAttendingWebinar,$scope)},$scope.thisBookedWebinarLive=[],$scope.isThisBookedWebinarLive=function(webinarId){$scope.thisBookedWebinarLive[webinarId]="notLiveYet",Webinar.isThisBookedWebinarLive(webinarId,$scope)},$scope.sendWebinarInvitation=function(studentName,webinar,friendemail){$scope.invitationMsg=null,$scope.invitationSuccessMsg=null,$scope.invitationErrorMsg=null;var webinarUrl=$location.path();if("undefined"==typeof friendemail||""===friendemail)return void($scope.invitationMsg="Enter valid friend's email.");var dataToPost={to:friendemail,studentName:studentName,mentorName:webinar.mentorName,webinarTopic:webinar.webinarTopic,webinarDate:webinar.webinarDate,webinarTime:webinar.webinarTime,webinarUrl:webinarUrl};$http({url:"/sendwebinarinvitationmailtofriend",method:"GET",params:{to:dataToPost.to,studentName:dataToPost.studentName,mentorName:dataToPost.mentorName,webinarTopic:dataToPost.webinarTopic,webinarDate:dataToPost.webinarDate,webinarTime:dataToPost.webinarTime,webinarUrl:webinarUrl}}).success(function(serverResponse){console.log(serverResponse),$scope.invitationSuccessMsg="Invitation is successfully sent."}).error(function(serverResponse){$scope.invitationErrorMsg="something went wrong. Please try after sometime.",console.log(serverResponse)})},$scope.shareHangoutError="",$scope.shareHangout=function(webinar,password){$scope.hangoutShared="",$scope.shareHangoutError="","undefined"==typeof password?$scope.shareHangoutError="Please Enter Password":Webinar.saveSpecialEvent(webinar,password,$scope)},$scope.getAllSpecialEvents=function(){$scope.specialEvents=Webinar.getAllSpecialEvents()},$scope.eventError="",$scope.authorizeSpecialEvent=function(eventId,event_password){"undefined"==typeof event_password?($scope.eventError="Password Empty",$scope.$evalAsync()):Webinar.authorizeSpecialEvent(eventId,event_password,$scope)}}]).value("duScrollOffset",30),app.factory("AdminAuth",["$firebaseAuth","FIREBASE_URL","$rootScope","$firebaseObject","$firebaseArray","$q",function($firebaseAuth,FIREBASE_URL){var ref=new Firebase(FIREBASE_URL),adminauth=$firebaseAuth(ref),AdminAuth={logout:function(){AdminAuth.usera&&AdminAuth.usera.profile&&AdminAuth.usera.profile.$destroy(),angular.copy({},AdminAuth.usera),adminauth.$unauth()},resolveUser:function(){var getAuth=adminauth.$getAuth();return getAuth},signedIn:function(){return!!AdminAuth.usera.provider},usera:{}};return AdminAuth}]),app.factory("Auth",["$firebaseAuth","$location","$filter","FIREBASE_URL","$rootScope","$http","$firebaseObject","$firebaseArray","$q","md5",function($firebaseAuth,$location,$filter,FIREBASE_URL,$rootScope,$http,$firebaseObject,$firebaseArray,$q,md5){var ref=new Firebase(FIREBASE_URL),auth=$firebaseAuth(ref),Auth={createProfile:function(user){var profile={studentname:user.studentname,studentmobile:user.studentmobile,email:user.email,gender:user.gender,password:user.password,profiletype:user.profiletype,studentAvailability:user.studentAvailability,md5_hash:user.md5_hash,studentstatus:user.studentstatus,studentphoto:user.studentphoto,emailverificationstatus:user.emailverificationstatus,referredBy:user.referredBy},profileRef=ref.child("profileForStudents/"+user.uid);return profileRef.set(profile,function(){var useridref=new Firebase(FIREBASE_URL+"/currentUID");useridref.once("value",function(snapshot){var currentCount=snapshot.val()+1,newref=new Firebase(FIREBASE_URL+"profileForStudents/"+user.uid),newprofileObj=$firebaseObject(newref);newprofileObj.studentname=user.studentname,newprofileObj.studentmobile=user.studentmobile,newprofileObj.email=user.email,newprofileObj.gender=user.gender,newprofileObj.referredBy=user.referredBy,newprofileObj.dateOfRegistration=$filter("date")(new Date,"d MMMM yyyy"),newprofileObj.password=user.password,newprofileObj.profiletype=user.profiletype,newprofileObj.studentAvailability=user.studentAvailability,newprofileObj.md5_hash=user.md5_hash,newprofileObj.studentstatus=user.studentstatus,newprofileObj.emailverificationstatus=user.emailverificationstatus,newprofileObj.studentphoto=user.studentphoto,newprofileObj.studenturlid=currentCount,useridref.set(currentCount);var idTableRef=new Firebase(FIREBASE_URL+"customUserIdTable/studentCustomId/"+currentCount);idTableRef.set(user.uid),newprofileObj.$save().then(function(){var stuRef=new Firebase(FIREBASE_URL+"/DateWiseStuRegInfo");stuRef.once("value",function(students){var index=students.numChildren()+1;stuRef.push({studentId:user.uid,studentNumber:index})})},function(error){console.log("Error:",error)})})}),function(error){console.log("Error:",error)}},updatereferBy:function(student,refer){var ref11=new Firebase(FIREBASE_URL+"profileForStudents/"+student+"/referredBy"),sync11=$firebaseObject(ref11),ref=new Firebase(FIREBASE_URL+"profileForStudents/"+student+"/");sync11.$loaded(function(sync11){"nobody"===sync11.$value&&ref.update({referredBy:refer},function(){Auth.updateReferralIncentive(student,refer)})})},updateReferralIncentive:function(referringTo,referredById){var referralCouponAmount=100,approvedSessionsCount=0,loopCounter=0,str=referringTo,referringToId=str.split(":"),couponCode=referredById+"RID"+referringToId[1],referredBy="simplelogin:"+referredById,studentSessionRef=new Firebase(FIREBASE_URL+"profileForStudents/"+referringTo+"/sessions"),studentSessionArr=$firebaseArray(studentSessionRef);studentSessionArr.$loaded(function(){var arrayLength=studentSessionArr.length;angular.forEach(studentSessionArr,function(value){var collegeId=value.$id;if("totalIncentiveForSessions"!==value.$id){var collegeSessionRef=new Firebase(FIREBASE_URL+"profileForCollege/"+collegeId+"/sessions/"+referringTo),collegeSessionObj=$firebaseObject(collegeSessionRef);collegeSessionObj.$loaded(function(){loopCounter+=1,"approved"===collegeSessionObj.sessionVerificationStatus&&(approvedSessionsCount+=1),loopCounter===arrayLength&&(approvedSessionsCount>3||3==approvedSessionsCount)&&0!==approvedSessionsCount&&Auth.incentifyForReferral(referringTo,referredBy,couponCode,referralCouponAmount)})}})})},incentifyForReferral:function(referringTo,referredBy,couponCode,referralCouponAmount){var referredByIdRef=new Firebase(FIREBASE_URL+"profileForStudents/"+referringTo+"/referredBy"),referredByIdObj=$firebaseObject(referredByIdRef);referredByIdObj.$loaded(function(){null!==referredByIdObj.$value&&Auth.generateCouponForReferral(referringTo,referredBy,couponCode,referralCouponAmount)})},updateDocument:function(studentId,newdocument,$scope){$scope.submitphotosuccesstext=!1;var ref=new Firebase(FIREBASE_URL+"profileForStudents/"+studentId+"/");ref.update({studentdocument:newdocument}),ref.update({studentstatus:"notverified"}),$scope.submitdocumentsuccesstext=!0},generateCouponForReferral:function(referringTo,referredBy,couponCode,referralCouponAmount){var incentiveSchemeRef=new Firebase(FIREBASE_URL+"incentiveScheme/incentivePlan/couponTable/"+couponCode);incentiveSchemeRef.update({referralIncentive:referralCouponAmount,studenturl:referringTo,validity:"not used",incentiveType:"referral",referredBy:referredBy}).then(function(){Auth.awardCoupon(referringTo,referredBy,couponCode,referralCouponAmount)})},awardCoupon:function(referringTo,referredBy,couponCode,referralCouponAmount){var couponTableRef=new Firebase(FIREBASE_URL+"incentiveScheme/incentivePlan/couponTable/"+couponCode),couponTableObj=$firebaseObject(couponTableRef);couponTableObj.$loaded(function(){null!==couponTableObj.$value&&"referral"==couponTableObj.incentiveType&&Auth.awardCouponBasedOnReferral(referringTo,referredBy,couponCode,referralCouponAmount,couponTableObj.referralIncentive,couponTableObj.validity)})},awardCouponBasedOnReferral:function(referringTo,referredBy,couponCode,referralCouponAmount,referralIncentive,couponValidity){if(referralIncentive==referralCouponAmount&&"not used"==couponValidity){var stuIncentiveDetailBasedOnReferralRef=new Firebase(FIREBASE_URL+"incentiveScheme/studentIncentiveDetail/basedOnReferral/"+referredBy+"/"+referringTo);stuIncentiveDetailBasedOnReferralRef.update({couponCode:couponCode,addingAmount:referralCouponAmount}).then(function(){var stuBalanceRef=new Firebase(FIREBASE_URL+"incentiveScheme/studentIncentiveDetail/basedOnReferral/"+referredBy+"/totalIncentiveForReferral"),stuBalanceObj=$firebaseObject(stuBalanceRef),newBalanceRef=new Firebase(FIREBASE_URL+"incentiveScheme/studentIncentiveDetail/basedOnReferral/"+referredBy);stuBalanceObj.$loaded(function(){if(null==stuBalanceObj.$value)newBalanceRef.update({totalIncentiveForReferral:referralCouponAmount}).then(function(){Auth.updateReferralAwardInStudentForge(referringTo,referredBy,couponCode,referralCouponAmount)});else{var newBalance=stuBalanceObj.$value+referralCouponAmount;newBalanceRef.update({totalIncentiveForReferral:newBalance}).then(function(){Auth.updateReferralAwardInStudentForge(referringTo,referredBy,couponCode,referralCouponAmount)})}})})}},updateReferralAwardInStudentForge:function(referringTo,referredBy,couponCode,referralCouponAmount){var referralIncentiveRef=new Firebase(FIREBASE_URL+"profileForStudents/"+referredBy+"/referralIncentive/referredStudentsDetail/"+referringTo);referralIncentiveRef.update({addingAmount:referralCouponAmount});var totalIncentiveForReferralRef=new Firebase(FIREBASE_URL+"profileForStudents/"+referredBy+"/referralIncentive/totalIncentiveForReferral"),totalIncentiveForReferralObj=$firebaseObject(totalIncentiveForReferralRef),referralRef=new Firebase(FIREBASE_URL+"profileForStudents/"+referredBy+"/referralIncentive");totalIncentiveForReferralObj.$loaded(function(){if(null==totalIncentiveForReferralObj.$value)referralRef.update({totalIncentiveForReferral:referralCouponAmount}).then(function(){Auth.updateThreeApprovedSessionsStatus(referringTo,referredBy),Auth.updateCouponValidity(referringTo,referredBy,couponCode,referralCouponAmount)});else{var newAmount=totalIncentiveForReferralObj.$value+referralCouponAmount;referralRef.update({totalIncentiveForReferral:newAmount}).then(function(){Auth.updateThreeApprovedSessionsStatus(referringTo,referredBy),Auth.updateCouponValidity(referringTo,referredBy,couponCode,referralCouponAmount)})}})},updateCouponValidity:function(referringTo,referredBy,couponCode){var couponCodeRef=new Firebase(FIREBASE_URL+"incentiveScheme/incentivePlan/couponTable/"+couponCode),couponCodeObj=$firebase(couponCodeRef).$asObject();couponCodeObj.$loaded(function(){"not used"==couponCodeObj.validity?couponCodeRef.update({validity:"used"}):"used"==couponCodeObj.validity&&couponCodeRef.update({validity:"blacklist"})})},updateThreeApprovedSessionsStatus:function(referringTo,referredBy){var referredByRef=new Firebase(FIREBASE_URL+"profileForStudents/"+referredBy+"/acceptedInvites/"),statusRef=new Firebase(FIREBASE_URL+"profileForStudents/"+referredBy+"/acceptedInvites/"+referringTo),statusObj=$firebaseObject(statusRef);statusObj.$loaded(function(){"Not Done"===statusObj.$value&&referredByRef.set("done")})},saveEntry:function(student,newid){var referstudent=ref.child("profileForStudents/"+student+"/acceptedInvites/"+newid);referstudent.set("Not Done")},updateProfile:function($scope,student){$scope.submitsuccesstext=!1;var ref=new Firebase(FIREBASE_URL+"profileForStudents/"+student+"/");ref.update({studentname:$scope.user.profile.studentname}),ref.update({gender:$scope.user.profile.gender}),ref.update({studentmobile:$scope.user.profile.studentmobile}),ref.update({fathername:$scope.user.profile.fathername}),ref.update({occupation:$scope.user.profile.occupation}),ref.update({fathernumber:$scope.user.profile.fathernumber}),$scope.submitsuccesstext2=!1,$scope.submitsuccesstext3=!1,$scope.submitsuccesstext1=!0},updateProfile2:function($scope,student){$scope.submitsuccesstext=!1;var ref=new Firebase(FIREBASE_URL+"profileForStudents/"+student+"/");ref.update({studentstatus:"notverified"}),$scope.submitsuccesstext2=!0,$scope.submitsuccesstext3=!1,$scope.submitsuccesstext1=!1,"undefined"!=typeof $scope.user.profile.academicrecord12thMarks&&(ref.update({academicrecord12thMarks:$scope.user.profile.academicrecord12thMarks}),"undefined"!=typeof $scope.user.profile.academicrecordUGMarks&&(ref.update({academicrecordUGMarks:$scope.user.profile.academicrecordUGMarks}),"undefined"!=typeof $scope.user.profile.academicrecordPGMarks&&ref.update({academicrecordPGMarks:$scope.user.profile.academicrecordPGMarks}))),"undefined"!=typeof $scope.user.profile.studentstream&&ref.update({studentstream:$scope.user.profile.studentstream})},updateProfile3:function($scope,student){$scope.submitsuccesstext=!1;var ref=new Firebase(FIREBASE_URL+"profileForStudents/"+student+"/");ref.update({studentabout:$scope.user.profile.studentabout}),$scope.submitsuccesstext2=!1,$scope.submitsuccesstext1=!1,$scope.submitsuccesstext3=!0},updateUG:function($scope,student,ug){$scope.submitsuccesstext=!1;var ref=new Firebase(FIREBASE_URL+"profileForStudents/"+student+"/");ref.update({coursesUG:ug}),$scope.submitsuccesstext=!0},updatePG:function($scope,student,pg){$scope.submitsuccesstext=!1;var ref=new Firebase(FIREBASE_URL+"profileForStudents/"+student+"/");ref.update({coursesPG:pg}),$scope.submitsuccesstext=!0},updatePhoto:function(studentId,newphoto,$scope){$scope.submitphotosuccesstext=!1;var ref=new Firebase(FIREBASE_URL+"profileForStudents/"+studentId+"/");ref.update({studentphoto:newphoto}),ref.update({studentstatus:"notverified"}),$scope.submitphotosuccesstext=!0},uploadAdmissionProof:function(studentId,studentAdmissionProof,$scope){var ref=new Firebase(FIREBASE_URL+"profileForStudents/"+studentId+"/");ref.update({studentAdmissionProof:studentAdmissionProof},function(){$scope.upload=!0})},viewChanges:function(student){var deferred=$q.defer(),ref=new Firebase(FIREBASE_URL+"profileForStudents/"+student+"/"),view=$firebaseObject(ref);return view.$loaded(function(view){deferred.resolve(view)}),deferred.promise},getUGCourses:function(student){var deferred=$q.defer(),ref=new Firebase(FIREBASE_URL+"profileForStudents/"+student+"/"),data=$firebaseObject(ref);return data.$loaded(function(data){deferred.resolve(data.coursesUG)}),deferred.promise},getPGCourses:function(student){var deferred=$q.defer(),ref=new Firebase(FIREBASE_URL+"profileForStudents/"+student+"/"),data=$firebaseObject(ref);return data.$loaded(function(data){deferred.resolve(data.coursesPG)}),deferred.promise},changeStudentPassword:function(email,studentId,oldpassword,newpassword,$scope){var ref=new Firebase(FIREBASE_URL);ref.changePassword({email:email,oldPassword:oldpassword,newPassword:newpassword},function(error){if(!error)return $scope.message="User password changed successfully!",$scope.$evalAsync(),void new Firebase(FIREBASE_URL+"profileForStudents/"+studentId+"/password").set(newpassword);switch(error.code){case"INVALID_PASSWORD":$scope.message="The specified user account password is incorrect.",$scope.$evalAsync();break;case"INVALID_USER":$scope.message="The specified user account does not exist.",$scope.$evalAsync();break;default:console.log("Error changing password:",error)}})},followCollege:function(college,student,$scope){var d=new Date,n=$filter("date")(d,"d MMMM yyyy HH:mm:ss"),refstudent=ref.child("Followers/FollowerByStudentId/"+student+"/"+college);refstudent.set(n);var reffstudent=ref.child("Followers/FollowerByCollegeId/"+college+"/"+student);reffstudent.set(n),$scope.following="yes"},unfollowCollege:function(college,student,$scope){var refstudent=ref.child("Followers/FollowerByStudentId/"+student+"/"+college);refstudent.set(null);var reffstudent=ref.child("Followers/FollowerByCollegeId/"+college+"/"+student);reffstudent.set(null),$scope.following="no"},getfollowers:function(college,student,$scope){var ref=new Firebase(FIREBASE_URL+"Followers/FollowerByStudentId/"+student+"/");ref.once("value",function(snapshot){var a=snapshot.exists();if(a===!0){var b=snapshot.child(college).exists();$scope.following=b===!0?"yes":"no"}else $scope.following="no"})},createAdminForStudent:function(user){var studentAdminSync=ref.child("admin/studentUsers/"+user.uid);studentAdminSync.set(user.email)},register:function(user){return auth.$createUser({email:user.email,password:user.password})},login:function(email,password,$scope){var deferred=$q.defer();return ref.authWithPassword({email:email,password:password},function(error){if(error)$scope.error=error.message,"The specified password is incorrect."===$scope.error&&($("#pass").css({border:"2px solid red"}),$("#usr").css({border:"1px solid rgba(92,169,214,.3)"})),"The specified user does not exist."===$scope.error&&($("#usr").css({border:"2px solid red"}),$("#pass").css({border:"1px solid rgba(92,169,214,.3)"})),console.log($scope.error),$scope.modalShown=!1,$scope.$apply();else{$scope.error="",$("#pass").css({border:"1px solid rgba(92,169,214,.3)"}),$("#usr").css({border:"1px solid rgba(92,169,214,.3)"});
var usertype=Auth.resolveUser().uid;deferred.resolve(usertype),new Firebase(FIREBASE_URL+"profileForStudents/"+usertype+"//studentAvailability").set("online")}}),deferred.promise},logout:function(){Auth.user.profile&&Auth.user.accept&&(Auth.user.profile.$destroy(),Auth.user.accept.$destroy(),angular.copy({},Auth.user),$location.path("/")),new Firebase(FIREBASE_URL+"profileForStudents/"+Auth.resolveUser().uid+"//studentAvailability").set("offline"),auth.$unauth()},resolveUser:function(){var getAuth=auth.$getAuth();return getAuth},signedIn:function(){return!!Auth.user.provider},loginusinggoogle:function(){var ref=new Firebase(FIREBASE_URL);ref.authWithOAuthPopup("google",function(error,authData){var reff=new Firebase(FIREBASE_URL+"admin/GoogleUsers/"+authData.uid);reff.once("value",function(snapshot){var a=snapshot.exists();if(a===!1){var ouser={uid:authData.uid,studentname:authData.google.displayName,email:authData.google.email,gender:authData.google.cachedUserProfile.gender,studentphoto:authData.google.profileImageURL,verifyemail:authData.google.cachedUserProfile.verified_email};Auth.createProfileForOAuth(ouser),$location.path("/facebook")}else angular.copy(authData,Auth.user),Auth.user.profile=$firebaseObject(ref.child("profileForStudents").child(authData.uid)),Auth.user.accept=$firebaseObject(ref.child("profileForStudents").child(authData.uid).child("acceptedInvites")),$location.path("/dashboard")})},{remember:"sessionOnly",scope:"email"})},loginusingfb:function(){var ref=new Firebase(FIREBASE_URL);ref.authWithOAuthPopup("facebook",function(error,authData){var reff=new Firebase(FIREBASE_URL+"admin/FBUsers/"+authData.uid);reff.once("value",function(snapshot){var a=snapshot.exists();if(a===!1){var ouser={uid:authData.uid,studentname:authData.facebook.displayName,email:authData.facebook.email,gender:authData.facebook.cachedUserProfile.gender,studentphoto:authData.facebook.profileImageURL};Auth.createProfileForOAuth(ouser),$location.path("/facebook")}else angular.copy(authData,Auth.user),Auth.user.profile=$firebaseObject(ref.child("profileForStudents").child(authData.uid)),Auth.user.accept=$firebaseObject(ref.child("profileForStudents").child(authData.uid).child("acceptedInvites")),$location.path("/dashboard")})},{remember:"sessionOnly",scope:"email,user_likes"})},AfterOAuthLogin:function(email,phone,uid,$scope){var provider=Auth.resolveUser().auth.provider,oncomplete=function(){if("facebook"===provider){var studentAdminSync=ref.child("admin/FBUsers/"+uid);studentAdminSync.set(email)}else{var studentAdminSync=ref.child("admin/GoogleUsers/"+uid);studentAdminSync.set(email)}var studentAdminSync=ref.child("admin/studentUsers/"+uid);studentAdminSync.set(email);var dataToPost={to:email,pass:"No password as student from facebook and google",sname:$scope.user.profile.studentname,semail:$scope.user.profile.email,smobile:$scope.user.profile.studentmobile};$http({url:"/sendstudentregistrationmail",method:"GET",params:{to:dataToPost.to,semail:dataToPost.semail,sname:dataToPost.sname,pass:dataToPost.pass,smobile:dataToPost.smobile}}).success(function(serverResponse){console.log(serverResponse)}).error(function(serverResponse){console.log(serverResponse)}),$http({url:"/sendmailtostudentafterregistration",method:"GET",params:{to:dataToPost.to,semail:dataToPost.semail,sname:dataToPost.sname}}).success(function(serverResponse){console.log(serverResponse)}).error(function(serverResponse){console.log(serverResponse)});var useridrefff=new Firebase(FIREBASE_URL+"profileForStudents/"+uid+"/emailget/");useridrefff.once("value",function(){useridrefff.set(null)})};$location.path("/signup-success");var useridref=new Firebase(FIREBASE_URL+"profileForStudents/"+uid+"/");useridref.update({email:email}),useridref.update({studentmobile:phone},oncomplete)},createProfileForOAuth:function(user){var useridref=new Firebase(FIREBASE_URL+"/currentUID");useridref.once("value",function(snapshot){var currentCount=snapshot.val()+1,newref=new Firebase(FIREBASE_URL+"profileForStudents/"+user.uid),newprofileObj=$firebaseObject(newref);newprofileObj.studentname=user.studentname,"undefined"!=typeof user.email?newprofileObj.email=user.email:newprofileObj.emailget="false","undefined"!=typeof user.gender&&(newprofileObj.gender=user.gender.charAt(0).toUpperCase()+user.gender.slice(1)),newprofileObj.referredBy="nobody",newprofileObj.dateOfRegistration=$filter("date")(new Date,"d MMMM yyyy"),newprofileObj.profiletype="student",newprofileObj.studentAvailability="offline",newprofileObj.md5_hash=md5.createHash(user.email||""),newprofileObj.studentstatus="notverified",newprofileObj.emailverificationstatus="undefined"!=typeof user.email?"true":"false",newprofileObj.studentphoto=user.studentphoto,newprofileObj.studenturlid=currentCount,useridref.set(currentCount);var idTableRef=new Firebase(FIREBASE_URL+"customUserIdTable/studentCustomId/"+currentCount);idTableRef.set(user.uid),newprofileObj.$save().then(function(){var stuRef=new Firebase(FIREBASE_URL+"/DateWiseStuRegInfo");stuRef.once("value",function(students){var index=students.numChildren()+1;stuRef.push({studentId:user.uid,studentNumber:index})})},function(error){console.log("Error:",error)})})},submitQueryForm:function(dream_college,course_intrested,stu_queries,currentUser){var stu_query_Reff=new Firebase(FIREBASE_URL+"/DashboardQuery/"+currentUser);stu_query_Reff.push({studentDreamCollege:dream_college,courseIntrested:course_intrested,studentQuery:stu_queries});var stu_profile_Reff=new Firebase(FIREBASE_URL+"/profileForStudents/"+currentUser);stu_profile_Reff.update({DashboardQuerySubmitted:"yes"})},user:{}};return auth.$onAuth(function(authData){authData?(angular.copy(authData,Auth.user),Auth.user.profile=$firebaseObject(ref.child("profileForStudents").child(authData.uid)),Auth.user.accept=$firebaseObject(ref.child("profileForStudents").child(authData.uid).child("acceptedInvites")),Auth.user.sessions=$firebaseObject(new Firebase(FIREBASE_URL+"profileForStudents/"+authData.uid+"/sessions/"))):Auth.user.profile&&Auth.user.accept&&(Auth.user.profile.$destroy(),Auth.user.accept.$destroy(),angular.copy({},Auth.user))}),Auth}]),app.factory("AuthCollege",["$firebaseAuth","FIREBASE_URL","$rootScope","$firebaseObject","$firebaseArray","Session","Auth","$q",function($firebaseAuth,FIREBASE_URL){var ref=new Firebase(FIREBASE_URL),authcollege=$firebaseAuth(ref),AuthCollege={resolveUser:function(){var getAuth=authcollege.$getAuth();return getAuth},signedIn:function(){return!!AuthCollege.userc.provider},logout:function(){AuthCollege.userc&&AuthCollege.userc.profile&&(AuthCollege.userc.profile.$destroy(),angular.copy({},AuthCollege.userc)),authcollege.$unauth()},userc:{}};return AuthCollege}]),app.factory("dropdownFactory",["$firebaseAuth","$location","FIREBASE_URL","$rootScope","$firebaseObject","toaster","$firebaseArray","$q",function($firebaseAuth,$location,FIREBASE_URL,$rootScope,$firebaseObject,toaster,$firebaseArray,$q){var stateValue="",courseValue="";return{getStateDropdownObject:function(key){return $firebaseObject(new Firebase(FIREBASE_URL+"stateList/states/"+key))},getAllStateDropdownObjects:function(){return $firebaseObject(new Firebase(FIREBASE_URL+"stateList/states/"))},getCourseDropdownObject:function(key){return $firebaseObject(new Firebase(FIREBASE_URL+"courseList/courses/"+key))},getAllCourseDropdownObjects:function(){return $firebaseObject(new Firebase(FIREBASE_URL+"courseList/courses/"))},getAllCollegeUsers:function(){return $firebaseObject(new Firebase(FIREBASE_URL+"admin/collegeUsers/"))},getCollegeData:function(counsellorEmail){var collegeuserArray=$firebaseArray(new Firebase(FIREBASE_URL+"admin/collegeUsers/"));collegeuserArray.$loaded(function(){collegeuserArray.$keyAt(counsellorEmail)},function(error){console.error("Error:",error)})},sendState:function(state){stateValue=state},getStateValue:function(){return stateValue},resetStateValue:function(){stateValue=""},sendCourse:function(course){courseValue=course},resetCourseValue:function(){courseValue=""},getCourseValue:function(){return courseValue},saveAndroidRequest:function(email){var deferred=$q.defer(),index=$firebaseObject(new Firebase(FIREBASE_URL+"requestForApp/indexForAndroid"));return index.$loaded(function(index){new Firebase(FIREBASE_URL+"requestForApp/android/"+(index.$value+1)).set(email),new Firebase(FIREBASE_URL+"requestForApp/indexForAndroid").set(index.$value+1),deferred.resolve("view")}),deferred.promise},forgotPassword:function(email,$scope){var ref=new Firebase(FIREBASE_URL);ref.resetPassword({email:email},function(error){if(error)switch(error.code){case"INVALID_USER":$scope.message="The specified user account does not exist.",$scope.sendSuccessFully="failure",$scope.$evalAsync();break;default:console.log("Error resetting password:",error)}else $scope.message="Password reset email sent successfully! Please Check your email.",$scope.sendSuccessFully="Done",$scope.$evalAsync()})},submitYourQuery:function(visitorName,visitorPhone,visitorEmail,visitorQuery,$scope){var ref=new Firebase(FIREBASE_URL+"/visitorQuery/");ref.push({visitorName:visitorName,visitorPhone:visitorPhone,visitorEmail:visitorEmail,visitorQuery:visitorQuery}),toaster.pop("success","Your Queries submitted successfully."),$scope.visitorName="",$scope.visitorPhone="",$scope.visitorEmail="",$scope.visitorQuery=""},resetPassword:function(email,oldpassword,newpassword,$scope){var ref=new Firebase(FIREBASE_URL);ref.changePassword({email:email,oldPassword:oldpassword,newPassword:newpassword},function(error){if(error)switch(error.code){case"INVALID_PASSWORD":$scope.message="The specified user account password is incorrect.",$scope.$evalAsync();break;case"INVALID_USER":$scope.message="The specified user account does not exist.",$scope.$evalAsync();break;default:console.log("Error changing password:",error)}else{$scope.message="User password changed successfully!",$scope.user.resetpassword="",$scope.confirm_password="";var studentreff=new Firebase(FIREBASE_URL+"admin/studentUsers");studentreff.once("value",function(snapshot){snapshot.forEach(function(childSnapshot){if(childSnapshot.val()===email){var studentId=childSnapshot.key();return new Firebase(FIREBASE_URL+"profileForStudents/"+studentId+"/").update({password:newpassword}),void $scope.$evalAsync()}})});var collegeref=new Firebase(FIREBASE_URL+"admin/collegeUsers");collegeref.once("value",function(snapshot){snapshot.forEach(function(childSnapshot){if(childSnapshot.val()===email){var collegeId=childSnapshot.key();return new Firebase(FIREBASE_URL+"profileForCollege/"+collegeId+"/").update({collegepassword:newpassword}),void $scope.$evalAsync()}})});var nodalreff=new Firebase(FIREBASE_URL+"admin/nodaladminUsers");nodalreff.once("value",function(snapshot){snapshot.forEach(function(childSnapshot){if(childSnapshot.val()===email){var nodalId=childSnapshot.key();return new Firebase(FIREBASE_URL+"profileForNodalAdmins/"+nodalId+"/").update({password:newpassword}),void $scope.$evalAsync()}})});var mentorReff=new Firebase(FIREBASE_URL+"admin/mentorUsers");mentorReff.once("value",function(snapshot){snapshot.forEach(function(childSnapshot){if(childSnapshot.val()===email){var mentorId=childSnapshot.key();return new Firebase(FIREBASE_URL+"profileForMentors/"+mentorId+"/").update({password:newpassword}),void $scope.$evalAsync()}})});var schoolRef=new Firebase(FIREBASE_URL+"admin/SchoolUsers");schoolRef.once("value",function(snapshot){snapshot.forEach(function(childSnapshot){if(childSnapshot.val()===email){var schoolId=childSnapshot.key();return new Firebase(FIREBASE_URL+"profileForSchools/"+schoolId+"/").update({password:newpassword}),void $scope.$evalAsync()}})}),$scope.$evalAsync()}})}}}]),app.factory("Search",["FIREBASE_URL","$rootScope","$q","$firebaseObject","$firebaseArray",function(FIREBASE_URL,$rootScope,$q,$firebaseObject,$firebaseArray){var ref=new Firebase(FIREBASE_URL+"profileForCollege/"),refstudent=new Firebase(FIREBASE_URL+"profileForStudents//"),collegeObj=(new Firebase(FIREBASE_URL+"profileForAdmins//"),new Firebase(FIREBASE_URL+"profileForNodalAdmins//"),$firebaseObject(ref)),tempState="",tempCourse="",collegeArray=$firebaseArray(ref),College={all:collegeObj,allAsArray:collegeArray,find:function(collegeId){return $firebaseObject(ref.child(collegeId))},getCourseIdByName:function(courseName){var deferred=$q.defer(),courseArray=$firebaseArray(new Firebase(FIREBASE_URL+"courseList/courses/"));return courseArray.$loaded(function(courseArray){for(var i=0;i<courseArray.length;i++)if(courseArray[i].$value==courseName)var simpleUser=courseArray.$keyAt(courseArray[i]);if(simpleUser)deferred.resolve(simpleUser);else{var simpleUser="user doesnot exists";deferred.resolve(simpleUser)}},function(error){console.error("Error:",error),deferred.reject(error)}),deferred.promise},setStateToView:function(state){tempState=state},setCourseToView:function(course){tempCourse=course},getStateToView:function(){return""!==tempState?tempState:void 0},getCourseToView:function(){return""!==tempCourse?tempCourse:void 0},getCollegeByState:function(state){var deferred=$q.defer(),collegeListAfterSearch=[],stateName=$firebaseObject(new Firebase(FIREBASE_URL+"stateList/states/"+state+"/"));return stateName.$loaded(function(stateName){var CollegeInState=$firebaseArray(new Firebase(FIREBASE_URL+"StateCollegeSearch/"+stateName.$value+"/"));CollegeInState.$loaded(function(CollegeInState){for(var i=0;i<CollegeInState.length;i++){var collegeref=$firebaseObject(ref.child(CollegeInState[i].$id));collegeref.$loaded(function(collegeref){collegeListAfterSearch.push(collegeref)}).then(function(){deferred.resolve(collegeListAfterSearch)})}})}),deferred.promise},getStateIdByName:function(stateName){var deferred=$q.defer(),stateArray=$firebaseArray(new Firebase(FIREBASE_URL+"stateList/states/"));return stateArray.$loaded(function(stateArray){for(var i=0;i<stateArray.length;i++)if(stateArray[i].$value==stateName)var simpleUser=stateArray.$keyAt(stateArray[i]);if(simpleUser)deferred.resolve(simpleUser);else{var simpleUser="user doesnot exists";deferred.resolve(simpleUser)}},function(error){console.error("Error:",error),deferred.reject(error)}),deferred.promise},getStudentDetail:function(studenturl){return $firebaseObject(refstudent.child(studenturl))},getAllStateDropdownObjects:function(){return $firebaseObject(new Firebase(FIREBASE_URL+"stateList/states/"))},getStateDropdownObject:function(key){return $firebaseObject(new Firebase(FIREBASE_URL+"stateList/states/"+key))},getAllCourseDropdownObjects:function(){return $firebaseObject(new Firebase(FIREBASE_URL+"courseList/courses/"))},getCourseDropdownObject:function(key){return $firebaseObject(new Firebase(FIREBASE_URL+"courseList/courses/"+key))},getcollegeDetail:function(collegeId){var deferred=$q.defer(),collegeref=$firebaseObject(ref.child(collegeId));return collegeref.$loaded(function(collegeref){deferred.resolve(collegeref)},function(error){console.error("Error:",error),deferred.reject(error)}),deferred.promise},getStudentName:function(studentId){var studentnameref=new Firebase(FIREBASE_URL+"profileForStudents/"+studentId+"/studentname");return $firebaseObject(studentnameref)},getStudentStatus:function(studentId){var studentnameref=new Firebase(FIREBASE_URL+"profileForStudents/"+studentId+"/studentstatus");return $firebaseObject(studentnameref)},getStudentIncentive:function(StudentId){var studentincentiveref=new Firebase(FIREBASE_URL+"profileForStudents/"+StudentId+"/totalIncentiveForSessions");return $firebaseObject(studentincentiveref)},getStudentEmail:function(studentId){var studentemailref=new Firebase(FIREBASE_URL+"profileForStudents/"+studentId+"/email");return $firebaseObject(studentemailref)},getstudentphone:function(studentId){var studentphoneref=new Firebase(FIREBASE_URL+"profileForStudents/"+studentId+"/studentmobile");return $firebaseObject(studentphoneref)},getStudentPhoto:function(studentId){var studentphotoref=new Firebase(FIREBASE_URL+"profileForStudents/"+studentId+"/studentphoto");return $firebaseObject(studentphotoref)},getCollegePhoto:function(collegeId){var collegephotoref=new Firebase(FIREBASE_URL+"profileForCollege/"+collegeId+"/collegephoto");return $firebaseObject(collegephotoref)},getCollegeName:function(collegeId){var collegenameref=new Firebase(FIREBASE_URL+"profileForCollege/"+collegeId+"/collegename");return $firebaseObject(collegenameref)},getCollegeEmail:function(collegeId){var collegeemailref=new Firebase(FIREBASE_URL+"profileForCollege/"+collegeId+"/counsellorEmail");return $firebaseObject(collegeemailref)},getCollegeVerification:function(collegeId){var collegenameref=new Firebase(FIREBASE_URL+"profileForCollege/"+collegeId+"/verifiedcollege");return $firebaseObject(collegenameref)},getCollegeType:function(collegeId){var collegenameref=new Firebase(FIREBASE_URL+"profileForCollege/"+collegeId+"/collegetype");return $firebaseObject(collegenameref)},getCollegeIdByEmail:function(counsellorEmail){var deferred=$q.defer(),collegeUserArray=$firebaseArray(new Firebase(FIREBASE_URL+"admin/collegeUsers"));return collegeUserArray.$loaded(function(collegeUserArray){for(var i=0;i<collegeUserArray.length;i++)if(collegeUserArray[i].$value==counsellorEmail)var simpleUser=collegeUserArray.$keyAt(collegeUserArray[i]);if(simpleUser)deferred.resolve(simpleUser);else{var simpleUser="user doesnot exists";deferred.resolve(simpleUser)}},function(error){console.error("Error:",error),deferred.reject(error)}),deferred.promise},getStudentNameByEmail:function(studentEmail){var deferred=$q.defer(),studentUserArray=$firebaseArray(new Firebase(FIREBASE_URL+"admin/studentUsers"));return studentUserArray.$loaded(function(studentUserArray){for(var i=0;i<studentUserArray.length;i++)if(studentUserArray[i].$value==studentEmail)var simpleUser=studentUserArray.$keyAt(studentUserArray[i]);if(simpleUser){var stu=College.getStudentName(simpleUser);stu.$loaded(function(stu){var studentname=stu.$value;deferred.resolve(studentname)})}},function(error){console.error("Error:",error),deferred.reject(error)}),deferred.promise},getStudentIdByEmail:function(studentEmail){var deferred=$q.defer(),studentUserArray=$firebaseArray(new Firebase(FIREBASE_URL+"admin/studentUsers"));return studentUserArray.$loaded(function(studentUserArray){for(var i=0;i<studentUserArray.length;i++)if(studentUserArray[i].$value==studentEmail)var simpleUser=studentUserArray.$keyAt(studentUserArray[i]);if(simpleUser)deferred.resolve(simpleUser);else{var simpleUser="user doesnot exists";deferred.resolve(simpleUser)}},function(error){console.error("Error:",error),deferred.reject(error)}),deferred.promise},getSessionStatus:function(studentId,collegeId){var deferred=$q.defer(),sessionVerStatusRef=new Firebase(FIREBASE_URL+"collegeSessions/"+collegeId+"/"+studentId+"/sessionVerificationStatus"),sessionVerStatusObj=$firebaseObject(sessionVerStatusRef);return sessionVerStatusObj.$loaded(function(sessionVerStatusObj){deferred.resolve(sessionVerStatusObj)},function(error){console.error("Error:",error),deferred.reject(error)}),deferred.promise},isFeedbackGiven:function(studentId,collegeId){var deferred=$q.defer(),feedbackStatusRef=new Firebase(FIREBASE_URL+"collegeSessions/"+collegeId+"/"+studentId),feedbackStatusObj=$firebaseObject(feedbackStatusRef);return feedbackStatusObj.$loaded(function(){deferred.resolve(feedbackStatusObj)}),deferred.promise},getStudentEmailStatus:function(studentId){var studentemailref=new Firebase(FIREBASE_URL+"profileForStudents/"+studentId+"/emailverificationstatus");return $firebaseObject(studentemailref)},getFeedbackStatus:function(studentId,collegeId){return $firebaseObject(new Firebase(FIREBASE_URL+"collegeFeedback/"+collegeId+"/"+studentId))},getFeedbackNotGivenCount:function(collegeId,$scope){var collegeRef=new Firebase(FIREBASE_URL+"profileForCollege/"+collegeId+"/"),collegeObj=$firebaseObject(collegeRef);collegeObj.$loaded(function(result){$scope.sessionno=result.sessionCount,$scope.feedbacknum=result.feedbacknotgivenCount})},getStudentSessions:function(studentId){return $firebaseObject(new Firebase(FIREBASE_URL+"studentSessions/"+studentId+"/"))},checkNewBookSessionForNotification:function(studentId,$scope){$scope.sessionLength=0;var studentSessionLengthRef=new Firebase(FIREBASE_URL+"studentSessions/"+studentId+"/");studentSessionLengthRef.on("value",function(){$scope.sessionLength=$scope.sessionLength+1,$scope.bookhistorytab="show",$scope.$evalAsync()})},notificationOfIncentiveChange:function(studentId,$scope){$scope.sessionIncentive=0,$scope.referralIncentive=0;var sessionIncentiveRef=new Firebase(FIREBASE_URL+"profileForStudents/"+studentId+"/totalIncentiveForSessions");sessionIncentiveRef.on("value",function(){$scope.sessionIncentive=$scope.sessionIncentive+1,$scope.$evalAsync()});var referralIncentiveRef=new Firebase(FIREBASE_URL+"profileForStudents/"+studentId+"/totalIncentiveForReferral");referralIncentiveRef.on("value",function(){$scope.referralIncentive=$scope.referralIncentive+1,$scope.$evalAsync()})},getStudentEmailVerificationStatus:function(studentId,$scope){$scope.getStudentEmailVerification="";var emailStatus=new Firebase(FIREBASE_URL+"profileForStudents/"+studentId+"/emailverificationstatus");emailStatus.on("value",function(dataSnapshot1){$scope.getStudentEmailVerification=dataSnapshot1.val(),$scope.$evalAsync()})},storeview:function(collegeId){var updatePendingStatusref=new Firebase(FIREBASE_URL+"profileForCollege/"+collegeId),sync=$firebaseObject(updatePendingStatusref);sync.$loaded(function(sync){if("undefined"==typeof sync.collegeView)updatePendingStatusref.update({collegeView:1});else{var view=sync.collegeView;updatePendingStatusref.update({collegeView:view+1})}})},studentDetailForNotification:function(studentId,$scope){$scope.profileIncomplete="";var student=new Firebase(FIREBASE_URL+"profileForStudents/"+studentId);student.on("value",function(dataSnapshot1){var student=dataSnapshot1.val();"undefined"==typeof student.academicrecord12thMarks||"undefined"==typeof student.coursesUG||"undefined"==typeof student.fathername||"undefined"==typeof student.fathernumber||"undefined"==typeof student.occupation||"undefined"==typeof student.studentabout||"undefined"==typeof student.studentdocument||"https://www.filepicker.io/api/file/M6FYqDmeRlaLV3sTl1tp"==student.studentphoto?($scope.profileIncomplete="Done",$scope.$evalAsync()):($scope.profileIncomplete="Not Done",$scope.$evalAsync())})},getStudentIdAndUrlidByEmail:function(studentEmail){var deferred=$q.defer(),studentUserArray=$firebaseArray(new Firebase(FIREBASE_URL+"admin/studentUsers"));return studentUserArray.$loaded(function(studentUserArray){for(var simpleuser={},i=0;i<studentUserArray.length;i++)studentUserArray[i].$value==studentEmail&&(simpleuser.uid=studentUserArray.$keyAt(studentUserArray[i]));if(simpleuser.uid){var studentUrlidRef=new Firebase(FIREBASE_URL+"profileForStudents/"+simpleuser.uid+"/studenturlid");studentUrlidRef.once("value",function(snapshot){simpleuser.urlId=snapshot.val()}),deferred.resolve(simpleuser)}else simpleuser.uid="user doesnot exists",deferred.resolve(simpleuser)},function(error){console.error("Error:",error),deferred.reject(error)}),deferred.promise},getCollegeIdAndUrlidByEmail:function(counsellorEmail){var deferred=$q.defer(),collegeUserArray=$firebaseArray(new Firebase(FIREBASE_URL+"admin/collegeUsers"));return collegeUserArray.$loaded(function(collegeUserArray){for(var simpleuser={},i=0;i<collegeUserArray.length;i++)collegeUserArray[i].$value==counsellorEmail&&(simpleuser.uid=collegeUserArray.$keyAt(collegeUserArray[i]));if(simpleuser.uid){var collegeUrlidRef=new Firebase(FIREBASE_URL+"profileForCollege/"+simpleuser.uid+"/collegeurlid");collegeUrlidRef.once("value",function(snapshot){simpleuser.urlId=snapshot.val()}),deferred.resolve(simpleuser)}else simpleuser.uid="user doesnot exists",deferred.resolve(simpleuser)},function(error){console.error("Error:",error),deferred.reject(error)}),deferred.promise},getMSFImages:function(){return $firebaseObject(new Firebase(FIREBASE_URL+"ImageUrl/msf"))}};return College}]),app.factory("Session",["FIREBASE_URL","$rootScope","Auth","$q","AdminAuth","$firebaseArray","$firebaseObject",function(FIREBASE_URL,$rootScope,Auth,$q,AdminAuth,$firebaseArray,$firebaseObject){var ref=new Firebase(FIREBASE_URL+"profileForCollege/"),collegeObj=$firebaseObject(ref),collegeArray=$firebaseArray(ref),Session={all:collegeObj,allAsArray:collegeArray,sessionQuery:function(collegeId,$scope){var currentUser=Auth.resolveUser();console.log(currentUser.uid);var sessionCollegeRef=new Firebase(FIREBASE_URL+"collegeSessions/"+collegeId+"/"+currentUser.uid);$scope.queryy=$firebaseObject(sessionCollegeRef)},doesSessionExists:function(collegeId){var deferred=$q.defer(),currentUser=Auth.resolveUser(),checksessionRef=new Firebase(FIREBASE_URL+"collegeSessions/"+collegeId+"/"+currentUser.uid),checksessionObj=$firebaseObject(checksessionRef);return checksessionObj.$loaded(function(checksessionObj){deferred.resolve("undefined"==typeof checksessionObj.sessiondate?!1:!0)}),deferred.promise},booksession:function(collegeId,studenturlid,collegeurlid,hours,minutes,date,query){var currentUser=Auth.resolveUser(),studentUrlId="",collegeurlId="",studentId=currentUser.uid;if("undefined"==typeof studenturlid){var data=currentUser.uid.split(":");studentUrlId=data[1]}else studentUrlId=studenturlid;if("undefined"==typeof collegeurlid){var str=collegeId,collegeIdArraySplit=str.split(":");collegeurlId=collegeIdArraySplit[1]}else collegeurlId=collegeurlid;var checksessionRef=new Firebase(FIREBASE_URL+"collegeSessions/"+collegeId+"/"+currentUser.uid),checksessionObj=$firebaseObject(checksessionRef);checksessionObj.$loaded(function(checksessionObj){if("pending"!==checksessionObj.sessionVerificationStatus&&"approved"!==checksessionObj.sessionVerificationStatus||"undefined"==typeof checksessionObj.interactionId)if("undefined"==typeof checksessionObj.sessiondate){var sessionCountRef=new Firebase(FIREBASE_URL+"profileForCollege/"+collegeId+"/"),sync=$firebaseObject(sessionCountRef);sync.$loaded(function(sync){var sessionno=sync.sessionCount,feedbackno=sync.feedbacknotgivenCount,sessionCountRef1=new Firebase(FIREBASE_URL+"profileForCollege/"+collegeId+"/"),sync1=sessionCountRef1;sync1.update({sessionCount:sessionno+1}),sync1.update({feedbacknotgivenCount:feedbackno+1});var currentSessionCountObj=$firebaseObject(new Firebase(FIREBASE_URL+"collegeSessions/"+collegeId+"/currentSessionCount"));currentSessionCountObj.$loaded(function(count){var sessionCollegeRef=new Firebase(FIREBASE_URL+"collegeSessions/"+collegeId+"/"+currentUser.uid+"/"),sessionCollegeObj=$firebaseObject(sessionCollegeRef);sessionCollegeObj.collegeurl=collegeId,sessionCollegeObj.collegeurlId=collegeurlId,sessionCollegeObj.studenturl=currentUser.uid,sessionCollegeObj.studenturlId=studentUrlId,sessionCollegeObj.sessionhour=hours,sessionCollegeObj.sessionminute=minutes,sessionCollegeObj.sessiondate=date,sessionCollegeObj.studentquery=query,sessionCollegeObj.nodalId="NODAL1025",sessionCollegeObj.sessionCompleted="No",sessionCollegeObj.sessionNumber=count.$value+1,sessionCollegeObj.$save().then(function(){},function(error){console.log("Error:",error)});var a=date.split(" "),month=a[1],year=a[2];console.log("year"+year);var ClgStdSimlogRef=new Firebase(FIREBASE_URL+"collegeSessionRecordMonthWise/"+a[2]+"/"+month+"/college/"+collegeId+"/"+studentId+"/studenturl"),ClgnodalSimlogRef=new Firebase(FIREBASE_URL+"collegeSessionRecordMonthWise/"+a[2]+"/"+month+"/college/"+collegeId+"/"+studentId+"/nodalurl"),allSessionNodalRef=new Firebase(FIREBASE_URL+"collegeSessionRecordMonthWise/allSessions/"+collegeId+"/"+studentId+"/nodalurl"),allSessionStdRef=new Firebase(FIREBASE_URL+"collegeSessionRecordMonthWise/allSessions/"+collegeId+"/"+studentId+"/studenturl"),nodalRef=new Firebase(FIREBASE_URL+"nodalSessionRecordMonthWise/"+a[2]+"/"+month+"/simplelogin:1025/college/"+collegeId+"/"+studentId+"/studenturl"),allNodalSessionRef=new Firebase(FIREBASE_URL+"nodalSessionRecordMonthWise/allSessions/simplelogin:1025/"+collegeId+"/"+studentId+"/studenturl");ClgnodalSimlogRef.set("simplelogin:1025"),ClgStdSimlogRef.set(studentId),allSessionStdRef.set(studentId),allSessionNodalRef.set("simplelogin:1025"),nodalRef.set(studentId),allNodalSessionRef.set(studentId);var currentSessionCountUpdate=new Firebase(FIREBASE_URL+"collegeSessions/"+collegeId+"/");currentSessionCountUpdate.update({currentSessionCount:count.$value+1})});var sessionStudentRef=new Firebase(FIREBASE_URL+"studentSessions/"+currentUser.uid+"/"+collegeId+"/"),sessionStudentObj=$firebaseObject(sessionStudentRef);sessionStudentObj.collegeurl=collegeId,sessionStudentObj.collegeurlId=collegeurlId,sessionStudentObj.studenturl=currentUser.uid,sessionStudentObj.studenturlId=studentUrlId,sessionStudentObj.sessionhour=hours,sessionStudentObj.sessionminute=minutes,sessionStudentObj.sessiondate=date,sessionStudentObj.studentquery=query,sessionStudentObj.nodalId="NODAL1025",sessionStudentObj.sessionCompleted="No",sessionStudentObj.$save().then(function(ref){var a=date.split(" "),sample="1025H"+hours+"MT"+minutes+"D"+a[0]+"M"+a[1]+"Y2015",ref=new Firebase(FIREBASE_URL+"allignedStudentGroup/"+collegeId+"/"+sample+"/"+studentId);ref.set(studentId);var day=a[0],month=a[1],year=a[2],numberOfBookings=1,adminSessionRef=new Firebase(FIREBASE_URL+"adminUpcommingCounsellingSessions/"+year+"/"+month+"/"+day);adminSessionRef.once("value",function(snapshot){var sessionNumber=snapshot.numChildren()+1;adminSessionRef.push({sessionNumber:sessionNumber,studentId:currentUser.uid,collegeId:collegeId,nodalId:"NODAL1025"})});var numberOfBookingsRef=new Firebase(FIREBASE_URL+"datesOfUpcommingCounsellingSessions/"+year+"/"+month+"/"+day+"/numberOfBookings");numberOfBookingsRef.once("value",function(snapshot){snapshot.val()&&(numberOfBookings=snapshot.val()+1);var newNumberOfBookingsRef=new Firebase(FIREBASE_URL+"datesOfUpcommingCounsellingSessions/"+year+"/"+month+"/"+day);newNumberOfBookingsRef.set({numberOfBookings:numberOfBookings,date:day})})},function(error){console.log("Error:",error)})})}else{var sessionCollegeRef=new Firebase(FIREBASE_URL+"collegeSessions/"+collegeId+"/"+currentUser.uid+"/"),sessionCollegeSync=sessionCollegeRef;sessionCollegeSync.update({studentquery:query});var sessionStudentRef=new Firebase(FIREBASE_URL+"studentSessions/"+currentUser.uid+"/"+collegeId+"/"),sessionStudentSync=sessionStudentRef;sessionStudentSync.update({studentquery:query})}else{var sessionCollegeRef=new Firebase(FIREBASE_URL+"collegeSessions/"+collegeId+"/"+currentUser.uid+"/"),sessionCollegeSync=sessionCollegeRef;sessionCollegeSync.update({studentquery:query});var sessionStudentRef=new Firebase(FIREBASE_URL+"studentSessions/"+currentUser.uid+"/"+collegeId+"/"),sessionStudentSync=sessionStudentRef;sessionStudentSync.update({studentquery:query})}})}};return Session}]),app.factory("Verify",["FIREBASE_URL","$rootScope","$firebaseObject","$firebaseArray",function(FIREBASE_URL,$rootScope,$firebaseObject){var Verify={getMD5:function(userId){var studentMd5ref=new Firebase(FIREBASE_URL+"profileForStudents/"+userId+"/md5_hash");return $firebaseObject(studentMd5ref)},getEmailVerified:function(UserId){var emailStatusRef=new Firebase(FIREBASE_URL+"profileForStudents/"+UserId),emailVerificationStatus=emailStatusRef;emailVerificationStatus.update({emailverificationstatus:"true"})}};return Verify}]),app.factory("Blog",["$firebaseAuth","$location","FIREBASE_URL","$firebaseObject","$firebaseArray","$rootScope","$filter","$timeout","AuthMentor","AuthCollege","Search","$q",function($firebaseAuth,$location,FIREBASE_URL,$firebaseObject,$firebaseArray,$rootScope,$filter,$timeout,AuthMentor,AuthCollege,Search,$q){var Blog={getPost:function($scope){$scope.post=[];var postRef=new Firebase(FIREBASE_URL+"posts/allPosts");$scope.post=$firebaseArray(postRef.limitToLast(2)),$scope.$evalAsync()},loadMoreBlogs:function(postNumber,$scope){var tempPostArr=[];if($scope.starting!==postNumber-2&&$scope.ending!==postNumber-1&&($scope.starting=postNumber-2,$scope.ending=postNumber-1,($scope.ending>0||0==$scope.ending)&&($scope.starting>0||0==$scope.starting))){var postRef=new Firebase(FIREBASE_URL+"posts/allPosts"),tempPost=$firebaseArray(postRef.orderByChild("postNumber").startAt($scope.starting).endAt($scope.ending));
tempPost.$loaded(function(value){tempPostArr=value,tempPostArr=tempPostArr.concat($scope.post),$scope.post=tempPostArr,$scope.$evalAsync()})}},getPostDetail:function(postId,$scope){var postRef=new Firebase(FIREBASE_URL+"posts/allPosts/"+postId),postObject=$firebaseObject(postRef);return postObject.$loaded(function(postObject){$scope.mentorName=Blog.getMentorName(postObject.mentoruid),Blog.getBlogComment(postId,$scope),$scope.$evalAsync()}),$firebaseObject(postRef)},getCatagoryPosts:function(catagory,$scope){$scope.post=[];var postCatagoryWiseRef=new Firebase(FIREBASE_URL+"posts/catagories/"+catagory);$scope.post=$firebaseArray(postCatagoryWiseRef.limitToLast(2)),$scope.$evalAsync()},loadMoreCatagoryBlogs:function(catagory,postNumber,$scope){var tempPostArr=[];if($scope.starting!==postNumber-2&&$scope.ending!==postNumber-1&&($scope.starting=postNumber-2,$scope.ending=postNumber-1,($scope.ending>0||0==$scope.ending)&&($scope.starting>0||0==$scope.starting))){var postCatagoryWiseRef=new Firebase(FIREBASE_URL+"posts/catagories/"+catagory),tempPost=$firebaseArray(postCatagoryWiseRef.orderByChild("postNumber").startAt($scope.starting).endAt($scope.ending));tempPost.$loaded(function(value){tempPostArr=value,tempPostArr=tempPostArr.concat($scope.post),$scope.post=tempPostArr,$scope.$evalAsync()})}},getYearlyPosts:function(year,$scope){$scope.post=[];var postDateWiseRef=new Firebase(FIREBASE_URL+"posts/dateWise/"+year);postDateWiseRef.on("value",function(snapshot){snapshot.forEach(function(childSnapshot){childSnapshot.key();angular.forEach(childSnapshot.val(),function(posts){$scope.post=$scope.post.concat(posts),$scope.$evalAsync()})})})},getMonthlyPosts:function(year,month,$scope){$scope.post=[];var postDateWiseRef=new Firebase(FIREBASE_URL+"posts/dateWise/"+year+"/"+month);postDateWiseRef.on("value",function(snapshot){angular.forEach(snapshot.val(),function(posts){$scope.post=$scope.post.concat(posts),$scope.$evalAsync()})})},getAllPostsForMentor:function(){var mentoruid=AuthMentor.resolveUser().uid;return $firebaseArray(new Firebase(FIREBASE_URL+"/posts/mentorWise/"+mentoruid))},getMentorName:function(mentoruid){return $firebaseObject(new Firebase(FIREBASE_URL+"/profileForMentors/"+mentoruid+"/mentorname"))},saveComment:function(postId,comment,name,email,$scope){var defered=$q.defer(),commentRef=new Firebase(FIREBASE_URL+"blogComments/"+postId);return commentRef.push({name:name,email:email,comment:comment},function(){$scope.commentSaveSuccessfully=!0,defered.resolve($scope.commentSaveSuccessfully),$scope.$evalAsync()}),defered.promise},getBlogComment:function(postId,$scope){$scope.blogCommentList=$firebaseArray(new Firebase(FIREBASE_URL+"blogComments/"+postId)),$scope.$evalAsync()},getHouseProfile:function(houseName,$scope){var houseDetailRef=new Firebase(FIREBASE_URL+"posts/housesDetails/"+houseName);$scope.houseDetail=$firebaseObject(houseDetailRef),$scope.$evalAsync()},getStudentDashBoardPosts:function($scope){$scope.post_loaded=5,$scope.post=[];var postCatagoryWiseRef=new Firebase(FIREBASE_URL+"posts/allPosts");postCatagoryWiseRef.on("value",function(allPosts){$scope.totalPosts=allPosts.numChildren(),$scope.hideLoadMore=$scope.totalPosts<5||5==$scope.totalPosts?"yes":"no"});var postsArr=$firebaseArray(postCatagoryWiseRef.orderByChild("postNumber").limitToLast(5));postsArr.$loaded(function(postsArr){$scope.post=postsArr,$scope.post.reverse(),$scope.$evalAsync()})},LoadMoreStudentDashBoardPosts:function($scope){var tempPostArr=[],postCatagoryWiseRef=new Firebase(FIREBASE_URL+"posts/allPosts");if($scope.post_loaded<$scope.totalPosts){var morePostArray=$firebaseArray(postCatagoryWiseRef.orderByChild("postNumber").startAt($scope.totalPosts-($scope.post_loaded+5)).endAt($scope.totalPosts-$scope.post_loaded));morePostArray.$loaded(function(morePostArray){tempPostArr=morePostArray,tempPostArr.reverse(),$scope.post=$scope.post.concat(tempPostArr),$scope.post_loaded=$scope.post.length,$scope.hideLoadMore="no",$scope.post_loaded===$scope.totalPosts&&($scope.hideLoadMore="yes"),$scope.$evalAsync()})}else $scope.hideLoadMore="yes"},getAuthorDetailAndPost:function(authorUid,$scope){var authorDetailRef=new Firebase(FIREBASE_URL+"/profileForMentors/"+authorUid),authorPostRef=new Firebase(FIREBASE_URL+"posts/mentorWise/"+authorUid);$scope.authorDetails=$firebaseObject(authorDetailRef),$scope.authorPosts=$firebaseArray(authorPostRef),$scope.$evalAsync()},userClickForScholarship:function(){var numberOfClick=$firebaseObject(new Firebase(FIREBASE_URL+"userScholarshipClick"));numberOfClick.$loaded(function(numberOfClick){var clickReff=new Firebase(FIREBASE_URL+"userScholarshipClick");clickReff.update({userClick:numberOfClick.userClick+1})})},getHousePosts:function(catagory,$scope){$scope.post_loaded=2,$scope.post=[];var postCatagoryWiseRef=new Firebase(FIREBASE_URL+"posts/catagories/"+catagory);postCatagoryWiseRef.on("value",function(allPosts){$scope.totalPosts=allPosts.numChildren(),$scope.hideLoadMore=$scope.totalPosts<2||2==$scope.totalPosts?"yes":"no"});var postsArr=$firebaseArray(postCatagoryWiseRef.orderByChild("postNumber").limitToLast(2));postsArr.$loaded(function(postsArr){$scope.post=postsArr,$scope.post.reverse(),$scope.$evalAsync()})},load_more_posts:function(catagory,$scope){var tempPostArr=[],postCatagoryWiseRef=new Firebase(FIREBASE_URL+"posts/catagories/"+catagory);if($scope.post_loaded<$scope.totalPosts){var morePostArray=$firebaseArray(postCatagoryWiseRef.orderByChild("postNumber").startAt($scope.totalPosts-($scope.post_loaded+3)).endAt($scope.totalPosts-$scope.post_loaded));morePostArray.$loaded(function(morePostArray){tempPostArr=morePostArray,tempPostArr.reverse(),$scope.post=$scope.post.concat(tempPostArr),$scope.post_loaded=$scope.post.length,$scope.hideLoadMore="no",$scope.post_loaded===$scope.totalPosts&&($scope.hideLoadMore="yes"),$scope.$evalAsync()})}else $scope.hideLoadMore="yes"},getHouseMentor:function(houseName,$scope){$scope.mentorDetail=[];var key=0,houseMentorRef=new Firebase(FIREBASE_URL+"/houseWiseMentors/"+houseName);houseMentorRef.on("value",function(snapshot){angular.forEach(snapshot.val(),function(mentorId){var mentorDetailRef=new Firebase(FIREBASE_URL+"/profileForMentors/"+mentorId);mentorDetailRef.on("value",function(mentorDetail){$scope.mentorDetail[key]={image:mentorDetail.val().mentorphoto,mentorname:mentorDetail.val().mentorname,mentorid:mentorId},$scope.$evalAsync(),key+=1})})})},addHousePostComment:function(postKey,postId,PostComment,userId,date,commentTime,timestamp,studentphoto,studentname,$scope){$scope.userName[postId]||($scope.userName[postId]=[]),$scope.userPic[postId]||($scope.userPic[postId]=[]);var houseCommentRef=new Firebase(FIREBASE_URL+"/houseComments/comments/"+postId);houseCommentRef.once("value",function(snapshot){var temp=snapshot.exists();if(temp===!0){var commentNumber=snapshot.numChildren()+1,comment=houseCommentRef.push({commentNumber:commentNumber,comment:PostComment,likes:0,userId:userId,timestamp:timestamp,date:date,time:commentTime}),commentId=comment.key(),updateCommentIdRef=new Firebase(FIREBASE_URL+"/houseComments/comments/"+postId+"/"+commentId);updateCommentIdRef.update({commentId:commentId}),$scope.comments[postKey]=$scope.comments[postKey].concat({commentId:commentId,commentNumber:commentNumber,comment:PostComment,likes:0,userId:userId,timestamp:timestamp,date:date,time:commentTime}),$scope.userName[postId][commentId]={$id:"studentname",$priority:null,$value:studentname},$scope.userPic[postId][commentId]={$id:"studentphoto",$priority:null,$value:studentphoto},$scope.comment_loaded[postKey]=$scope.comment_loaded[postKey]+1,$scope.totalComments[postKey]=$scope.totalComments[postKey]+1,$scope.hideLoadMoreButton[postKey]=$scope.comment_loaded[postKey]===$scope.totalComments[postKey]||$scope.comment_loaded[postKey]>$scope.totalComments[postKey]?"yes":"no",$scope.$evalAsync()}else{var commentNumber=1,comment=houseCommentRef.push({commentNumber:commentNumber,comment:PostComment,likes:0,userId:userId,timestamp:timestamp,date:date,time:commentTime}),commentId=comment.key(),updateCommentIdRef=new Firebase(FIREBASE_URL+"/houseComments/comments/"+postId+"/"+commentId);updateCommentIdRef.update({commentId:commentId}),$scope.comments[postKey]=$scope.comments[postKey].concat({commentId:commentId,commentNumber:commentNumber,comment:PostComment,likes:0,userId:userId,timestamp:timestamp,date:date,time:commentTime}),$scope.userName[postId][commentId]={$id:"studentname",$priority:null,$value:studentname},$scope.userPic[postId][commentId]={$id:"studentphoto",$priority:null,$value:studentphoto},$scope.totalComments[postKey]=$scope.totalComments[postKey]+1,$scope.hideLoadMoreButton[postKey]=$scope.comment_loaded[postKey]===$scope.totalComments[postKey]||$scope.comment_loaded[postKey]>$scope.totalComments[postKey]?"yes":"no",$scope.$evalAsync()}})},loadPostComments:function(postId,postKey,$scope){$scope.userName[postId]||($scope.userName[postId]=[]),$scope.userPic[postId]||($scope.userPic[postId]=[]);var commentRef=new Firebase(FIREBASE_URL+"/houseComments/comments/"+postId);$scope.comment_loaded[postKey]=2,commentRef.once("value",function(allComments){$scope.totalComments[postKey]=allComments.numChildren(),$scope.$evalAsync(),0==$scope.totalComments[postKey]&&($scope.hideLoadMoreButton[postKey]="yes",$scope.$evalAsync());var commentsArr=$firebaseArray(commentRef.orderByChild("commentNumber").limitToLast(2));commentsArr.$loaded(function(commentsArr){$scope.comments[postKey]=commentsArr,angular.forEach(commentsArr,function(commentData){$scope.userName[postId][commentData.commentId]=Search.getStudentName(commentData.userId),$scope.userPic[postId][commentData.commentId]=Search.getStudentPhoto(commentData.userId),$scope.$evalAsync()}),($scope.comment_loaded[postKey]===$scope.totalComments[postKey]||$scope.comment_loaded[postKey]>$scope.totalComments[postKey])&&($scope.hideLoadMoreButton[postKey]="yes"),$scope.$evalAsync()})})},loadMoreComments:function(postId,postKey,$scope){if($scope.totalComments[postKey]>$scope.comment_loaded[postKey]){var commentRef=new Firebase(FIREBASE_URL+"/houseComments/comments/"+postId),commentsArr=$firebaseArray(commentRef.orderByChild("commentNumber").startAt($scope.totalComments[postKey]-($scope.comment_loaded[postKey]+3)).endAt($scope.totalComments[postKey]-$scope.comment_loaded[postKey]));commentsArr.$loaded(function(commentsArr){if(commentsArr.length>0){angular.forEach(commentsArr,function(commentData){$scope.userName[postId][commentData.commentId]=Search.getStudentName(commentData.userId),$scope.userPic[postId][commentData.commentId]=Search.getStudentPhoto(commentData.userId),$scope.$evalAsync()});var temp=commentsArr;temp=temp.concat($scope.comments[postKey]),$scope.comments[postKey]=temp,$scope.comment_loaded[postKey]=$scope.comments[postKey].length}($scope.comment_loaded[postKey]===$scope.totalComments[postKey]||$scope.comment_loaded[postKey]>$scope.totalComments[postKey])&&($scope.hideLoadMoreButton[postKey]="yes")}),$scope.$evalAsync()}else $scope.hideLoadMoreButton[postKey]="yes",$scope.$evalAsync()},editPostComment:function(postId,postComment,postKey,commentKey,commentId){var updateCommentRef=new Firebase(FIREBASE_URL+"/houseComments/comments/"+postId+"/"+commentId);updateCommentRef.update({comment:postComment})},getNumberOfLikesOnThisComment:function(postId,commentId,$scope){$scope.numberOfLikesOnThisComment[postId]||($scope.numberOfLikesOnThisComment[postId]=[]);var totalPostCommentRef=new Firebase(FIREBASE_URL+"/houseComments/likesOnPostComments/"+postId+"/"+commentId);totalPostCommentRef.once("value",function(commentsSnapshot){$scope.numberOfLikesOnThisComment[postId][commentId]=commentsSnapshot.numChildren(),$scope.$evalAsync()})},likeThisComment:function(commentId,postId,userId,$scope){var updateLike=function(){var totalPostCommentRef=new Firebase(FIREBASE_URL+"/houseComments/likesOnPostComments/"+postId+"/"+commentId);totalPostCommentRef.once("value",function(commentsSnapshot){$scope.numberOfLikesOnThisComment[postId][commentId]=commentsSnapshot.numChildren(),$scope.$evalAsync()})},likePostCommentRef=new Firebase(FIREBASE_URL+"/houseComments/likesOnPostComments/"+postId+"/"+commentId+"/"+userId);likePostCommentRef.set(userId);var updateNumberOfLikes=new Firebase(FIREBASE_URL+"/houseComments/comments/"+postId+"/"+commentId);updateNumberOfLikes.update({likes:$scope.numberOfLikesOnThisComment[postId][commentId]+1},updateLike)},recentCollegeFeed:function(collegeId,$scope){$scope.collegePost=[];var collegeFeedRef=new Firebase(FIREBASE_URL+"posts/collegeWise/"+collegeId),postsArr=$firebaseArray(collegeFeedRef.orderByChild("postNumber").limitToLast(4));postsArr.$loaded(function(postsArr){$scope.collegePost=postsArr,$scope.collegePost.reverse(),$scope.college_post_loaded=$scope.collegePost.length,$scope.$evalAsync(),collegeFeedRef.on("value",function(collegePosts){$scope.totalCollegePosts=collegePosts.numChildren(),$scope.totalCollegePosts<4||4==$scope.totalCollegePosts?($scope.hideLoadMoreCollegePosts="yes",$scope.$evalAsync()):$scope.hideLoadMoreCollegePosts="no",$scope.$evalAsync()})})},loadMoreCollegeFeeds:function(collegeId,$scope){if($scope.totalCollegePosts>$scope.college_post_loaded){var collegeFeedRef=new Firebase(FIREBASE_URL+"posts/collegeWise/"+collegeId),postArr=$firebaseArray(collegeFeedRef.orderByChild("postNumber").startAt($scope.totalCollegePosts-($scope.college_post_loaded+3)).endAt($scope.totalCollegePosts-$scope.college_post_loaded));postArr.$loaded(function(postArray){postArray.length>0&&(postArray.reverse(),$scope.collegePost=$scope.collegePost.concat(postArray),$scope.college_post_loaded=$scope.collegePost.length),($scope.college_post_loaded===$scope.totalCollegePosts||$scope.college_post_loaded>$scope.totalCollegePosts)&&($scope.hideLoadMoreButton="yes"),$scope.$evalAsync()})}else $scope.hideLoadMoreButton="yes",$scope.$evalAsync()},seeCollegeFeedcollegewise:function($scope,collegeId){$scope.collegePost=[];var collegeFeedRef=new Firebase(FIREBASE_URL+"posts/collegeWise/"+collegeId),postsArr=$firebaseArray(collegeFeedRef.orderByChild("postNumber").limitToLast(4));postsArr.$loaded(function(postsArr){$scope.collegePost=postsArr,$scope.collegePost.reverse(),$scope.college_post_loaded=$scope.collegePost.length,$scope.$evalAsync(),collegeFeedRef.on("value",function(collegePosts){$scope.totalCollegePosts=collegePosts.numChildren(),$scope.totalCollegePosts<4||4==$scope.totalCollegePosts?($scope.hideLoadMoreCollegePosts="yes",$scope.$evalAsync()):$scope.hideLoadMoreCollegePosts="no",$scope.$evalAsync()})})},getCollegeUpcommingWebinars:function($scope,collegeId){$scope.collegeUpcommingWebinar=[];var collegeUpWebRef=new Firebase(FIREBASE_URL+"collegeWebinar/upcomingWebinar/"+collegeId),upWebArr=$firebaseArray(collegeUpWebRef.orderByChild("webinarNumber").limitToLast(4));upWebArr.$loaded(function(upWebArr){$scope.collegeUpcommingWebinar=upWebArr,$scope.collegeUpcommingWebinar.reverse(),$scope.college_up_webinar_loaded=$scope.collegeUpcommingWebinar.length,$scope.$evalAsync(),collegeUpWebRef.on("value",function(collegeUpWebinars){$scope.totalCollegeUpWebinars=collegeUpWebinars.numChildren(),$scope.totalCollegeUpWebinars<4||4==$scope.totalCollegeUpWebinars?($scope.hideLoadMoreCollegeUpWebinars="yes",$scope.$evalAsync()):$scope.hideLoadMoreCollegeUpWebinars="no",$scope.$evalAsync()})})},getCollegeCompletedWebinars:function($scope,collegeId){$scope.collegeCompletedWebinar=[];var collegeComWebRef=new Firebase(FIREBASE_URL+"collegeWebinar/completedWebinar/"+collegeId),comWebArr=$firebaseArray(collegeComWebRef.orderByChild("webinarNumber").limitToLast(4));comWebArr.$loaded(function(comWebArr){$scope.collegeCompletedWebinar=comWebArr,$scope.collegeCompletedWebinar.reverse(),$scope.college_com_webinar_loaded=$scope.collegeCompletedWebinar.length,$scope.$evalAsync(),collegeComWebRef.on("value",function(collegeComWebinars){$scope.totalCollegeComWebinars=collegeComWebinars.numChildren(),$scope.totalCollegeComWebinars<4||4==$scope.totalCollegeComWebinars?($scope.hideLoadMoreCollegeComWebinars="yes",$scope.$evalAsync()):$scope.hideLoadMoreCollegeComWebinars="no",$scope.$evalAsync()})})},seeCollegeFeed:function($scope){$scope.collegePost=[];var collegeFeedRef=new Firebase(FIREBASE_URL+"posts/catagories/collegePost"),postsArr=$firebaseArray(collegeFeedRef.orderByChild("postNumber").limitToLast(4));postsArr.$loaded(function(postsArr){$scope.collegePost=postsArr,$scope.collegePost.reverse(),$scope.college_post_loaded=$scope.collegePost.length,$scope.$evalAsync(),collegeFeedRef.on("value",function(collegePosts){$scope.totalCollegePosts=collegePosts.numChildren(),$scope.totalCollegePosts<4||4==$scope.totalCollegePosts?($scope.hideLoadMoreCollegePosts="yes",$scope.$evalAsync()):$scope.hideLoadMoreCollegePosts="no",$scope.$evalAsync()})})},loadMoreAllCollegeFeeds:function($scope){if($scope.totalCollegePosts>$scope.college_post_loaded){var collegeFeedRef=new Firebase(FIREBASE_URL+"posts/catagories/collegePost"),postArr=$firebaseArray(collegeFeedRef.orderByChild("postNumber").startAt($scope.totalCollegePosts-($scope.college_post_loaded+3)).endAt($scope.totalCollegePosts-$scope.college_post_loaded));postArr.$loaded(function(postArray){postArray.length>0&&(postArray.reverse(),$scope.collegePost=$scope.collegePost.concat(postArray),$scope.college_post_loaded=$scope.collegePost.length),($scope.college_post_loaded===$scope.totalCollegePosts||$scope.college_post_loaded>$scope.totalCollegePosts)&&($scope.hideLoadMoreButton="yes"),$scope.$evalAsync()})}else $scope.hideLoadMoreButton="yes",$scope.$evalAsync()}};return Blog}]),app.factory("Feedback",["$firebaseObject","$firebaseArray","FIREBASE_URL","$rootScope","Auth","AuthCollege",function($firebaseObject,$firebaseArray,FIREBASE_URL){var ref=new Firebase(FIREBASE_URL+"profileForCollege/"),collegeObj=(new Firebase(FIREBASE_URL),$firebaseObject(ref)),collegeArray=$firebaseArray(ref),Feedback={all:collegeObj,allAsArray:collegeArray,getPreviousFeedbackOfStudents:function(studentURL,collegeURL,$scope){var previousFeedbackRef=new Firebase(FIREBASE_URL+"studentFeedback/"+studentURL+"/"+collegeURL);$scope.studentFeeback=$firebaseObject(previousFeedbackRef),$scope.$evalAsync()},writeFeedbackForStudent:function(studentQuery,firstAnswer,secondAnswer,thirdAnswer,sessionDate,collegeURL,studentURL){var feedbackRef=new Firebase(FIREBASE_URL+"studentFeedback/"+studentURL+"/"+collegeURL+"/"),feedbackObject=$firebaseObject(feedbackRef);feedbackObject.studentquery=studentQuery,feedbackObject.firstAnswer=firstAnswer,feedbackObject.secondAnswer=secondAnswer,feedbackObject.thirdAnswer=thirdAnswer,feedbackObject.sessiondate=sessionDate,feedbackObject.$save().then(function(){},function(error){console.log("Error:",error)})}};return Feedback}]),app.factory("VerifyReferNodal",["FIREBASE_URL","$rootScope","$firebaseObject","$firebaseArray",function(FIREBASE_URL,$rootScope,$firebaseObject){var VerifyReferNodal={getMD5:function(userId){var studentMd5ref=new Firebase(FIREBASE_URL+"profileForStudents/"+userId+"/md5_hash");return $firebaseObject(studentMd5ref)},getEmailVerified:function(UserId,refferedId,nodalid,ApprovedSessionCount,totalReferredStudents){var emailStatusRef=new Firebase(FIREBASE_URL+"profileForStudents/"+UserId),emailVerificationStatus=emailStatusRef;emailVerificationStatus.update({emailverificationstatus:"true"}),emailVerificationStatus.update({referredByNodalAdmin:refferedId}),VerifyReferNodal.saveDataInNodal(nodalid,UserId,ApprovedSessionCount,totalReferredStudents)},saveDataInNodal:function(nodalid,UserId,ApprovedSessionCount,totalReferredStudents){var nodalref=new Firebase(FIREBASE_URL+"profileForNodalAdmins/"+nodalid+"/studentsRegistered/"+UserId),nodalrefobj=nodalref;nodalrefobj.update({numberOfSessionsTillDate:ApprovedSessionCount,allreadyRefferdStudent:totalReferredStudents})}};return VerifyReferNodal}]),app.factory("studentDashBookedHistory",["$firebaseObject","$firebaseArray","FIREBASE_URL","$rootScope","$q",function($firebaseObject,$firebaseArray,FIREBASE_URL){var studentDashBookedHistory={getCollegeDetail:function(collegeId,urlId,$scope){var nameRef=new Firebase(FIREBASE_URL+"profileForCollege/"+collegeId+"/collegename"),photoRef=new Firebase(FIREBASE_URL+"profileForCollege/"+collegeId+"/collegephoto"),nameObj=$firebaseObject(nameRef),photoObj=$firebaseObject(photoRef);nameObj.$loaded(function(result){photoObj.$loaded(function(photo){$scope.collegeDetail[urlId]={collegeName:result.$value,collegePhoto:photo.$value}})})},getLimitedColleges:function($scope,studentId){var nayaRef=new Firebase(FIREBASE_URL+"studentSessions/"+studentId);$scope.session=$firebaseArray(nayaRef)}};return studentDashBookedHistory}]),app.factory("AuthSchool",["$firebaseAuth","$location","FIREBASE_URL","$rootScope","$firebaseObject","$firebaseArray","$q",function($firebaseAuth,$location,FIREBASE_URL){var ref=new Firebase(FIREBASE_URL),authschool=$firebaseAuth(ref),AuthSchool={resolveUser:function(){return authschool.$getAuth()},signedIn:function(){return!!AuthSchool.users.provider},logout:function(){authschool.$unauth(),AuthSchool.users&&AuthSchool.users.profile&&AuthSchool.users.profile.$destroy(),angular.copy({},AuthSchool.users)},users:{}};return AuthSchool}]),app.factory("AuthMentor",["$firebaseAuth","$location","FIREBASE_URL","$rootScope","$firebaseObject","$firebaseArray","$q",function($firebaseAuth,$location,FIREBASE_URL,$rootScope,$firebaseObject){var ref=new Firebase(FIREBASE_URL),authmentor=$firebaseAuth(ref),AuthMentor={resolveUser:function(){return authmentor.$getAuth()},signedIn:function(){return!!AuthMentor.userd.provider},logout:function(){authmentor.$unauth(),AuthMentor.userd&&AuthMentor.userd.profile&&AuthMentor.userd.profile.$destroy(),angular.copy({},AuthMentor.userd)},getMentorDetails:function(){return $firebaseObject(new Firebase(FIREBASE_URL+"/profileForMentors/"+AuthMentor.resolveUser().uid))},userd:{}};return AuthMentor}]),app.factory("Webinar",["FIREBASE_URL","$rootScope","$q","$filter","$http","$firebaseObject","toaster","$firebaseArray","$window","Auth",function(FIREBASE_URL,$rootScope,$q,$filter,$http,$firebaseObject,toaster,$firebaseArray,$window,Auth){var Webinar={getUpcomingWebinarOnMainPage:function(){var deferred=$q.defer(),upcomingWebinar=new Firebase(FIREBASE_URL+"allWebinar/upcomingWebinar/"),upcomingWebinarArray=$firebaseArray(upcomingWebinar);return deferred.resolve(upcomingWebinarArray),deferred.promise},bookWebinar:function($scope,liveStreamURL,mentorName,mentorEmail,mentorMobile,gender,mentorPhoto,webinarTopic,webinarDate,webinarTime,webinarDescription,webinarDuration,webinarAttendees,collegeId,webinarId,studentId){$scope.webinarBooked="notDone";var bookWebinarSync=new Firebase(FIREBASE_URL+"studentWebinar/bookedWebinar/"+studentId+"/"+webinarId);bookWebinarSync.once("value",function(snapshot){var a=snapshot.exists();if(a===!1){var liveWebinarRef=new Firebase(FIREBASE_URL+"liveWebinars/"+webinarId);liveWebinarRef.once("value",function(snapshot){if(snapshot.exists()===!0){var oncomplete=function(){new Firebase(FIREBASE_URL+"WebinarWiseRecord//"+webinarId+"/"+studentId).set(studentId),new Firebase(FIREBASE_URL+"collegeWebinar/upcomingWebinar/"+collegeId+"/"+webinarId+"/studentsAttending").set(webinarAttendees+1),new Firebase(FIREBASE_URL+"allWebinar/upcomingWebinar/"+webinarId+"/studentsAttending").set(webinarAttendees+1),$scope.webinar_booking_success[webinarId]="done",$scope.$evalAsync()};bookWebinarSync.update({mentorName:mentorName,mentorEmail:mentorEmail,mentorMobile:mentorMobile,mentorGender:gender,mentorPhoto:mentorPhoto,webinarTopic:webinarTopic,webinarDate:webinarDate,webinarTime:webinarTime,webinarDescription:webinarDescription,webinarDuration:webinarDuration,collegeId:collegeId,webinarId:webinarId,liveStreamURL:liveStreamURL,studentsAttending:webinarAttendees+1},oncomplete)}else{var oncomplete=function(){new Firebase(FIREBASE_URL+"WebinarWiseRecord//"+webinarId+"/"+studentId).set(studentId),new Firebase(FIREBASE_URL+"collegeWebinar/upcomingWebinar/"+collegeId+"/"+webinarId+"/studentsAttending").set(webinarAttendees+1),new Firebase(FIREBASE_URL+"allWebinar/upcomingWebinar/"+webinarId+"/studentsAttending").set(webinarAttendees+1),$scope.webinar_booking_success[webinarId]="done",$scope.$evalAsync()};bookWebinarSync.update({mentorName:mentorName,mentorEmail:mentorEmail,mentorMobile:mentorMobile,mentorGender:gender,mentorPhoto:mentorPhoto,webinarTopic:webinarTopic,webinarDate:webinarDate,webinarTime:webinarTime,webinarDescription:webinarDescription,webinarDuration:webinarDuration,collegeId:collegeId,webinarId:webinarId,studentsAttending:webinarAttendees+1},oncomplete)}})}else a===!0&&($scope.webinarAlreadyBooked[webinarId]="yes",$scope.$evalAsync())})},UpdateAttendees:function(i,webinarId,webinarAttendees,collegeId){new Firebase(FIREBASE_URL+"collegeWebinar/upcomingWebinar/"+collegeId+"/"+webinarId+"/studentsAttending").set(webinarAttendees+i),new Firebase(FIREBASE_URL+"allWebinar/upcomingWebinar/"+webinarId+"/studentsAttending").set(webinarAttendees+i)},getUpcommingWebinarsForStudent:function(studentId,$scope){$scope.webinarsLoaded=0;var counter=0,numberOfAllUpcomingWebinars=0;$scope.studentWebinar=[];var studentWebinarRef=new Firebase(FIREBASE_URL+"allWebinar/upcomingWebinar");studentWebinarRef.once("value",function(snapshot){numberOfAllUpcomingWebinars=snapshot.numChildren(),studentWebinarRef.orderByChild("webinarNumber").startAt(numberOfAllUpcomingWebinars-1).endAt(numberOfAllUpcomingWebinars).once("value",function(studentSnapshot){studentSnapshot.forEach("undefined"==typeof studentId?function(studentWebinarRecords){$scope.studentWebinar=$scope.studentWebinar.concat(studentWebinarRecords.val()),$scope.webinarsLoaded=studentWebinarRecords.val().webinarNumber-1,$scope.$evalAsync()}:function(studentWebinarRecords){var ref=new Firebase(FIREBASE_URL+"studentWebinar/bookedWebinar/"+studentId+"/"+studentWebinarRecords.key());ref.on("value",function(snapshot){var a=snapshot.exists();a===!0?(counter+=1,$scope.webinarsLoaded=studentWebinarRecords.val().webinarNumber-1):a===!1&&(counter+=1,$scope.webinarsLoaded=studentWebinarRecords.val().webinarNumber-1,$scope.studentWebinar=$scope.studentWebinar.concat(studentWebinarRecords.val()),$scope.$evalAsync()),2===counter&&2!==$scope.studentWebinar.length&&Webinar.loadMoreWebinarsForStudent(studentId,$scope)})})})})},loadMoreWebinarsForStudent:function(studentId,$scope){var counter=0,previousArrayLength=$scope.studentWebinar.length,studentWebinar=new Firebase(FIREBASE_URL+"allWebinar/upcomingWebinar");studentWebinar.orderByChild("webinarNumber").startAt($scope.webinarsLoaded-2).endAt($scope.webinarsLoaded-1).once("value",function(studentSnapshot){studentSnapshot.forEach("undefined"==typeof studentId?function(studentWebinarRecords){$scope.webinarsLoaded=studentWebinarRecords.val().webinarNumber-1,$scope.studentWebinar=$scope.studentWebinar.concat(studentWebinarRecords.val()),$scope.$evalAsync()}:function(studentWebinarRecords){var ref=new Firebase(FIREBASE_URL+"studentWebinar/bookedWebinar/"+studentId+"/"+studentWebinarRecords.key());ref.on("value",function(snapshot){var a=snapshot.exists();a===!0?(counter+=1,$scope.webinarsLoaded=studentWebinarRecords.val().webinarNumber-1):a===!1&&(counter+=1,$scope.webinarsLoaded=studentWebinarRecords.val().webinarNumber-1,$scope.studentWebinar=$scope.studentWebinar.concat(studentWebinarRecords.val()),$scope.$evalAsync()),2===counter&&$scope.studentWebinar.length!==previousArrayLength+2&&Webinar.loadMoreWebinarsForStudent(studentId,$scope)})})}),(2===$scope.webinarsLoaded||1===$scope.webinarsLoaded||3===$scope.webinarsLoaded)&&($("#loadmorebtn").html(""),$("#loadmorebtn").html('<div style="width:100%; background:#fbfbfb; border-radius:4px; border:1px solid #ccc; padding:5px;"><p style="margin:5px; font-size:16px;"><b>No More Webinars to load.</b></p></div>'))},getBookedWebinarForStudent:function(studentId,$scope){$scope.studentBookedWebinar=[];var numberOfBookedWebinars=0,studentBookedWebinarRef=new Firebase(FIREBASE_URL+"studentWebinar/bookedWebinar/"+studentId);studentBookedWebinarRef.once("value",function(snapshot){numberOfBookedWebinars=snapshot.numChildren(),0!==numberOfBookedWebinars&&snapshot.forEach(function(studentBookedWebinar){$scope.studentBookedWebinar=$scope.studentBookedWebinar.concat(studentBookedWebinar.val()),$scope.$evalAsync()})})},attendWebinarByStudent:function(webinarDetail,$scope){var liveStreamRef=new Firebase(FIREBASE_URL+"allWebinar/upcomingWebinar/"+webinarDetail.webinarId+"/liveStreamURL/"),liveURL=$firebaseObject(liveStreamRef);liveURL.$loaded(function(liveURL){var Id=liveURL.$value.split(".be/"),vedioId=Id[1],videourl="https://www.youtube.com/embed/"+vedioId+"?rel=0&amp;showinfo=0&modestbranding=1&autohide=1";$scope.video={src:videourl,title:"LiveStreamUrl"},$scope.$evalAsync()});var studentsAttendingWebinarRef=new Firebase(FIREBASE_URL+"/studentsClickingStartWebinarLink/"+webinarDetail.webinarId+"/"),studentsAttendingWebinarObj=$firebaseObject(studentsAttendingWebinarRef);studentsAttendingWebinarObj.$loaded(function(studentsAttendingWebinar){studentsAttendingWebinar.$value?studentsAttendingWebinar.$value<7?studentsAttendingWebinarRef.set(studentsAttendingWebinar.$value+1):(studentsAttendingWebinar.$value>7||7===studentsAttendingWebinar.$value)&&studentsAttendingWebinarRef.set(studentsAttendingWebinar.$value+1):studentsAttendingWebinarRef.set(1)})},getStudentsWebinarHistory:function(studentId,$scope){var studentsCompletedWebinarRef=new Firebase(FIREBASE_URL+"studentWebinar/completedWebinar/"+studentId),studentsCompletedWebinarObj=$firebaseArray(studentsCompletedWebinarRef);studentsCompletedWebinarObj.$loaded(function(studentsCompletedWebinar){$scope.webinarHistory=studentsCompletedWebinar})},studentAskedAQuestion:function(studentUid,studentname,webinarDetail,question,$scope){var questionDate=new Date,date=$filter("date")(questionDate,"yyyyMMdd"),postTime=(questionDate.getHours()<10?"0":"")+questionDate.getHours()+":"+(questionDate.getMinutes()<10?"0":"")+questionDate.getMinutes()+":"+(questionDate.getSeconds()<10?"0":"")+questionDate.getSeconds(),temporary=postTime.split(":"),timestamp=date.toString()+temporary[0].toString()+temporary[1].toString()+temporary[2].toString(),questionFromStudentRef=new Firebase(FIREBASE_URL+"QNADuringWebinar/"+webinarDetail.webinarId+"/");questionFromStudentRef.push({studentId:studentUid,studentName:studentname,webinarId:webinarDetail.webinarId,question:question,timestamp:timestamp}),$scope.question=""},getWebinarChat:function(webinarid,$scope){var chatref=new Firebase(FIREBASE_URL+"/QNADuringWebinar/"+webinarid),chatrefobj=$firebaseArray(chatref);chatrefobj.$loaded(function(chatrefobj){$scope.QuestionDetails=chatrefobj})},getQNAdetails:function(webinarDetail,$scope){var QNARef=new Firebase(FIREBASE_URL+"QNADuringWebinar/"+webinarDetail.webinarId+"/"),QNAObj=$firebaseObject(QNARef);QNAObj.$loaded(function(QNAObj){$scope.QNADetails=QNAObj,$scope.$evalAsync()})},getWebinarDetailByWebinarId:function(webinarId,$scope){var webinarDetailRef=new Firebase(FIREBASE_URL+"allWebinar/upcomingWebinar/"+webinarId+"/"),webinarDetailObj=$firebaseObject(webinarDetailRef);webinarDetailObj.$loaded(function(webinarDetailObj){if($scope.specificWebinarDetail=webinarDetailObj,$scope.specificWebinarDetail.liveStreamURL){var Id=$scope.specificWebinarDetail.liveStreamURL.split(".be/"),vedioId=Id[1],videourl="https://www.youtube.com/embed/"+vedioId+"?rel=0&amp;showinfo=0&modestbranding=1&autohide=1";$scope.video={src:videourl,title:"LiveStreamUrl"}}})},getWebinarDetail:function(webinarId){var deferred=$q.defer(),allWebinarObject=$firebaseObject(new Firebase(FIREBASE_URL+"allWebinar/upcomingWebinar/"+webinarId));return allWebinarObject.$loaded(function(webinarDetail){deferred.resolve(webinarDetail)}),deferred.promise},isAnyWebinarLive:function(){var liveWebinarRef=new Firebase(FIREBASE_URL+"liveWebinars/");return $firebaseArray(liveWebinarRef)},isThisBookedWebinarLive:function(webinarId,$scope){var liveWebinarRef=new Firebase(FIREBASE_URL+"liveWebinars/"+webinarId);
$scope.thisBookedWebinarLive[webinarId]=$firebaseArray(liveWebinarRef),$scope.$evalAsync()},getWebinarFeedbacks:function(currentCollege,$scope,webinarId){var completedRef=new Firebase(FIREBASE_URL+"collegeWebinar/CollegeFeedbackForWebinar/"+currentCollege+"/"+webinarId+"/");$scope.Webinarsfeedback=$firebaseObject(completedRef),$scope.$evalAsync()},SaveWebinarFeedback:function(webinarId,currentCollege,$scope,webinarexperience,satisfaction,quality,problems,QNA,technicalProblem,recommendation){var completedWebinarHistoryRef=new Firebase(FIREBASE_URL+"collegeWebinar/CollegeFeedbackForWebinar/"+currentCollege+"/"+webinarId+"/"),feedbackObject=$firebaseObject(completedWebinarHistoryRef);feedbackObject.webinarExperience=webinarexperience,feedbackObject.satisfactionLevel=satisfaction,feedbackObject.QualityoFWebinar=quality,feedbackObject.TechnicalProblems=problems,feedbackObject.Recommendation=QNA,"undefined"!=typeof technicalProblem&&(feedbackObject.TechnicalProblemsDetail=technicalProblem),"undefined"!=typeof recommendation&&(feedbackObject.RecommendationDetail=recommendation),feedbackObject.$save().then(function(){$scope.successmessage="Your Details Submitted sucessfully"})},getstudentWebinarFeedbacks:function(webinarId,$scope){var currentStudent=Auth.resolveUser().uid,completedRef=new Firebase(FIREBASE_URL+"studentWebinar/StudentFeedbackForWebinar/"+currentStudent+"/"+webinarId+"/");$scope.studentwebinarFeed=$firebaseObject(completedRef),$scope.$evalAsync()},SaveWebinarStudentFeedback:function(collegeId,webinarId,webinarSatisfaction,SpeakerInterested,Interested,InterestedArea,QNA,QuestionDetails,$scope){var currentStudent=Auth.resolveUser().uid,completedWebinarHistoryRef=new Firebase(FIREBASE_URL+"studentWebinar/StudentFeedbackForWebinar/"+currentStudent+"/"+webinarId+"/"),feedbackObject=$firebaseObject(completedWebinarHistoryRef);feedbackObject.webinarSatisfaction=webinarSatisfaction,feedbackObject.Interested=Interested,feedbackObject.SpeakerQuality=SpeakerInterested,feedbackObject.AllQuestionAnswered=QNA,feedbackObject.collegeId=collegeId,"undefined"!=typeof InterestedArea&&(feedbackObject.InterestedArea=InterestedArea),"undefined"!=typeof QuestionDetails&&(feedbackObject.QuestionDetails=QuestionDetails),feedbackObject.$save().then(function(){$scope.successmessage="Your Details Submitted sucessfully"})},getAllCompletedWebinar:function($scope){$scope.post_loaded=2,$scope.completedWebinar=[];var postCatagoryWiseRef=new Firebase(FIREBASE_URL+"allWebinar/completedWebinar");postCatagoryWiseRef.on("value",function(allPosts){$scope.totalPosts=allPosts.numChildren(),$scope.hideLoadMore=$scope.totalPosts<2||2==$scope.totalPosts?"yes":"no"});var postsArr=$firebaseArray(postCatagoryWiseRef.orderByChild("webinarNumber").limitToLast(2));postsArr.$loaded(function(postsArr){$scope.completedWebinar=postsArr,$scope.completedWebinar.reverse(),$scope.$evalAsync()})},loadMoreCompletedWebinars:function(webinarNumber,$scope){var tempPostArr=[],postCatagoryWiseRef=new Firebase(FIREBASE_URL+"allWebinar/completedWebinar");if($scope.post_loaded<$scope.totalPosts){var morePostArray=$firebaseArray(postCatagoryWiseRef.orderByChild("webinarNumber").startAt($scope.totalPosts-($scope.post_loaded+3)).endAt($scope.totalPosts-$scope.post_loaded));morePostArray.$loaded(function(morePostArray){tempPostArr=morePostArray,tempPostArr.reverse(),$scope.completedWebinar=$scope.completedWebinar.concat(tempPostArr),$scope.post_loaded=$scope.completedWebinar.length,$scope.hideLoadMore="no",$scope.post_loaded===$scope.totalPosts&&($scope.hideLoadMore="yes"),$scope.$evalAsync()})}else $scope.hideLoadMore="yes"},getAllSpecialEvents:function(){var specialWebinarRef=new Firebase(FIREBASE_URL+"specialEvents/");return $firebaseArray(specialWebinarRef)},authorizeSpecialEvent:function(eventId,event_password,$scope){var specialWebinarPassword=new Firebase(FIREBASE_URL+"specialEventsPassword/"+eventId);specialWebinarPassword.once("value",function(snapshot){if(snapshot.val()===event_password){$scope.eventError="",$scope.event_password="",$scope.$evalAsync();var hangoutRef=new Firebase(FIREBASE_URL+"allWebinar/upcomingWebinar/"+eventId+"/hangoutURL/");hangoutRef.once("value",function(snapshot){$window.open(snapshot.val())})}else $scope.eventError="Not Authorized !",$scope.$evalAsync()})},saveSpecialEvent:function(webinarDetails,password,$scope){var onComplete=function(){var specialWebinarPassword=new Firebase(FIREBASE_URL+"specialEventsPassword/"+webinarDetails.$id);specialWebinarPassword.set(password),$scope.hangoutShared="shared",$scope.$evalAsync()},specialWebinarRef=new Firebase(FIREBASE_URL+"specialEvents/"+webinarDetails.$id);specialWebinarRef.update({webinarTopic:webinarDetails.webinarTopic,mentorName:webinarDetails.mentorName,mentorEmail:webinarDetails.mentorEmail,mentorMobile:webinarDetails.mentorMobile,mentorGender:webinarDetails.mentorGender,mentorPhoto:webinarDetails.mentorPhoto,webinarDate:webinarDetails.webinarDate,webinarTime:webinarDetails.webinarTime,webinarDescription:webinarDetails.webinarDescription,webinarDuration:webinarDetails.webinarDuration,collegeId:webinarDetails.collegeId,webinarId:webinarDetails.webinarId},onComplete)},getUpcomingCollegeWebinar:function(collegeId,$scope){var upcommingWebRef=new Firebase(FIREBASE_URL+"collegeWebinar/upcomingWebinar/"+collegeId+"/");$scope.commingWebinars=$firebaseArray(upcommingWebRef),$scope.$evalAsync()}};return Webinar}]),app.factory("NodalTask",["$firebaseAuth","$filter","FIREBASE_URL","$rootScope","$q","$firebaseObject","$firebaseArray","Search",function($firebaseAuth,$filter,FIREBASE_URL){var ref=new Firebase(FIREBASE_URL),nodaltask=$firebaseAuth(ref),NodalTask={resolveUser:function(){return nodaltask.$getAuth()},signedIn:function(){return!!NodalTask.user.provider},user:{}};return NodalTask}]),app.directive("scrollDirective",["$timeout","$routeParams","$location","$window",function($timeout,$routeParams,$location,$window){return{restrict:"AE",scope:!0,link:function(scope,elem,attrs){$("#top-college-pic").height()&&(attrs.extraOffset=String("-"+($("#top-college-pic").height()+$("#top-college-pic").height()/100*13))),"/about"==$location.path()&&$routeParams.tab&&(scope.tab=$routeParams.tab,attrs.targetScroll="about"===scope.tab?"#sales-content":"#"+scope.tab+"-content",attrs.elems="#about-nav:z,#sidebar-"+scope.tab+":c^m",attrs.offsetElem="sidebar-"+scope.tab,scope.$applyAsync()),angular.element($window).bind("scroll",function(){if($("#top-college-pic").height()&&(attrs.extraOffset=String("-"+($("#top-college-pic").height()+$("#top-college-pic").height()/100*13))),"/about"==$location.path()?$routeParams.tab&&(scope.tab=$routeParams.tab,scope.$applyAsync(),"about"===scope.tab?(attrs.targetScroll="#sales-content",attrs.extraOffset="40"):(attrs.targetScroll="#"+scope.tab+"-content",attrs.extraOffset="65"),attrs.elems="#about-nav:z,#sidebar-"+scope.tab+":c^m",attrs.offsetElem="sidebar-"+scope.tab,attrs.targetClass="scrollFixed"):"/search"==$location.path()?(attrs.elems="#search-sidebar:p^m",attrs.offsetElem="#search-sidebar",attrs.targetScroll="#search-results-content",attrs.extraOffset="100"):"/contact"==$location.path()?(attrs.elems=".contact-cont:p^m^t",attrs.targetScroll=".map-cont",attrs.offsetElem=".contact-cont",attrs.extraOffset="100"):"/dashboard"==$location.path()?(attrs.elems="#student-top-bar-for-directive:pf^t^z^top^w^blank",attrs.targetScroll="#topCoverPic",attrs.offsetElem="#student-top-bar-for-directive",attrs.extraOffset="-148",attrs.blankSpace="#extra-div-by-animesh"):$location.path().indexOf("/college-profile/simplelogin:")+1&&(attrs.targetScroll=".college-pic",attrs.offsetElem="#extra-div-by-animesh",attrs.extraOffset="-325",attrs.blankSpace="#extra-div-by-animesh",$(window).scrollTop()>240+$(".searchpg-content-row").height()-$("#extra-div-by-animesh").height()?(attrs.elems="#extra-div-by-animesh:pf^top^left,#extra-div-by-animesh:p^m^z",attrs.extraOffset="-340"):(attrs.elems="#extra-div-by-animesh:p^z,#extra-div-by-animesh:pf^top^left",$("#extra-div-by-animesh").css("marginTop",""))),"/about"==$location.path()||"/search"==$location.path()||"/contact"==$location.path()||"/dashboard"==$location.path()||$location.path().indexOf("/college-profile/simplelogin:")+1){var scrollPos=$(window).scrollTop(),scrollPosTarget2=$(attrs.targetScroll),totalHeight=$(document).height(),offsetElem=$(attrs.offsetElem).height(),transDoneTmpInitial=!1,transDoneTmpFinal=!1,extraOffset=Number(attrs.extraOffset);50>offsetElem&&(offsetElem=50);var scrollFactor=(scrollPosTarget2.position().top+scrollPosTarget2.height()-offsetElem-extraOffset-100)/totalHeight,classToRemove=attrs.targetClass,allElems=attrs.elems;allElems=allElems.split(",");for(var i=0;i<allElems.length;i++)allElems[i]=allElems[i].split(":"),allElems[i][1]=allElems[i][1].split("^");if(scrollPos>=scrollFactor*totalHeight)for(var element in allElems)for(var property in allElems[element][1])"c"===allElems[element][1][property]?$(allElems[element][0]).removeClass(classToRemove):"m"===allElems[element][1][property]?$location.path().indexOf("/college-profile/simplelogin:")+1?$(allElems[element][0]).css("marginTop",130+$(".searchpg-content-row").height()-$("#extra-div-by-animesh").height()):$(allElems[element][0]).css("marginTop",scrollFactor*totalHeight+"px"):"z"===allElems[element][1][property]?$(allElems[element][0]).css("zIndex","99"):"p"===allElems[element][1][property]?$(allElems[element][0]).css("position","absolute"):"t"!==allElems[element][1][property]||transDoneTmpInitial?"pf"===allElems[element][1][property]?$(allElems[element][0]).css("position","fixed"):"top"===allElems[element][1][property]?$location.path().indexOf("/college-profile/simplelogin:")+1?$(allElems[element][0]).css("top","200px"):$(allElems[element][0]).css("top","60px"):"left"===allElems[element][1][property]?($(allElems[element][0]).css("right","2.05em"),$(allElems[element][0]).css("padding-right","28px"),$(allElems[element][0]).css("width","31.87686196623635%")):"w"===allElems[element][1][property]?$(allElems[element][0]).css("width","100%"):"blank"===allElems[element][1][property]&&$(attrs.blankSpace).css("height","48px"):($(allElems[element][0]).css("transition","all 0s"),$(allElems[element][0]).css("-webkit-transition","all 0s"),$(allElems[element][0]).css("-moz-transition","all 0s"),$(allElems[element][0]).css("-ms-transition","all 0s"),$(allElems[element][0]).css("-o-transition","all 0s"),transDoneTmpInitial=!0,transDoneTmpFinal=!1,$timeout(function(){$(allElems[element][0]).css("transition",""),$(allElems[element][0]).css("-webkit-transition",""),$(allElems[element][0]).css("-moz-transition",""),$(allElems[element][0]).css("-ms-transition",""),$(allElems[element][0]).css("-o-transition","")},50));else for(var element in allElems)for(var property in allElems[element][1])"c"===allElems[element][1][property]?$(allElems[element][0]).addClass(classToRemove):"m"===allElems[element][1][property]?$(allElems[element][0]).css("marginTop",""):"z"===allElems[element][1][property]?$(element[0]).css("zIndex",""):"p"===allElems[element][1][property]?$(allElems[element][0]).css("position",""):"t"!==allElems[element][1][property]||transDoneTmpFinal?"pf"===allElems[element][1][property]?$(allElems[element][0]).css("position",""):"top"===allElems[element][1][property]?$(allElems[element][0]).css("top",""):"left"===allElems[element][1][property]?($(allElems[element][0]).css("right",""),$(allElems[element][0]).css("padding-right",""),$(allElems[element][0]).css("width","")):"w"===allElems[element][1][property]?$(allElems[element][0]).css("width","100%"):"blank"===allElems[element][1][property]&&$(attrs.blankSpace).css("height",""):($(allElems[element][0]).css("transition","all 0s"),$(allElems[element][0]).css("-webkit-transition","all 0s"),$(allElems[element][0]).css("-moz-transition","all 0s"),$(allElems[element][0]).css("-ms-transition","all 0s"),$(allElems[element][0]).css("-o-transition","all 0s"),transDoneTmpFinal=!0,transDoneTmpInitial=!1,$timeout(function(){$(allElems[element][0]).css("transition",""),$(allElems[element][0]).css("-webkit-transition",""),$(allElems[element][0]).css("-moz-transition",""),$(allElems[element][0]).css("-ms-transition",""),$(allElems[element][0]).css("-o-transition","")},50))}})}}}]),angular.module("angularFilepicker",[]).service("angularFilepicker",["$window",function($window){return $window.filepicker}]).directive("fpInput",["angularFilepicker",function(angularFilepicker){return{scope:{},transclude:!0,restrict:"E",replace:!0,require:"ngModel",template:"<button type='button' ng-click='pickFiles()'>{{buttonText}}</button>",link:function(scope,element,attrs,ngModel){function setAttrIfExists(key,options,attrname){var val=attrs[attrname];val&&(options[key]=val)}function successCallback(response){ngModel.$setViewValue(response),scope.$apply()}function errorCallback(){}scope.pickFiles=pickFiles;var pickFiles,pickerOptions={},storeOptions={};if(scope.buttonText=attrs.fpButtonText||"Pick file",angularFilepicker.setKey(attrs.fpApikey),setAttrIfExists("multiple",pickerOptions,"fpMultiple"),setAttrIfExists("mimetype",pickerOptions,"fpMimetype"),setAttrIfExists("mimetypes",pickerOptions,"fpMimetypes"),setAttrIfExists("service",pickerOptions,"fpService"),setAttrIfExists("services",pickerOptions,"fpServices"),setAttrIfExists("extension",pickerOptions,"fpExtension"),setAttrIfExists("extensions",pickerOptions,"fpExtensions"),setAttrIfExists("container",pickerOptions,"fpContainer"),setAttrIfExists("maxSize",pickerOptions,"fpMaxSize"),setAttrIfExists("maxFiles",pickerOptions,"fpMaxFiles"),setAttrIfExists("openTo",pickerOptions,"fpOpenTo"),setAttrIfExists("debug",pickerOptions,"fpDebug"),setAttrIfExists("signature",pickerOptions,"fpSignature"),setAttrIfExists("policy",pickerOptions,"fpPolicy"),setAttrIfExists("storeLocation",storeOptions,"fpStoreLocation"),setAttrIfExists("storePath",storeOptions,"fpStorePath"),setAttrIfExists("storeContainer",storeOptions,"fpStoreContainer"),setAttrIfExists("storeAccess",storeOptions,"fpStoreAccess"),setAttrIfExists("language",pickerOptions,"fpLanguage"),pickerOptions.services){for(var services=pickerOptions.services.split(","),j=0;j<services.length;j++)services[j]=services[j].replace(" ","");pickerOptions.services=services}pickerOptions.service&&(pickerOptions.service=pickerOptions.service.replace(" ","")),pickerOptions.mimetypes&&(pickerOptions.mimetypes=pickerOptions.mimetypes.split(",")),pickerOptions.extensions&&(pickerOptions.extensions=pickerOptions.extensions.split(",")),ngModel.$viewChangeListeners.push(function(){scope.$eval(attrs.ngChange)}),pickFiles=void 0===storeOptions.storeLocation&&"true"!==pickerOptions.multiple?function(){angularFilepicker.pick(pickerOptions,successCallback,errorCallback)}:void 0===storeOptions.storeLocation&&"true"===pickerOptions.multiple?function(){angularFilepicker.pickMultiple(pickerOptions,successCallback,errorCallback)}:function(){angularFilepicker.pickAndStore(pickerOptions,storeOptions,successCallback,errorCallback)},scope.pickFiles=pickFiles}}}]);